<?xml version="1.0" encoding="UTF-8"?><root><url>https://www.sciencedirect.com/science/article/pii//S0004370214001039</url><title>Spatial reasoning with RCC8 and connectedness constraints in Euclidean spaces</title><authors>Roman Kontchakov,Ian Pratt-Hartmann,Michael Zakharyaschev</authors><abstract>The language RCC8 is a widely-studied formalism for describing topological arrangements of spatial regions. The variables of this language range over the collection of non-empty, regular closed sets of n-dimensional Euclidean space, here denoted RC+(Rn), and its non-logical primitives allow us to specify how the interiors, exteriors and boundaries of these sets intersect. The key question is the satisfiability problem: given a finite set of atomic RCC8-constraints in m variables, determine whether there exists an m-tuple of elements of RC+(Rn) satisfying them. These problems are known to coincide for all n≥1, so that RCC8-satisfiability is independent of dimension. This common satisfiability problem is NLogSpace-complete. Unfortunately, RCC8 lacks the means to say that a spatial region comprises a ‘single piece’, and the present article investigates what happens when this facility is added. We consider two extensions of RCC8: RCC8c, in which we can state that a region is connected, and RCC8c∘, in which we can instead state that a region has a connected interior. The satisfiability problems for both these languages are easily seen to depend on the dimension n, for n≤3. Furthermore, in the case of RCC8c∘, we show that there exist finite sets of constraints that are satisfiable over RC+(R2), but only by ‘wild’ regions having no possible physical meaning. This prompts us to consider interpretations over the more restrictive domain of non-empty, regular closed, polyhedral sets, RCP+(Rn). We show that (a) the satisfiability problems for RCC8c (equivalently, RCC8c∘) over RC+(R) and RCP+(R) are distinct and both NP-complete; (b) the satisfiability problems for RCC8c over RC+(R2) and RCP+(R2) are identical and NP-complete; (c) the satisfiability problems for RCC8c∘ over RC+(R2) and RCP+(R2) are distinct, and the latter is NP-complete. Decidability of the satisfiability problem for RCC8c∘ over RC+(R2) is open. For n≥3, RCC8c and RCC8c∘ are not interestingly different from RCC8. We finish by answering the following question: given that a set of RCC8c- or RCC8c∘-constraints is satisfiable over RC+(Rn) or RCP+(Rn), how complex is the simplest satisfying assignment? In particular, we exhibit, for both languages, a sequence of constraints Φn, satisfiable over RCP+(R2), such that the size of Φn grows polynomially in n, while the smallest configuration of polygons satisfying Φn cuts the plane into a number of pieces that grows exponentially. We further show that, over RC+(R2), RCC8c again requires exponentially large satisfying diagrams, while RCC8c∘ can force regions in satisfying configurations to have infinitely many components.</abstract><keywords>Qualitative spatial reasoning;Spatial logic;Euclidean space;Connectedness;Satisfiability;Complexity</keywords><content><section label="1"><section-title>Introduction</section-title><paragraph>Spatial reasoning in everyday life possesses two distinctive—and related—characteristics: it is primarily concerned with extended, as opposed to point-like entities, and it typically invokes qualitative, as opposed to quantitative, concepts [1], [2], [3]. This observation has prompted consideration, within the Artificial Intelligence community, of representation languages whose variables range over some specified collection of extended spatial objects, and whose non-logical primitives are interpreted as qualitative spatial properties and relations involving those objects. As might be expected, the logical properties of such languages depend on the geometry of the spaces over which they are interpreted—in most applications, two- and three-dimensional Euclidean space. The present article draws attention to some hitherto overlooked subtleties regarding this dependency.</paragraph><paragraph>By far the best-known language for Qualitative Spatial Reasoning is {a mathematical formula}RCC8, originally proposed—in essentially equivalent formulations—by Egenhofer and Franzosa [4], Egenhofer and Herring [5], Randell et al. [6] and Smith and Park [7]. This quantifier-free language allows us to specify how regions and their interiors are related to each other. It employs an infinite collection of variables {a mathematical formula}r1,r2,…, ranging over spatial regions, together with six binary predicates: NTPP (non-tangential proper part), TPP (tangential proper part), EQ (equality), PO (partial overlap), EC (external contact) and DC (disjointness). The relations denoted by these predicates are illustrated, for closed discs in the plane, in Fig. 1. More formally: {a mathematical formula}NTPP(r1,r2) if {a mathematical formula}r1 is included in the interior of {a mathematical formula}r2; {a mathematical formula}TPP(r1,r2) if {a mathematical formula}r1 is included in {a mathematical formula}r2 but not in its interior; {a mathematical formula}PO(r1,r2) if the interiors of {a mathematical formula}r1 and {a mathematical formula}r2 intersect, but neither is included in the other; and {a mathematical formula}EC(r1,r2) if {a mathematical formula}r1 and {a mathematical formula}r2 intersect, but their interiors do not. A constraint is a statement {a mathematical formula}R(ri,rj), where R is one of these six predicates. For example, the constraints{a mathematical formula} state that regions {a mathematical formula}r1 and {a mathematical formula}r2 are in external contact, with the former a tangential proper part of {a mathematical formula}r3 and the latter a non-tangential proper part of {a mathematical formula}r4. Fig. 2 shows two arrangements of regions satisfying these constraints.</paragraph><paragraph>The {a mathematical formula}RCC8-relations mentioned above were defined in [6] by means of a formalism referred to there as the Region Connection Calculus. Of these, the relations NTPP and TPP are asymmetric: counting their converses, {a mathematical formula}NTPP−1 and {a mathematical formula}TPP−1, we obtain eight relations in all, hence the name {a mathematical formula}RCC8. Syntactically, the original Region Connection Calculus is the language of first-order logic (with equality) over the signature consisting of a single binary predicate C, variously referred to as ‘contact’, or (confusingly) ‘connection.’ The origin of this predicate can be traced back, via Clarke [8], [9], to the philosophical work of Whitehead [10] and de Laguna [11]. Semantically, one is supposed to think of C as holding between two regions just in case they share at least one point, though matters are somewhat muddied by the recurrent suggestion that this notion should be regarded as an (undefined) primitive. However, the etymology of the term {a mathematical formula}RCC8 need not concern us further: it is now standardly used for the quantifier-free language featuring the six primitives illustrated in Fig. 1, and we simply follow suit. The motivation for focussing on this particular collection of primitives is not always clear. Egenhofer and Franzosa [4] and Egenhofer and Herring [5] classify relationships between regions in terms of intersections of their interiors, exteriors and boundaries and show, in particular, that only the {a mathematical formula}RCC8 relations are possible between closed disc-homeomorphs in the Euclidean plane. Düntsch, Wang and McCloskey [12] observe that NTPP, TPP, EQ, PO, EC, DC, {a mathematical formula}NTPP−1 and {a mathematical formula}TPP−1 are exactly the atoms of the smallest relation algebra defined on the set of closed discs in the Euclidean plane that contains the contact relation, C. In fact, Li and Ying [13] show that the set of closed disc-homeomorphs in the Euclidean plane realizes the same relation algebra. (See also Li and Li [14] for an interesting extension of this result.) In any case, the language {a mathematical formula}RCC8 is by now firmly established as a basic formalism in the field of Qualitative Spatial Reasoning. In particular, the standard geographic query language for RDF data GeoSPARQL,{sup:1} suggested by the Open Geospatial Consortium, is based on the {a mathematical formula}RCC8 relations.</paragraph><paragraph>How are we to understand spatial reasoning in {a mathematical formula}RCC8? Observe that, in (1), nothing is said about the relation between {a mathematical formula}r3 and {a mathematical formula}r4. What are the possibilities? A little thought suffices to convince us that DC and EC are both impossible. As we might say, the two sets of constraints{a mathematical formula}{a mathematical formula} are unsatisfiable. Allowing ourselves to combine {a mathematical formula}RCC8-constraints using arbitrary sentential connectives, we could express this knowledge as a formula{a mathematical formula} which we take to be true of all tuples of regions {a mathematical formula}r1,…,r4. The validity of this formula thus represents a geometrical fact to which an agent employing {a mathematical formula}RCC8 as a spatial representation language should have access. Satisfiability and validity being dual notions, it suffices, from a computational perspective, to consider only the former. And since, in this context, nothing essential is added by sentential connectives, we may confine attention in the sequel to finite sets of constraints, interpreted conjunctively. Following common practice, we refer to such a set as an {a mathematical formula}RCC8-constraint network (or, simply, {a mathematical formula}RCC8-network).</paragraph><paragraph>When introducing the notion of satisfiability of {a mathematical formula}RCC8-networks, we employed the term spatial region as if it needed no clarification, giving as examples the regions in Fig. 1, Fig. 2. But what is a spatial region, exactly? In formal terms, when we ask whether an {a mathematical formula}RCC8-network is satisfiable, over what domain are we taking its variables to range? Fix some topological space T. A subset {a mathematical formula}X⊆T is said to be regular closed if X is the topological closure of some open set in T (equivalently, if it is equal to the closure of its interior). We denote the non-empty, regular closed subsets of T by {a mathematical formula}RC+(T). Most recent literature on Qualitative Spatial Reasoning takes regions to be elements of {a mathematical formula}RC+(Rn) for some fixed n (usually 2 or 3). Roughly speaking, the regular closed subsets of {a mathematical formula}R2 are those closed sets with no ‘filaments’ or ‘isolated points’ (Fig. 3a); similarly, the regular closed subsets of {a mathematical formula}R3 are those closed sets with no ‘flanges,’ ‘filaments’ or ‘isolated points’ (Fig. 3b). Determining the satisfiability of collections of {a mathematical formula}RCC8 constraints over {a mathematical formula}RC+(Rn) has been the subject of intensive research; see, e.g. [15], [16], [17], [18]. It is known that satisfiability does not depend on dimension: that is, if an {a mathematical formula}RCC8-network is satisfiable over {a mathematical formula}RC+(Rn) for some {a mathematical formula}n≥1, then it is satisfiable over {a mathematical formula}RC+(Rn) for every such n[19]. This (common) satisfiability problem is known to be NLogSpace-complete [15], [17], [20], [21]. We mention in this connection that some authors allow {a mathematical formula}RCC8-constraints to feature sets of the basic {a mathematical formula}RCC8-relations of Fig. 1, interpreted disjunctively. Thus, for example, the constraint {a mathematical formula}{NTPP,TPP,EQ}(r1,r2) states that {a mathematical formula}r1 is a (proper or improper) part of {a mathematical formula}r2. This extension entails a computational cost: the satisfiability problem for sets of disjunctive {a mathematical formula}RCC8 constraints is NP-complete [22], though optimized algorithms have been developed to attack it [23]. More generally, one could allow the unrestricted use of Boolean connectives in {a mathematical formula}RCC8-constraints, in which case it is easy to see that the problem of determining satisfiability over {a mathematical formula}RC+(Rn) is also NP-complete. However, from the point of view of this article, nothing is gained by considering such extensions of the {a mathematical formula}RCC8-formalism, and we do not consider them in the sequel.</paragraph><paragraph>At first glance, the regular closed sets in Euclidean space serve as an attractive mathematical model of our pre-theoretic notion of a spatial region. No two regular closed subsets of {a mathematical formula}Rn differ only with respect to boundary points; at the same time, the regular closed sets of any topological space form a Boolean algebra under the natural operations of ‘fusion,’ ‘complementation’ and ‘taking common parts.’ Thus, confining attention to regular closed sets allows us to finesse the apparently senseless question of whether the regions occupied by physical objects include their boundaries, while at the same time retaining a simple algebra for manipulating regions. Closer inspection, however, reveals a more complicated picture. Most obviously, regular closed sets may consist of more than one ‘piece,’ and may contain ‘holes’; and such sets may not necessarily be what we have in mind when we speak of regions. In 3-dimensional space (or more), this matter may safely be ignored: any collection of {a mathematical formula}RCC8-constraints satisfiable by elements of {a mathematical formula}RC+(Rn) ({a mathematical formula}n≥3) is satisfiable by regions homeomorphic to n-dimensional balls. In dimensions 1 and 2, by contrast, we are not free to assume that regions are so simple, and in particular are not free to assume that they are connected. This is most easily seen in 1-dimensional space, where the connected, non-empty, regular closed subsets are the intervals of the forms {a mathematical formula}(−∞,b], {a mathematical formula}[a,b] or {a mathematical formula}[a,∞) (with {a mathematical formula}a&lt;b). Thus, for example, the {a mathematical formula}RCC8-network{a mathematical formula} is satisfiable over {a mathematical formula}RC+(R) by the assignment {a mathematical formula}r1=[0,1], {a mathematical formula}r2=[1,2], {a mathematical formula}r3=[−1,0]∪[2,3]; however, (4) is obviously not satisfiable by connected elements of {a mathematical formula}RC+(R). Likewise, there exist {a mathematical formula}RCC8-networks that are satisfiable over {a mathematical formula}RC+(R2), but not by connected elements of {a mathematical formula}RC+(R2). (We shall encounter an example in Section 4.) The moral of these observations is that the notion of regionhood provided by the non-empty regular closed sets may be too liberal for many applications.</paragraph><paragraph>What, then, would a more conservative approach look like? We have two options. The first is to restrict, by fiat, the domain over which our variables can range to those regular closed sets satisfying certain additional properties; the second is to expand our language with additional primitives able to express those properties. An example of the first approach is provided by Schaefer, Sedgwick and Štefankovič [24], [25], who considered the {a mathematical formula}RCC8-satisfiability problem over sets of closed disc-homeomorphs in {a mathematical formula}R2. They showed that this problem is NP-complete rather than NLogSpace-complete over {a mathematical formula}RC+(R2). (However, it is membership in NP rather than NP-hardness that is remarkable.) An example of the second approach is provided by Davis, Gotts and Cohn [26], who investigated the extension of {a mathematical formula}RCC8 with constraints of the form {a mathematical formula}conv(r) (‘r is convex’). They showed that the satisfiability problem for this language, interpreted over {a mathematical formula}RC+(R2), is again decidable, though with the same complexity as the satisfiability problem for quantifier-free real arithmetic. The present article also takes this latter approach. In particular, we investigate the language {a mathematical formula}RCC8c, which extends {a mathematical formula}RCC8 with constraints of the form {a mathematical formula}c(r) (‘r is connected’). Unlike {a mathematical formula}RCC8, {a mathematical formula}RCC8c can discriminate between low-dimensional Euclidean spaces. Indeed, as we saw in our discussion of (4), the {a mathematical formula}RCC8c-network{a mathematical formula} is not satisfiable over {a mathematical formula}RC+(R); on the other hand, (5)is satisfiable over {a mathematical formula}RC+(R2), for example, as in Fig. 4a. In Section 4, we present an {a mathematical formula}RCC8c-network that is not satisfiable over {a mathematical formula}RC+(R2), but is satisfiable over {a mathematical formula}RC+(R3). However, it is easily seen that the satisfiability of {a mathematical formula}RCC8c-networks over {a mathematical formula}RC+(Rn) coincides for all {a mathematical formula}n≥3. As we might put it, {a mathematical formula}RCC8c can tell the difference between dimensions 1, 2 and 3; however, it cannot tell the difference between dimensions greater than or equal to 3.</paragraph><paragraph>Actually, the topological notion of connectedness is perhaps not quite what we might have in mind for certain applications of qualitative spatial reasoning. Consider, for example, the region formed by two closed triangles touching externally at a common vertex, as in Fig. 4b. This set is—according to the usual definition—connected, though its interior is not. And indeed, we are loath to take such a figure to represent, say, a contiguous plot of land on a map, since no extended object, however small, could squeeze from one part of this region to another without crossing its boundary.{sup:2} Accordingly, we additionally consider the language {a mathematical formula}RCC8c∘, which extends {a mathematical formula}RCC8 with constraints of the form {a mathematical formula}c∘(r) (‘r has a connected interior’). For regular closed sets in Euclidean space of dimension greater than 1, the property of having a connected interior is strictly stronger than the property of being connected. (For {a mathematical formula}RC+(R), connectedness and the property of having a connected interior coincide.) Again, it is routine to show that {a mathematical formula}RCC8c∘ can tell the difference between dimensions 1, 2 and 3, but no more.</paragraph><paragraph>The property of having a connected interior, however, brings into relief a further important issue regarding the sets of points which we are prepared to countenance as regions—one that has gone largely unnoticed in the literature on Qualitative Spatial Reasoning. Consider the two closed subsets of {a mathematical formula}R2 depicted in Fig. 5. The left-hand region is disconnected—indeed it has infinitely many components spiralling endlessly inwards towards a limit point. (Note that, since the set in question is closed, it must contain this limit point.) By contrast, the right-hand region is connected—indeed it has a connected interior—but spirals endlessly outwards in ever more compressed cycles towards a limiting hexadecagon. (Again, since the set in question is closed, it includes this limiting hexadecagon.) Both sets are easily seen to be regular closed. Nevertheless, both are in some sense illegitimate: they could never correspond to the parts of surfaces occupied (or left unoccupied) by physical objects. The question thus arises as to whether such ‘regions’ make a difference to the satisfiability of spatial constraints. After all, it might be of little comfort to know that a collection of constraints is satisfiable if the only satisfying assignments involve regions which make no physical sense. The answer depends, of course, on where we draw the distinction between legitimate and illegitimate regions; but fortunately, we have a natural answer at hand. Let us say that a region is polyhedral if it is a finite union of finite intersections of closed half-planes. Equivalently, a polyhedral region is a regular closed region that is semi-linear—definable (using standard Cartesian coordinates) by means of a Boolean combination of linear inequalities. Polyhedral sets, in this sense, are not required to be connected, or bounded, and are not required to have connected complements; however, they never exhibit the strangeness of the regular closed sets depicted in Fig. 5. In particular, all polyhedra consist of finitely many ‘pieces’ (contrast Fig. 5a), and have boundaries that are ‘reachable’ from their interiors (contrast Fig. 5b). (We make the relevant notions precise below.) The regular closed polyhedral sets in {a mathematical formula}Rn form a Boolean sub-algebra of the regular closed algebra, and we denote its non-empty elements by {a mathematical formula}RCP+(Rn).</paragraph><paragraph>Arguably, the really important problem regarding any language for Qualitative Spatial Reasoning is that of determining the satisfiability of networks over {a mathematical formula}RCP+(Rn), rather than over {a mathematical formula}RC+(Rn). For any bounded subset of {a mathematical formula}Rn can be approximated with arbitrary precision by an element of {a mathematical formula}RCP+(Rn), a fact which underlies the almost universal adoption of semi-linear sets as a spatial data model for Geographical Information Systems (GIS). Does restricting attention to polyhedral regions make a difference to satisfiability? For {a mathematical formula}RCC8 (which lacks connectedness constraints), the answer is no: any collection of {a mathematical formula}RCC8-constraints satisfiable over {a mathematical formula}RC+(Rn) ({a mathematical formula}n≥1) is easily seen to be satisfiable over {a mathematical formula}RCP+(Rn); as we might put it, {a mathematical formula}RCC8 is insensitive to the difference between {a mathematical formula}RC+(Rn) and {a mathematical formula}RCP+(Rn). In the sequel, we show that {a mathematical formula}RCC8c (equivalently, {a mathematical formula}RCC8c∘) is sensitive to the difference between {a mathematical formula}RC+(R) and {a mathematical formula}RCP+(R); we further show that {a mathematical formula}RCC8c∘ is sensitive to the difference between {a mathematical formula}RC+(R2) and {a mathematical formula}RCP+(R2), but that {a mathematical formula}RCC8c is not. Both languages are easily seen to be insensitive to the difference between {a mathematical formula}RC+(Rn) and {a mathematical formula}RCP+(Rn) for {a mathematical formula}n≥3. Thus, when working with {a mathematical formula}RCC8 or {a mathematical formula}RCC8c in the Euclidean plane, we can ignore the issue of ‘wild’ regions; when working with {a mathematical formula}RCC8c∘, we cannot. That is, when interpreting {a mathematical formula}RCC8c∘ over the Euclidean plane, we have two problems to consider: satisfiability over {a mathematical formula}RCP+(R2) and satisfiability over {a mathematical formula}RC+(R2).</paragraph><paragraph>The plan of the article is as follows. Section 2 provides formal definitions of the languages {a mathematical formula}RCC8, {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘. Section 3 establishes various topological facts about their principal domains of interpretation, {a mathematical formula}RC+(R2) and {a mathematical formula}RCP+(R2). Section 4 provides a systematic treatment of various results on {a mathematical formula}RCC8 that have appeared in the literature. Specifically, we show that, for {a mathematical formula}n≥1, the satisfiability problems for {a mathematical formula}RCC8 over both {a mathematical formula}RC+(Rn) and {a mathematical formula}RCP+(Rn) all coincide, and are NLogSpace-complete. We also obtain, as a simple corollary, corresponding results for the languages {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘ where {a mathematical formula}n≥3. In Section 5, we show that {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘ are sensitive to dimension n in the range {a mathematical formula}1≤n≤3; we further show that these languages are sensitive to the difference between {a mathematical formula}RC+(R) and {a mathematical formula}RCP+(R), that {a mathematical formula}RCC8c∘ is sensitive to the difference between {a mathematical formula}RC+(R2) and {a mathematical formula}RCP+(R2), but that {a mathematical formula}RCC8c is insensitive to the difference between {a mathematical formula}RC+(R2) and {a mathematical formula}RCP+(R2). Having mapped out the landscape of satisfiability problems, we then turn to the question of computational complexity. Section 6 deals with the one-dimensional case: we show that the satisfiability problems for {a mathematical formula}RCC8c (equivalently, {a mathematical formula}RCC8c∘) over {a mathematical formula}RC+(R) and {a mathematical formula}RCP+(R) are both NP-complete. Section 7 considers the more interesting, and challenging, two-dimensional case. We show that the satisfiability problem for {a mathematical formula}RCC8c over {a mathematical formula}RC+(R2)—equivalently, over {a mathematical formula}RCP+(R2)—is NP-complete; and we show that the satisfiability problem for {a mathematical formula}RCC8c∘ over {a mathematical formula}RCP+(R2) is also NP-complete. The decidability of the satisfiability problem for {a mathematical formula}RCC8c∘ over {a mathematical formula}RC+(R2) is left open. In the final section, we investigate the ability of the languages considered above to enforce ‘fragmented’ satisfying arrangements, showing that {a mathematical formula}RCC8, {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘ all exhibit different behaviour. For any {a mathematical formula}RCC8-network satisfiable over {a mathematical formula}RC+(R2), we are guaranteed a satisfying tuple whose diagram is bounded in size by a polynomial function of the number of constraints. We show that, when interpreted over {a mathematical formula}RCP+(R2), this result fails for {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘: specifically, we construct a sequence of satisfiable constraints {a mathematical formula}Φn (in either language) such that the size of {a mathematical formula}Φn grows polynomially as a function of n, and such that the smallest configuration of polygons satisfying {a mathematical formula}Φn cuts the plane into a number of pieces that grows exponentially in n. We further show that, over {a mathematical formula}RC+(R2), {a mathematical formula}RCC8c again requires exponentially large satisfying diagrams, while {a mathematical formula}RCC8c∘ can force regions in satisfying configurations to have infinitely many components. The differences that emerge between the superficially similar languages {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘ in the Euclidean plane provide a striking illustration of the subtleties that need to be confronted when working with even relatively simple languages extending {a mathematical formula}RCC8.</paragraph></section><section label="2"><section-title>Preliminaries</section-title><paragraph>Let T be a topological space. We denote the closure of any {a mathematical formula}X⊆T by {a mathematical formula}X−, the interior of X by {a mathematical formula}X∘, and the boundary of X by {a mathematical formula}δX=X−∖X∘. We call X regular closed if {a mathematical formula}X=X∘−, and denote by {a mathematical formula}RC(T) the set of all regular closed subsets of T. We preferentially use the (possibly decorated) letters p, q, r, s, t to range over regular closed sets. It is a standard result that {a mathematical formula}RC(T) is a Boolean algebra under the operations {a mathematical formula}r+s=r∪s, {a mathematical formula}r⋅s=(r∘∩s∘)−, {a mathematical formula}−r=(T∖r)−, {a mathematical formula}1=T and {a mathematical formula}0=∅; in fact, this Boolean algebra is complete, with {a mathematical formula}∑X=((⋃X)∘)− and {a mathematical formula}∏X=(⋂X∘)− for any {a mathematical formula}X⊆T[27, pp. 25–27]. We write {a mathematical formula}RC+(T) as an abbreviation for {a mathematical formula}RC(T)∖{∅}. A subset {a mathematical formula}X⊆T is compact if any cover of X by open sets has a finite subcover; when {a mathematical formula}T=Rn, this property coincides with that of being closed and bounded. Any subset {a mathematical formula}X⊆T has a subspace topology, whose open sets are those of the form {a mathematical formula}O∩X, where O is open in T; X is connected if it cannot be covered by the union of two non-empty and disjoint subsets which are open in the subspace topology. A maximal connected subset of X is called a component of X. We say that X is interior-connected if {a mathematical formula}X∘ is connected. For elements of {a mathematical formula}RC(T), interior-connectedness implies connectedness (indeed, if {a mathematical formula}X∘ is connected then its closure, X, is connected as well), but not vice versa.</paragraph><section label="2.1"><section-title>Constraint networks</section-title><paragraph>If T is any topological space, we define eight binary relations on {a mathematical formula}RC+(T) as follows:{a mathematical formula} Together, these are known as the {a mathematical formula}RCC8-relations. The first six are illustrated, for closed discs in the plane, in Fig. 1. It is routine to show that the {a mathematical formula}RCC8-relations are jointly exhaustive and pairwise disjoint (JEPD) over {a mathematical formula}RC+(T) for any topological space T: given {a mathematical formula}r,s∈RC+(T), the ordered pair {a mathematical formula}(r,s) lies in exactly one of the {a mathematical formula}RCC8-relations.</paragraph><paragraph>Fix some countably infinite set of variables, {a mathematical formula}V. An {a mathematical formula}RCC8-constraint is an expression {a mathematical formula}R(r,s), where {a mathematical formula}r,s∈V and R is one of the symbols DC, EC, PO, EQ, TPP, NTPP, {a mathematical formula}TPP−1 or {a mathematical formula}NTPP−1; an {a mathematical formula}RCC8c-constraint is either an {a mathematical formula}RCC8-constraint or an expression of the form {a mathematical formula}c(r), where {a mathematical formula}r∈V; an {a mathematical formula}RCC8c∘-constraint is either an {a mathematical formula}RCC8-constraint or an expression of the form {a mathematical formula}c∘(r), where {a mathematical formula}r∈V. An {a mathematical formula}RCC8-constraint network is a finite set of {a mathematical formula}RCC8-constraints; and similarly for {a mathematical formula}RCC8c-constraint network and {a mathematical formula}RCC8c∘-constraint network. When writing constraint networks, the relations {a mathematical formula}TPP−1 and {a mathematical formula}NTPP−1 can always be eliminated by transposing variables. In the sequel, therefore, we typically employ only the six relations DC, EC, PO, EQ, TPP and NTPP.</paragraph><paragraph>If T is a topological space, a frame over T is a subset {a mathematical formula}F⊆RC+(T). Typical examples of frames are the set of closed disc-homeomorphs in {a mathematical formula}R2 or the set of regular closed polyhedra in {a mathematical formula}R3. Where {a mathematical formula}F is clear from context, we refer to its elements as regions. An assignment over a frame {a mathematical formula}F is a function {a mathematical formula}a:V→F. We say that {a mathematical formula}asatisfies an {a mathematical formula}RCC8-constraint {a mathematical formula}R(r,s) if {a mathematical formula}a(r) stands in the relation R to {a mathematical formula}a(s); we say that {a mathematical formula}asatisfies{a mathematical formula}c(r) if {a mathematical formula}a(r) is connected, and {a mathematical formula}asatisfies{a mathematical formula}c∘(r) if {a mathematical formula}a(r) is interior-connected. A constraint network Φ is satisfied by {a mathematical formula}a if {a mathematical formula}a satisfies all the constraints in Φ; and Φ is satisfiable over {a mathematical formula}F if some {a mathematical formula}a:V→F satisfies Φ. To aid readability, we use the (possibly decorated) letters {a mathematical formula}p,q,r,s,t,…both for variables and for the regions they are mapped to by some (putative) assignment. We remark that, since, for regular closed sets, interior-connectedness implies connectedness, any assignment satisfying an {a mathematical formula}RCC8c∘-constraint network Φ automatically satisfies the {a mathematical formula}RCC8c-constraint network obtained by replacing every occurrence of {a mathematical formula}c∘ in Φ by c. We remark in passing that, in place of regular closed sets, we could just as easily have worked with regular open sets. (A set X is regular open if {a mathematical formula}X=(X−)∘.) The regular open subsets of a topological space T form a Boolean algebra isomorphic to {a mathematical formula}RC(T). Of course, in that case, we would have to work with the predicates {a mathematical formula}c− (denoting the property of having a connected closure) and c, in place of c and {a mathematical formula}c∘; but otherwise, there would be no difference. Our choice of regular closed sets is purely a matter of convention.</paragraph><paragraph>We employ the convention that, if {a mathematical formula}r¯=r1,…,rn is some tuple of variables, {a mathematical formula}Φ(r¯) is the constraint network Φ with variables taken in the indicated order. (Thus, for instance, we can meaningfully say that the two constraint networks {a mathematical formula}Φ(r¯) and {a mathematical formula}Ψ(s¯) are satisfied by the same tuples of regions.) We take the notation {a mathematical formula}Φ(r¯) to indicate that Φ contains no variables other than {a mathematical formula}r1,…,rn; however, we do not insist that each {a mathematical formula}ri actually occurs in Φ. If {a mathematical formula}L is any of the languages {a mathematical formula}RCC8, {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘, we denote by {a mathematical formula}Sat(L,F) the satisfiability problem for {a mathematical formula}L-constraint networks over {a mathematical formula}F, namely:{a mathematical formula}</paragraph></section><section label="2.2"><section-title>Type-certificates and point-certificates</section-title><paragraph>For a set {a mathematical formula}V of variables, we take the set {a mathematical formula}V∘={r∘|r∈V} and call its elements interior terms. Interior terms will be used in some of the proofs below; however, we stress that they are not part of the syntax of the languages {a mathematical formula}RCC8, {a mathematical formula}RCC8c or {a mathematical formula}RCC8c∘. Variables and interior terms will be referred to as terms.</paragraph><paragraph>Let {a mathematical formula}Φ(r¯) be an {a mathematical formula}RCC8-constraint network. Observe that the semantics of {a mathematical formula}RCC8-constraints was defined above using universal conditions such as {a mathematical formula}r1⊆r2 (that is, {a mathematical formula}∀x(x∈r1→x∈r2)) and existential conditions such as {a mathematical formula}r2⊈r1 (that is, {a mathematical formula}∃x(x∈r2∧x∉r1)). Thus, to satisfy Φ in {a mathematical formula}RC+(T), we have to find an assignment {a mathematical formula}a over {a mathematical formula}RC+(T) providing witnesses for all the existential conditions given by Φ (including non-emptiness of regions) and complying with the universal ones. The following notion will be used to characterize membership of points in regions assigned to variables of Φ. A Φ-type (or simply type when Φ is clear) is any set τ of terms with variables from Φ such that</paragraph><list><list-item>for each variable r in Φ, if {a mathematical formula}r∘∈τ then {a mathematical formula}r∈τ.</list-item></list><paragraph> A set of Φ-types {a mathematical formula}τ1,…,τm is called a type-certificate for Φ if it satisfies the following existential conditions:</paragraph><list><list-item>for each variable r in Φ, there is k ({a mathematical formula}1≤k≤m) for which {a mathematical formula}r∘∈τk;</list-item><list-item>for each {a mathematical formula}EC(ri,rj)∈Φ, there is k ({a mathematical formula}1≤k≤m) for which {a mathematical formula}ri,rj∈τk;</list-item><list-item>for each {a mathematical formula}PO(ri,rj)∈Φ, there is k ({a mathematical formula}1≤k≤m) for which {a mathematical formula}ri∘,rj∘∈τk;</list-item><list-item>for each {a mathematical formula}PO(ri,rj)∈Φ, each {a mathematical formula}PO(rj,ri)∈Φ, each {a mathematical formula}TPP(ri,rj)∈Φ and each {a mathematical formula}NTPP(ri,rj)∈Φ, there is k ({a mathematical formula}1≤k≤m) for which {a mathematical formula}rj∘∈τk and {a mathematical formula}ri∉τk (note that {a mathematical formula}rj⊈ri if and only if {a mathematical formula}rj∘∖ri≠∅ for regular closed {a mathematical formula}ri and {a mathematical formula}rj);</list-item><list-item>for each {a mathematical formula}TPP(ri,rj)∈Φ, there is k ({a mathematical formula}1≤k≤m) for which {a mathematical formula}ri∈τk and {a mathematical formula}rj∘∉τk,</list-item></list><paragraph> as well as the following universal conditions, for all k ({a mathematical formula}1≤k≤m):</paragraph><list><list-item>for each {a mathematical formula}DC(ri,rj)∈Φ, either {a mathematical formula}ri∉τk or {a mathematical formula}rj∉τk;</list-item><list-item>for each {a mathematical formula}EC(ri,rj)∈Φ, either {a mathematical formula}ri∘∉τk or {a mathematical formula}rj∉τk and either {a mathematical formula}rj∘∉τk or {a mathematical formula}ri∉τk (note that {a mathematical formula}ri∘∩rj∘=∅ is equivalent to {a mathematical formula}ri∘∩rj=∅ and {a mathematical formula}ri∩rj∘=∅ for regular closed {a mathematical formula}ri and {a mathematical formula}rj);</list-item><list-item>for each {a mathematical formula}EQ(ri,rj)∈Φ, {a mathematical formula}ri∈τk if and only if {a mathematical formula}rj∈τk, and {a mathematical formula}ri∘∈τk if and only if {a mathematical formula}rj∘∈τk;</list-item><list-item>for each {a mathematical formula}TPP(ri,rj)∈Φ, if {a mathematical formula}ri∈τk then {a mathematical formula}rj∈τk, and if {a mathematical formula}ri∘∈τk then {a mathematical formula}rj∘∈τk;</list-item><list-item>for each {a mathematical formula}NTPP(ri,rj)∈Φ, if {a mathematical formula}ri∈τk then {a mathematical formula}rj∘∈τk.</list-item></list><paragraph> Given an assignment {a mathematical formula}a over {a mathematical formula}RC+(T), we associate with every point {a mathematical formula}x∈T the Φ-type{a mathematical formula} and call it the Φ-type of x under{a mathematical formula}a. By the semantics of {a mathematical formula}RCC8, if {a mathematical formula}a satisfies {a mathematical formula}Φ(r¯) then there are points {a mathematical formula}xi, for {a mathematical formula}1≤i≤3|Φ|, whose Φ-types {a mathematical formula}τ(xi,a) form a type-certificate for Φ; we call any such set a point-certificate for Φ (under{a mathematical formula}a). Thus, every satisfiable constraint network Φ has a type-certificate of cardinality at most {a mathematical formula}3|Φ|. In Theorem 11, we establish a converse: if a set of {a mathematical formula}RCC8-constraints Φ has a type-certificate, then Φ is satisfiable over {a mathematical formula}RCP+(R). Lemma 24 extends this result to the language {a mathematical formula}RCC8c: if there is a type-certificate for Φ that satisfies certain additional ‘planarity’ conditions, then Φ is satisfiable over {a mathematical formula}RCP+(R2) with some chosen regions being connected. Lemma 26 gives a (partial) analogue for the language {a mathematical formula}RCC8c∘.</paragraph></section><section label="2.3"><section-title>Important frames</section-title><paragraph>Various frames over {a mathematical formula}Rn present themselves for consideration. Obviously, {a mathematical formula}RC+(Rn) itself is a frame; however, as mentioned in Section 1, we may wish to consider more restricted frames of ‘well-behaved’ regions.</paragraph><paragraph>A function {a mathematical formula}T→S from one topological space to another is continuous if the inverse image of any open set is an open set. A homeomorphism is a continuous function having a continuous inverse (on its range). We refer to a homeomorphism {a mathematical formula}α:[0,1]→Rn as a Jordan arc. The points {a mathematical formula}α(0) and {a mathematical formula}α(1) are called the endpoints of α; all other points of α are called internal points. Where no confusion results, we identify any Jordan arc α with its locus {a mathematical formula}α([0,1]). Two Jordan arcs α and β properly intersect if there is a point x which is an internal point of both α and β. If α, β are Jordan arcs having the unique common point {a mathematical formula}α(1)=β(0), we write αβ to denote, ambiguously, any Jordan arc from {a mathematical formula}α(0) to {a mathematical formula}β(1) with locus {a mathematical formula}α∪β. If {a mathematical formula}x1=α(a1) and {a mathematical formula}x2=α(a2) are points on α with {a mathematical formula}a2&gt;a1, then {a mathematical formula}α[x1,x2] denotes a Jordan arc whose locus is the segment of α between {a mathematical formula}x1 and {a mathematical formula}x2, and {a mathematical formula}α[x2,x1] denotes the same Jordan arc but with reversed orientation. A subset X of {a mathematical formula}Rn is arc-connected if any two points of X are joined by a Jordan arc lying in X. Arc-connectedness implies connectedness, and, for open sets, the converse implication holds. If {a mathematical formula}X⊆Rn and {a mathematical formula}x∈Rn, an end-cut (to x) in X is a Jordan arc {a mathematical formula}α⊆X∪{x} with endpoint x. If such an end-cut exists, then x is accessible from X. Denote by {a mathematical formula}S1 the unit circle (in {a mathematical formula}R2) and by {a mathematical formula}S2 the unit sphere (in {a mathematical formula}R3), with both sets having the subspace topology. Topologically, we may think of {a mathematical formula}Sn ({a mathematical formula}n=1,2) as the result of adding a ‘point at infinity’ to {a mathematical formula}Rn. We refer to a homeomorphism {a mathematical formula}γ:S1→T, where T is either {a mathematical formula}R2 or {a mathematical formula}S2, as a Jordan curve. Again, we identify Jordan curves with their loci, where convenient. The Jordan curve theorem states that, for any Jordan curve γ in {a mathematical formula}S2, its complement {a mathematical formula}S2∖γ has exactly two components. This theorem has a converse: if X is a closed set such that {a mathematical formula}S2∖X has two components, with each {a mathematical formula}x∈X accessible from both of them, then X is (the locus of) a Jordan curve (see, e.g., [28]). The Schönflies theorem states that, if {a mathematical formula}γ1 and {a mathematical formula}γ2 are Jordan curves in {a mathematical formula}S2 and f is a homeomorphism from (the locus of) {a mathematical formula}γ1 onto (the locus of) {a mathematical formula}γ2, then f can be extended to a homeomorphism from {a mathematical formula}S2 onto itself.</paragraph><paragraph>A subset {a mathematical formula}X⊆R2 (or {a mathematical formula}X⊆S2) is a closed disc-homeomorph if it is the homeomorphic image of the unit disc {a mathematical formula}{(a,b)|a2+b2≤1}. (The Schönflies theorem tells us that, topologically speaking, closed disc-homeomorphs in {a mathematical formula}S2—or indeed in {a mathematical formula}R2—are all the same.) Let {a mathematical formula}D denote the set of all closed disc-homeomorphs in {a mathematical formula}R2. Every element of {a mathematical formula}D is a non-empty, regular closed subset of {a mathematical formula}R2; thus, {a mathematical formula}D is a frame over {a mathematical formula}R2.</paragraph><paragraph>A half-space (in {a mathematical formula}Rn) is the set of points satisfying any non-degenerate linear inequality {a mathematical formula}a1x1+⋯+anxn≥c. Thus, every half-space is regular closed. Let the Boolean subalgebra of {a mathematical formula}RC(Rn) (finitely) generated by the half-spaces be denoted by {a mathematical formula}RCP(Rn), and write {a mathematical formula}RCP+(Rn) as an abbreviation for {a mathematical formula}RCP(Rn)∖{∅}. We refer to the elements of {a mathematical formula}RCP+(Rn) as polyhedra in {a mathematical formula}Rn. (If {a mathematical formula}n=2, we speak of polygons rather than polyhedra.) Thus, {a mathematical formula}RCP+(Rn) is a frame over {a mathematical formula}Rn. Note that polyhedra, in our sense, need not be connected, and need not have connected complements.</paragraph><paragraph>A subset of {a mathematical formula}Rn is said to be semi-algebraic if it is the solution set of a Boolean combination of polynomial inequalities with n variables. (Equivalently, a subset of {a mathematical formula}Rn is semi-algebraic if it is the set of points of {a mathematical formula}Rn satisfying a first-order formula in the language of arithmetic with n free variables.) The regular closed semi-algebraic subsets of {a mathematical formula}Rn can be shown to form a Boolean subalgebra of {a mathematical formula}RC(Rn); hence, the non-empty regular closed semi-algebraic subsets of {a mathematical formula}Rn also form a frame.</paragraph><paragraph>Let X be any collection of subsets of a topological space. We say that X has finite decomposition if every {a mathematical formula}X∈X is the union of finitely many connected elements of X. It is simple to show that {a mathematical formula}RCP+(Rn) has this property. On the other hand, {a mathematical formula}RC+(Rn) lacks finite decomposition, since it evidently contains regions with infinitely many components: the region in Fig. 5a is an example in the case {a mathematical formula}n=2. A set {a mathematical formula}r∈RC+(Rn) has the curve selection property if every {a mathematical formula}x∈δr is accessible from {a mathematical formula}r∘. It is immediate that all polyhedra have curve selection. On the other hand, curve selection fails for elements of {a mathematical formula}RC+(Rn). Consider, for example, the spiral region illustrated in Fig. 5b: there are no end-cuts in the interior of that region to any points lying on the limiting hexadecagon. We call a frame {a mathematical formula}F⊆RC+(Rn)tame if it has finite decomposition and each of its elements has curve selection. Thus, the frame {a mathematical formula}RCP+(Rn) is tame for all {a mathematical formula}n≥1, but {a mathematical formula}RC+(Rn) is not.</paragraph><paragraph>In fact, the frame of non-empty, regular closed, semi-algebraic subsets of {a mathematical formula}Rn can also be shown to be tame, for all {a mathematical formula}n≥1 (see [29, Theorems 2.4.4 and 2.5.5] for proofs). However, in {a mathematical formula}R, the regular closed, semi-algebraic subsets coincide with the regular closed, semi-linear subsets; and it is well-known that we may transform any finite collection of regular closed semi-algebraic subsets of {a mathematical formula}R2 into a collection of regular closed polygons by means of a homeomorphism of {a mathematical formula}R2 onto itself; hence satisfiability of any topological constraint network over the non-empty, regular closed semi-algebraic subsets of {a mathematical formula}R2 is equivalent to satisfiability over {a mathematical formula}RCP+(R2). Since the languages considered in this article cannot distinguish between regular closed sets {a mathematical formula}RC+(Rn) and polyhedra {a mathematical formula}RCP+(R3), for {a mathematical formula}n≥3, it follows that they cannot distinguish between polyhedra and regular closed, semi-algebraic sets in any dimension; in the sequel, therefore, we concentrate on the former for simplicity. The issue of tameness will play a large part in the ensuing discussion.</paragraph></section><section label="2.4"><section-title>Graphs and designs</section-title><paragraph>We employ the usual concepts and terminology of graph theory, with one or two non-standard extensions. A graph is a pair {a mathematical formula}G=(V,E), where V is a finite set and E a set of 2-element subsets of V. We call the elements of V vertices and the elements of E edges. If {a mathematical formula}|V|=n and E is the set of all 2-element subsets of V, we denote G by {a mathematical formula}Kn, the complete graph on n vertices. A graph {a mathematical formula}G′=(V′,E′) is a subgraph of G if {a mathematical formula}V′⊆V and {a mathematical formula}E′⊆E. If {a mathematical formula}e=(u,v) is an edge in some graph, we consider the operation of ‘shrinking’ that edge: e itself disappears, and the vertices u and v are replaced by a single new vertex, joined by edges to all and only those other vertices to which either u or v were joined in G. A graph H is a minor of G if H is the result of first taking a subgraph of G and then successively shrinking some number of edges.</paragraph><paragraph>If {a mathematical formula}G=(V,E) is a graph, a realization of G (in {a mathematical formula}R2) is an injective mapping f from V to points of {a mathematical formula}R2 and from E to Jordan arcs in {a mathematical formula}R2 such that, for each {a mathematical formula}e=(u,v)∈E: (i) the endpoints of {a mathematical formula}f(e) are {a mathematical formula}f(u) and {a mathematical formula}f(v); and (ii) no internal points of {a mathematical formula}f(e) are in {a mathematical formula}f(V). It is sometimes more convenient to replace {a mathematical formula}R2 in this context with the space {a mathematical formula}S2, in which case we speak of a realization in{a mathematical formula}S2. Of particular interest are realizations in which no two arcs have any internal points in common. (By the definition of realization, no internal point of one arc can be an endpoint of another.) We call such a realization a drawing of G. It is well-known that a graph G has a drawing in {a mathematical formula}R2 if and only if it has a drawing in {a mathematical formula}S2. If G has a drawing (in {a mathematical formula}R2 or {a mathematical formula}S2), G is said to be planar, and any drawing of G is called a plane graph. It is easy to see that any minor of a planar graph is a planar graph. Given any drawing of a (planar) graph G, we can recover G up to isomorphism. It is therefore customary to treat plane graphs as graphs, without comment. A graph G is k-connected if it has at least k vertices, and the removal of up to {a mathematical formula}k−1 of those vertices leaves G connected. Whitney's theorem (see [30, p. 79]) states that a 3-connected, planar graph has a unique drawing in {a mathematical formula}S2, up to a homeomorphism of {a mathematical formula}S2 onto itself.</paragraph><paragraph>The following generalization of the notion of planar graph will be used in this article. A design is a pair {a mathematical formula}D=(G,S), where {a mathematical formula}G=(V,E) is a graph and S a set of 2-element subsets of E. If {a mathematical formula}D=(G,S) is a design, a drawing of D (in either {a mathematical formula}R2 or {a mathematical formula}S2) is a realization f of {a mathematical formula}G=(V,E) with the additional property that, for all distinct {a mathematical formula}e,e′∈E, {a mathematical formula}f(e) and {a mathematical formula}f(e′) have an internal point in common if and only if {a mathematical formula}(e,e′)∈S. We take the size of D to be {a mathematical formula}|D|=|V|+|E|+|S|. Again, a design has a drawing in {a mathematical formula}R2 if and only if it has a drawing in {a mathematical formula}S2. By the drawing problem for designs, we understand the following:{a mathematical formula} It is immediate from the above definitions that a graph G is planar if and only if the design {a mathematical formula}(G,∅) has a drawing. In fact, we can without loss of generality assume that all drawings have the following, rather particular form. Let us say that a drawing is rectified if all arcs are piecewise-linear (i.e., consist of finitely many straight line segments), and no two arcs share any (non-punctual) line segment. In that case, two arcs share an internal point if and only if they cross at that point (in the obvious sense); we call any such point an arc-crossing of the drawing. The following upper bound on the complexity of drawings of designs was obtained by Schaefer and Štefankovič:</paragraph><paragraph label="Proposition 1">(See[25].) Any drawable design D has a rectified drawing with{a mathematical formula}2O(|D|)arc-crossings.</paragraph><paragraph>The corresponding lower bound is due to Kratochvíl and Matoušek:</paragraph><paragraph label="Proposition 2">(See[31].) There exists a sequence of drawable designs{a mathematical formula}{Dn}n≥1, with{a mathematical formula}Dnof size{a mathematical formula}O(n), such that any rectified drawing of{a mathematical formula}Dnhas at least{a mathematical formula}2narc-crossings.</paragraph><paragraph>This lower bound notwithstanding, we have the following remarkable complexity result due to Schaefer, Sedgwick and Štefankovič:</paragraph><paragraph label="Proposition 3">(See[24].) The drawing problem for designs isNP-complete.</paragraph><paragraph>These authors then derive the following corollary, mentioned in Section 1:</paragraph><paragraph label="Proposition 4">(See[24], [25].){a mathematical formula}Sat(RCC8,D)is inNP.</paragraph><paragraph>We note in passing that Proposition 1 places an immediate upper bound on the total size of drawings for designs, via the following result of Schnyder:</paragraph><paragraph label="Proposition 5">(See[32].) Any plane graph with n vertices has a drawing on a{a mathematical formula}2n×2ngrid in which all vertices have integer coordinates and all edges are straight lines.</paragraph><paragraph>Closely related to the drawing problem for designs is the so-called string graph problem. Let {a mathematical formula}α1,…,αn be Jordan arcs. Form the graph {a mathematical formula}(V,E) where {a mathematical formula}V={α1,…,αn} and {a mathematical formula}(αi,αj)∈E just in case {a mathematical formula}i≠j and {a mathematical formula}αi and {a mathematical formula}αj have at least one point in common. Any graph G isomorphic to such a {a mathematical formula}(V,E) is called a string graph, and the sequence of Jordan arcs {a mathematical formula}α1,…,αn is called a string representation of G. By the string graph problem, we understand the following:{a mathematical formula} Kratochvíl obtained the following lower bound:</paragraph><paragraph label="Proposition 6">(See[33].) The string graph problem isNP-hard.</paragraph><paragraph>A matching upper bound can be obtained from Proposition 3, as shown in [24].</paragraph></section></section><section label="3">{a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘ in the Euclidean plane: technical lemmas<paragraph>This section presents some technical lemmas concerning the frames {a mathematical formula}RCP+(R2) and {a mathematical formula}RC+(R2); the reader may prefer to omit the proofs, which are straightforward, on first reading.</paragraph><section label="3.1"><section-title>Components, i-components and thickenings</section-title><paragraph>We make use of the following simple facts about {a mathematical formula}RC+(Rn) and {a mathematical formula}RCP+(Rn). Any connected {a mathematical formula}r∈RCP+(Rn) is arc-connected. This is not true for {a mathematical formula}RC+(Rn): the region in Fig. 5b is connected, but not arc-connected (there is no arc connecting a point on the limiting hexadecagon to a point in the interior of the region). On the other hand, for any interior-connected {a mathematical formula}r∈RC+(Rn), the (connected) open set {a mathematical formula}r∘ is arc-connected. The collection of sets {a mathematical formula}RCP+(Rn) is closed under taking components: if {a mathematical formula}r∈RCP+(Rn) and s is a component of r, then {a mathematical formula}s∈RCP+(Rn). This is not true for {a mathematical formula}RC+(Rn): the region in Fig. 5a has, as a component, the singleton set containing the central point; but this set is not regular closed.</paragraph><paragraph>The following terminology will be useful. If {a mathematical formula}r∈RC+(Rn) and X is a component of {a mathematical formula}r∘, then we call {a mathematical formula}X− an i-component of r (Fig. 6). Thus, r is interior-connected just in case it has exactly one i-component. It is easily verified that both {a mathematical formula}RC+(Rn) and {a mathematical formula}RCP+(Rn) are closed under taking i-components. Any {a mathematical formula}r∈RCP+(Rn) is the sum (in the Boolean algebra sense) of its components, and any {a mathematical formula}r∈RC+(Rn) is the sum of its i-components. If {a mathematical formula}r∈RCP+(Rn), then r has only finitely many i-components (hence only finitely many components), so that the relevant sums are finite. The proofs in this section make occasional use of i-components; however, i-components of a region are so visually salient that it is natural to ask what the languages {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘ can say about them: we address this question in Section 8.</paragraph><paragraph>The following lemma establishes a technique that will be used throughout this article.</paragraph><paragraph label="Proof">Let X and Y be closed subsets of{a mathematical formula}Rn. Then there exist elements r, s of{a mathematical formula}RC+(Rn)with{a mathematical formula}X⊆r∘and{a mathematical formula}Y⊆s∘, such that (i){a mathematical formula}X∩Y=∅⇒r∩s=∅; (ii){a mathematical formula}X⊈Y⇒r⊈s; (iii){a mathematical formula}Y⊈X⇒s⊈r; (iv) X is connected ⇒ r is interior-connected; (v) Y is connected ⇒ s is interior-connected. In addition, if X and Y are both bounded, then r and s may be assumed to be bounded elements of{a mathematical formula}RCP+(Rn).We consider first the case where X and Y are disjoint. Let P and Q be disjoint closed sets such that X lies in the interior of P and Y in the interior of Q. If x, y are elements of X, Y, respectively, let {a mathematical formula}rx, {a mathematical formula}sy be (non-intersecting) closed n-dimensional hyper-cubes containing x and y in their respective interiors, and contained within the interiors of P and Q, respectively. Recalling that {a mathematical formula}RC(Rn) is a complete Boolean algebra, set {a mathematical formula}r=∑x∈Xrx and {a mathematical formula}s=∑y∈Ysy. Notice that these sums are infinite, so that r and s are in {a mathematical formula}RC+(Rn), but not necessarily in {a mathematical formula}RCP+(Rn). Moreover, we remark that each {a mathematical formula}rx is interior-connected, and similarly for each {a mathematical formula}sy. Also, the interiors of the {a mathematical formula}rx form an open cover of X, and similarly for Y. This ensures that X is in the interior of r, and Y in the interior of s, while maintaining implications (i)–(iii). The other cases are handled similarly.Implication (iv) follows from the fact that each {a mathematical formula}rx is interior-connected. Similarly for implication (v). For the final statement of the lemma, suppose in addition that X and Y are bounded (hence compact). Then the open covers {a mathematical formula}{sy∘}y∈Y and {a mathematical formula}{rx∘}x∈X have finite subcovers, say {a mathematical formula}{sy∘}y∈Y0 and {a mathematical formula}{rx∘}x∈X0. We then define the regions r and s by taking the sums only over those elements of the finite subcovers. In that case, these regions will be bounded elements of {a mathematical formula}RCP+(Rn), as required.  □</paragraph><paragraph>Thus, we can in effect ‘thicken’ arbitrary connected closed subsets of {a mathematical formula}Rn into interior-connected elements of {a mathematical formula}RC+(Rn) without spoiling the properties of disjointness and non-inclusion. Indeed, bounded closed sets can be thickened into regions which are not merely bounded, but also polyhedral. For unbounded closed subsets of {a mathematical formula}Rn, we cannot in general insist that their thickened versions are polyhedral.</paragraph><paragraph>Lemma 7 can be generalized: given a collection of sets {a mathematical formula}X1,…,Xm, we may thicken them all simultaneously, maintaining pairwise satisfaction of the relevant spatial relations.</paragraph><paragraph label="Lemma 8">Let{a mathematical formula}X¯=X1,…,Xmbe a tuple of closed subsets of{a mathematical formula}Rn. Then there exist elements{a mathematical formula}r¯=r1,…,rmof{a mathematical formula}RC+(Rn)such that, for all i and j ({a mathematical formula}1≤i,j≤m), (i){a mathematical formula}Xi⊆ri∘; (ii){a mathematical formula}Xiis connected ⇒ {a mathematical formula}riis interior-connected; (iii){a mathematical formula}Xi∩Xj=∅⇒ri∩rj=∅; (iv){a mathematical formula}Xi⊈Xj⇒ri⊈rj. In addition, if{a mathematical formula}X1,…,Xmare all bounded, then{a mathematical formula}r1,…,rmmay be assumed to be bounded elements of{a mathematical formula}RCP+(Rn).</paragraph><paragraph label="Proof">We first observe that the proof of Lemma 7 yields slightly more than advertised. Conditions (ii) and (iii) can be strengthened as follows: (ii′) {a mathematical formula}X⊈Y⇒X⊈s; and (iii′) {a mathematical formula}Y⊈X⇒Y⊈r. Now, for all i, j with {a mathematical formula}1≤i&lt;j≤m, apply Lemma 7 to {a mathematical formula}X=Xi and {a mathematical formula}Y=Xj to obtain the sets {a mathematical formula}ri,j=r and {a mathematical formula}si,j=s. For all {a mathematical formula}1≤i≤m, let{a mathematical formula} If {a mathematical formula}Xi is connected, let {a mathematical formula}ri be the i-component of {a mathematical formula}ri′ including {a mathematical formula}Xi; otherwise, let {a mathematical formula}ri=ri′. Using Conditions (ii′) and (iii′), it is easy to see that the {a mathematical formula}ri are as required.  □</paragraph><paragraph>Lemma 7, Lemma 8 are required in the sequel only in the case {a mathematical formula}n=2.</paragraph></section><section label="3.2">Encoding graphs and designs in {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘<paragraph>Let {a mathematical formula}D=(G,S) be a design, and let the vertices {a mathematical formula}v1,…,vn and edges {a mathematical formula}e1,…,em of G be ordered in some fixed way. We denote by {a mathematical formula}u(j) and {a mathematical formula}v(j) the indices of the vertices incident on {a mathematical formula}ej (with {a mathematical formula}u(j)&lt;v(j)). Now let {a mathematical formula}r¯=r1,…,rn and {a mathematical formula}s¯=s1,…,sm be tuples of elements of {a mathematical formula}RC+(R2). We say that a drawing f of D is strongly embedded in the tuple {a mathematical formula}r¯s¯ if{a mathematical formula} If D has a drawing that is strongly embedded in the tuple {a mathematical formula}r¯s¯, then D is said to be strongly embeddable in{a mathematical formula}r¯s¯. If G is a planar graph such that the design {a mathematical formula}(G,∅) is strongly embeddable in {a mathematical formula}r¯s¯, then G is said to be strongly embeddable in{a mathematical formula}r¯s¯. Fig. 7 shows that the planar graph {a mathematical formula}K4 is strongly embeddable in the tuple {a mathematical formula}r1,…,r4,s1,…,s6.</paragraph><paragraph>We employ {a mathematical formula}RCC8c∘-constraint networks to capture strong embeddability of planar graphs. Let G be a graph with vertices {a mathematical formula}v1,…,vn and edges {a mathematical formula}e1,…,em ordered in some fixed way. Define the {a mathematical formula}RCC8c∘-constraint network {a mathematical formula}ΩG∘(r¯,s¯), for {a mathematical formula}r¯=r1,…,rn and {a mathematical formula}s¯=s1,…,sm, by taking, for {a mathematical formula}1≤i≠i′≤n and {a mathematical formula}1≤j≠j′≤m,{a mathematical formula}</paragraph><paragraph label="Lemma 9">Let G be a graph. (a) If G is planar then{a mathematical formula}ΩG∘is satisfiable over{a mathematical formula}RCP+(R2). (b) Conversely, let{a mathematical formula}ΩˆG∘be the result of replacing any number (possibly zero) of the DC-constraints in{a mathematical formula}ΩG∘by the corresponding EC-constraints. If{a mathematical formula}ΩˆG∘is satisfiable over{a mathematical formula}RC+(R2)then G is planar, and any satisfying tuple has a rectified (= piecewise-linear) drawing of G strongly embedded in it.</paragraph><paragraph label="Proof">(a) If G is planar, consider any drawing f of G with points {a mathematical formula}xi=f(vi), for {a mathematical formula}1≤i≤n, and arcs {a mathematical formula}αj=f(ej), for {a mathematical formula}1≤j≤m. For all i, {a mathematical formula}1≤i≤n, let {a mathematical formula}di be a disc centred on {a mathematical formula}xi, with the {a mathematical formula}di pairwise disjoint. For all j, {a mathematical formula}1≤j≤m, let {a mathematical formula}αj′ be some segment of {a mathematical formula}αj which meets {a mathematical formula}du(j) and {a mathematical formula}dv(j) only at its endpoints. Applying Lemma 8 to the sets {a mathematical formula}d1,…,dn, {a mathematical formula}α1′,…,αm′, we obtain {a mathematical formula}r1,…,rn,s1,…,sm in {a mathematical formula}RCP+(R2) satisfying {a mathematical formula}ΩG∘.(b) Conversely, if {a mathematical formula}ΩG∘ is satisfiable over {a mathematical formula}RC+(R2), let {a mathematical formula}r1,…,rn,s1,…,sm be a satisfying assignment. From the PO-constraints, any {a mathematical formula}sj partially overlaps the two regions {a mathematical formula}ru(j) and {a mathematical formula}rv(j). For each j, {a mathematical formula}1≤j≤m, pick points {a mathematical formula}yj∈sj∘∩ru(j)∘ and {a mathematical formula}zj∈sj∘∩rv(j)∘, and a piecewise-linear Jordan arc {a mathematical formula}αj′⊆sj∘ joining {a mathematical formula}yj to {a mathematical formula}zj. Now, for each i, {a mathematical formula}1≤i≤n, pick a point {a mathematical formula}xi∈ri∘ not lying on any of the {a mathematical formula}αj′, and for each j with {a mathematical formula}u(j)=i, draw a piecewise-linear arc {a mathematical formula}βi,j⊆ri∘ from {a mathematical formula}xi to {a mathematical formula}yj, and for each j with {a mathematical formula}v(j)=i, draw a piecewise-linear arc {a mathematical formula}γi,j⊆ri∘ from {a mathematical formula}zj to {a mathematical formula}xi. It is easy to see that this can be done in such a way that, for each i, the arcs {a mathematical formula}βi,j and {a mathematical formula}γi,j (with j varying), lying in {a mathematical formula}ri∘, intersect precisely at their common endpoint {a mathematical formula}xi, and that they intersect any arc {a mathematical formula}αj′ only when {a mathematical formula}j=j′, and then precisely at the other end-point, {a mathematical formula}yj or {a mathematical formula}zj. For each j, let {a mathematical formula}αj=βu(j),jαj′γv(j),j; thus, {a mathematical formula}αj joins {a mathematical formula}xu(j) to {a mathematical formula}xv(j). But either {a mathematical formula}DC(ri,ri′) or {a mathematical formula}EC(ri,ri′) imply {a mathematical formula}ri∘∩rj∘=∅, and similarly for the constraints {a mathematical formula}DC(ri,sj)/EC(ri,sj) and {a mathematical formula}DC(sj,sj′)/EC(sj,sj′). It follows that the various piecewise-linear arcs {a mathematical formula}αj intersect only at shared endpoints, and thus constitute a rectified drawing of G, which is strongly embedded in {a mathematical formula}r1,…,rn,s1,…,sm.  □</paragraph><paragraph>A weaker form of embeddings will also be required in the sequel. As before, let {a mathematical formula}D=(G,S) be a design; let the vertices {a mathematical formula}v1,…,vn and edges {a mathematical formula}e1,…,em of G be ordered in some fixed way; and let {a mathematical formula}r¯=r1,…,rn and {a mathematical formula}s¯=s1,…,sm be tuples of elements of {a mathematical formula}RC+(R2). We say that a drawing f of D is weakly embedded in the tuple {a mathematical formula}r¯s¯ if{a mathematical formula} (Thus, we have replaced {a mathematical formula}sj∘ in (6) by {a mathematical formula}sj.) Now define the {a mathematical formula}RCC8c-constraint network {a mathematical formula}ΘD(r¯,s¯), where {a mathematical formula}r¯=r1,…,rn and {a mathematical formula}s¯=s1,…,sm, by taking, for {a mathematical formula}1≤i≠i′≤n and {a mathematical formula}1≤j≠j′≤m,{a mathematical formula} (Thus, we have replaced the constraints {a mathematical formula}DC(sj,sj′) in (7) by {a mathematical formula}EC(sj,sj′) whenever {a mathematical formula}(ej,ej′)∈S, and we have replaced {a mathematical formula}c∘ by c.)</paragraph><paragraph label="Lemma 10">Let D be a design. If D has a drawing, then{a mathematical formula}ΘDis satisfiable over{a mathematical formula}RCP+(R2). Conversely, if{a mathematical formula}ΘDis satisfiable over{a mathematical formula}RCP+(R2)then D has a drawing; furthermore, any satisfying tuple has a rectified drawing of D weakly embedded in it.</paragraph><paragraph label="Proof">The first statement of the lemma is proved in an almost identical way to that of Lemma 9. If D has a drawing, then it has a rectified drawing. The regions {a mathematical formula}ri are defined as before; however, the regions {a mathematical formula}sj have the ‘string-of-sausages’ form shown in Fig. 8, allowing any crossing arcs {a mathematical formula}αi to lie in a region {a mathematical formula}si such that {a mathematical formula}EC(sj,si). For the converse, we use the fact that connectedness entails arc-connectedness in {a mathematical formula}RCP+(R2) to construct, for any tuple {a mathematical formula}r¯s¯ satisfying {a mathematical formula}ΘD, a rectified drawing f of D weakly embedded in {a mathematical formula}r¯s¯.  □</paragraph><paragraph>We remark that Lemma 10, in contrast to Lemma 9, makes reference to satisfiability over {a mathematical formula}RCP+(R2) only. However, we will show later (Theorem 25) that D has a drawing if {a mathematical formula}ΘD is satisfiable over {a mathematical formula}RC+(R2).</paragraph></section></section><section label="4">Complexity and separation results for {a mathematical formula}RCC8<paragraph>In this section, we summarize what is known about the satisfiability problem for {a mathematical formula}RCC8-constraint networks over various frames. Although most of the results are not new, we give them with proofs which will serve as a starting point for constructions later on in the article.</paragraph><paragraph>Nebel [17] considered the problem of determining whether, for a given {a mathematical formula}RCC8-constraint network Φ, there exists a topological space T such that Φ is satisfiable over {a mathematical formula}RC+(T). He showed this problem to be in NLogSpace by reducing it—via Bennett's [15] encoding of {a mathematical formula}RCC8 in intuitionistic propositional logic—to 2SAT, which is known to be in NLogSpace (a different proof was given in [21]). Renz [20] observed further that any {a mathematical formula}RCC8-constraint network satisfiable over {a mathematical formula}RC+(T), for some topological space T, can also be satisfied over {a mathematical formula}RCP+(Rn), for any {a mathematical formula}n≥1; moreover, for {a mathematical formula}n≥3, it can be satisfied over {a mathematical formula}RCP+(Rn) by a tuple of interior-connected regions. The next two theorems give a direct and concise proof of these results.</paragraph><paragraph label="Theorem 11">Let{a mathematical formula}Φ(r¯)be an{a mathematical formula}RCC8-constraint network. Then the following are equivalent:</paragraph><list><list-item label="(a)">there exists a type-certificate for Φ;</list-item><list-item label="(b)">Φ is satisfiable over{a mathematical formula}RC+(T)for some topological space T;</list-item><list-item label="(c)">Φ is satisfiable over{a mathematical formula}RCP+(Rn)for any{a mathematical formula}n≥3; moreover, the satisfying assignment may be chosen so that all the regions in{a mathematical formula}p¯are interior-connected and all the regions in{a mathematical formula}q¯are not connected, for any partitioning{a mathematical formula}p¯q¯of{a mathematical formula}r¯;</list-item><list-item label="(d)">Φ is satisfiable over{a mathematical formula}RCP+(R)and{a mathematical formula}RCP+(R2).</list-item></list><paragraph label="Proof">The implication {a mathematical formula}(d)⇒(c) is easy. Suppose Φ is satisfiable over {a mathematical formula}RCP+(R). Take any satisfying assignment under which every region in {a mathematical formula}r¯ is disconnected (this can always be achieved by taking a disjoint copy of a given satisfying assignment). Then we cylindrify this assignment in {a mathematical formula}R3 and use the third dimension to make the regions in {a mathematical formula}p¯ interior-connected (in the same way as in [20]) while keeping the regions in {a mathematical formula}q¯ disconnected.The implication {a mathematical formula}(c)⇒(b) is trivial. The implication {a mathematical formula}(b)⇒(a) follows from the observation in Section 2.2 that, for every satisfiable Φ, there is a type-certificate (of at most {a mathematical formula}3|Φ| types).Thus, it remains to prove {a mathematical formula}(a)⇒(d). Suppose there exists a type-certificate for {a mathematical formula}Φ(r¯). Without loss of generality, we may assume that Φ contains no {a mathematical formula}EQ(ri,rj)—if this is not the case, we replace all occurrences of {a mathematical formula}ri with {a mathematical formula}rj and remove {a mathematical formula}EQ(rj,rj). We write {a mathematical formula}rj&lt;Φri if there is a sequence{a mathematical formula} By (type), (reg-e), (tpp-u), (ntpp-u) and (diff-e), {a mathematical formula}&lt;Φ is a strict partial order on {a mathematical formula}r¯. We also write {a mathematical formula}rj≤Φri if either {a mathematical formula}rj=ri or {a mathematical formula}rj&lt;Φri, and write {a mathematical formula}rj≪Φri if {a mathematical formula}rj&lt;Φri and at least one of the relations in the sequence above is NTPP. In view of (type), (tpp-u) and (ntpp-u), we then have the following, for each type τ in the type-certificate for Φ:{a mathematical formula}{a mathematical formula}{a mathematical formula} As {a mathematical formula}&lt;Φ is a strict partial order, we can assume the variables {a mathematical formula}r¯=r1,…,rn to be ordered in such a way that{a mathematical formula}We begin by considering {a mathematical formula}RCP+(R). First we define regions {a mathematical formula}Z1,…,Zn to satisfy the existential conditions of the constraints in Φ and then, by taking account of the TPP and NTPP constraints, extend {a mathematical formula}Z1,…,Zn to regions {a mathematical formula}X1,…,Xn satisfying Φ. For {a mathematical formula}0≤i≤n and {a mathematical formula}1≤j≤n, let {a mathematical formula}Wij− and {a mathematical formula}Wij+ be the non-empty adjacent intervals {a mathematical formula}[ni+j−1/4,ni+j] and {a mathematical formula}[ni+j,ni+j+1/4], respectively, and let {a mathematical formula}Wij be the union of {a mathematical formula}Wij− and {a mathematical formula}Wij+. Each {a mathematical formula}Zj is defined to be the union of the following intervals (see Fig. 9):{a mathematical formula}{a mathematical formula}{a mathematical formula}{a mathematical formula} The centre of each {a mathematical formula}W0j is a point whose Φ-type is guaranteed by (reg-e) and (diff-e), while the centre of each {a mathematical formula}Wij with {a mathematical formula}i&gt;0 is a point whose Φ-type is guaranteed by the respective (ec-e) or (po-e). In addition, the construction we are about to present will ensure that the two boundary points, {a mathematical formula}ni+j−1/4 and {a mathematical formula}ni+j+1/4, of each {a mathematical formula}Wij provide a Φ-type required by (tpp-e). By construction, (dc-e), (po-e) and (type), the following conditions are respected by the {a mathematical formula}Zi:{a mathematical formula}{a mathematical formula} Note that all the intervals {a mathematical formula}Wij are of length 1/2. We fix some ε such that {a mathematical formula}0&lt;ε≤1/(6n). Given a union s of disjoint intervals {a mathematical formula}[ai,bi], we denote by {a mathematical formula}s+ε the union of the intervals {a mathematical formula}[ai−ε,bi+ε]. We shall define a sequence of regions {a mathematical formula}X1,…,Xn by repeated application of the {a mathematical formula}⋅+ε-operator to unions of the {a mathematical formula}Wij. The choice of ε guarantees that distinct intervals {a mathematical formula}Wij and {a mathematical formula}Wi′j′ remain disjoint even after n applications of {a mathematical formula}⋅+ε.We proceed step-by-step in the order {a mathematical formula}X1,…,Xn and set, for {a mathematical formula}1≤i≤n,{a mathematical formula} This definition is legitimate by (11). The constructed regions for the constraint network (1) are illustrated in Fig. 10.We now prove that {a mathematical formula}X1,…,Xn satisfy Φ. First, we show, by induction on i, that, for all {a mathematical formula}j,j′≤i,{a mathematical formula}{a mathematical formula} The basis of induction, {a mathematical formula}i=1, is trivial. For the inductive step, it is enough to consider only {a mathematical formula}j&lt;j′=i (because the case with {a mathematical formula}j,j′&lt;i trivially follows from the induction hypothesis).Suppose {a mathematical formula}Xj∩Xi≠∅. Two cases are possible. If {a mathematical formula}Xj∩Zi=∅ then, by (14) and the choice of ε, there is {a mathematical formula}j′&lt;i such that {a mathematical formula}Xj∩Xj′≠∅ and either {a mathematical formula}TPP(rj′,ri)∈Φ or {a mathematical formula}NTPP(rj′,ri)∈Φ, that is, {a mathematical formula}rj′≤Φri; the required type exists by the induction hypothesis and (8). Otherwise, we have {a mathematical formula}Xj∩Zi≠∅ and so, by (14), either {a mathematical formula}Zj∩Zi≠∅ or there is {a mathematical formula}j′&lt;j such that {a mathematical formula}TPP(rj′,rj)∈Φ and {a mathematical formula}Xj′∩Zi≠∅ or there is {a mathematical formula}j′&lt;j such that {a mathematical formula}NTPP(rj′,rj)∈Φ and {a mathematical formula}(Xj′)+ε∩Zi≠∅. Thus, by the choice of ε and (14), there is {a mathematical formula}j′≤j such that {a mathematical formula}Zj′∩Zi≠∅ and {a mathematical formula}rj′≤Φrj, and so the required type exists by (12) and (8).Suppose {a mathematical formula}Xj∘∩Xi∘≠∅. Two cases are possible. If {a mathematical formula}Xj∘∩Zi∘=∅ then, by (14) and the choice of ε, there is {a mathematical formula}j′&lt;i such that either {a mathematical formula}Xj∘∩Xj′∘≠∅ and {a mathematical formula}rj′≤Φri, or {a mathematical formula}Xj∩Xj′≠∅ and {a mathematical formula}rj′≪Φri. In the former case, by the induction hypothesis, any type-certificate for Φ has a type τ such that {a mathematical formula}rj∘,rj′∈τ or {a mathematical formula}rj,rj′∘∈τ, from which, by (8) and (9), we obtain {a mathematical formula}rj∘,ri∈τ or {a mathematical formula}rj,ri∘∈τ. In the latter case, by the induction hypothesis, any type-certificate for Φ has a type τ such that {a mathematical formula}rj,rj′∈τ, which gives {a mathematical formula}rj,ri∘∈τ by (10). If {a mathematical formula}Xj∘∩Zi∘≠∅ then, by (14) and the choice of ε, there is {a mathematical formula}j′≤j such that either {a mathematical formula}Zj′∘∩Zi∘≠∅ and {a mathematical formula}rj′≤Φrj or {a mathematical formula}Zj′∩Zi≠∅ and {a mathematical formula}rj′≪Φrj. The required type exists by (13) and (9) in the former case and by (12) and (10) in the latter case.Next, we show that {a mathematical formula}R(Xj,Xi), for all {a mathematical formula}R(rj,ri)∈Φ.</paragraph><list><list-item label="–">If {a mathematical formula}DC(rj,ri)∈Φ then {a mathematical formula}Xj∩Xi=∅, for otherwise the type-certificate for Φ would contain a type with both {a mathematical formula}rj and {a mathematical formula}ri, contrary to (dc-u).</list-item><list-item label="–">If {a mathematical formula}EC(rj,ri)∈Φ then, by construction, {a mathematical formula}Zj∩Zi≠∅, whence, by (14), {a mathematical formula}Xj∩Xi≠∅. We also have {a mathematical formula}Xj∘∩Xi∘≠∅, for otherwise the type-certificate for Φ would contain a type with either {a mathematical formula}rj∘, {a mathematical formula}ri or {a mathematical formula}rj, {a mathematical formula}ri∘, contrary to (ec-u).</list-item><list-item label="–">If {a mathematical formula}PO(rj,ri)∈Φ then, by construction, {a mathematical formula}Zj∘∩Zi∘≠∅, whence, by (14), {a mathematical formula}Xj∘∩Xi∘≠∅. By (diff-e) and (type), there is a type τ in the type-certificate for Φ with {a mathematical formula}rj∘,rj∈τ and {a mathematical formula}ri∉τ. If we assume {a mathematical formula}Xj⊆Xi then, by (14), {a mathematical formula}rj≤Φri and, by (8), {a mathematical formula}ri∈τ, which is impossible. Symmetrically, we cannot have {a mathematical formula}Xi⊆Xj.</list-item><list-item label="–">If {a mathematical formula}TPP(rj,ri)∈Φ then, by (14), {a mathematical formula}Xj⊆Xi. By (diff-e) and (type), there is a type τ in the type-certificate for Φ with {a mathematical formula}rj∘,rj∈τ and {a mathematical formula}ri∉τ. If we assume {a mathematical formula}Xj⊆Xi∘ then, by (14), {a mathematical formula}rj≪Φri, and, by (10), {a mathematical formula}ri∈τ, which is impossible. We cannot also have {a mathematical formula}Xi⊆Xj because {a mathematical formula}j&lt;i.</list-item><list-item label="–">If {a mathematical formula}NTPP(rj,ri)∈Φ then, by (14), we have {a mathematical formula}Xj⊆Xi∘.</list-item></list><paragraph>As a consequence of Theorem 11, we obtain the following:</paragraph><paragraph label="Theorem 12">All of the problems{a mathematical formula}Sat(RCC8,RC+(Rn))and{a mathematical formula}Sat(RCC8,RCP+(Rn)), where{a mathematical formula}n≥1, are identical andNLogSpace-complete.</paragraph><paragraph label="Proof">We can encode the satisfiability problem for {a mathematical formula}RCC8-constraint networks as satisfiability of binary clauses with the quantifier prefix of the form {a mathematical formula}∃⁎∀. Indeed, for each variable r in Φ, we take two unary predicates, {a mathematical formula}Pr(x) and {a mathematical formula}Pr∘(x), to represent membership of the respective terms, r and {a mathematical formula}r∘, in Φ-types. Recall that Φ has a type-certificate in case it has a type-certificate of at most {a mathematical formula}3|Φ| types. Then the existential and universal conditions for the type-certificate can easily be encoded as binary clauses: for example,{a mathematical formula}{a mathematical formula}{a mathematical formula} where the {a mathematical formula}xi are {a mathematical formula}3|Φ|-many existentially quantified variables and y is a single universally quantified variable. The upper complexity bound follows then from the fact that satisfiability of binary clauses of this form is NLogSpace-complete [34, Exercise 8.3.7].NLogSpace-hardness can be shown by reduction of the reachability problem for directed acyclic graphs (DAGs), which is known to be NLogSpace-complete. Let {a mathematical formula}G=(V,E) be a DAG with {a mathematical formula}V={v1,…,vk}. We take variables {a mathematical formula}v1,…,vk and consider the set {a mathematical formula}ΦG of constraints containing {a mathematical formula}NTPP(vi,vj) just in case {a mathematical formula}(vi,vj)∈E. It should be clear that {a mathematical formula}vk is reachable from {a mathematical formula}v0 if and only if {a mathematical formula}DC(v0,vk) is inconsistent with {a mathematical formula}ΦG.  □</paragraph><paragraph>Note that if instead of atomic {a mathematical formula}RCC8-constrains we consider unions of {a mathematical formula}RCC8-predicates, then the satisfiability problem becomes NP-complete; for this and related tractability results consult [22], [19], [20], [35].</paragraph><paragraph>Let Φ be a set of constraints in either {a mathematical formula}RCC8c or {a mathematical formula}RCC8c∘, and let Ψ be the result of removing from Φ all constraints of the form {a mathematical formula}c(r) or {a mathematical formula}c∘(r). Then, as a consequence of Theorem 11, we see that the following are equivalent: Ψ is satisfiable over {a mathematical formula}RC+(T) for some topological space T; Φ is satisfiable over {a mathematical formula}RC+(Rn), for {a mathematical formula}n≥3; Φ is satisfiable over {a mathematical formula}RCP+(Rn), for {a mathematical formula}n≥3. Thus, {a mathematical formula}RCC8 is not sensitive to the dimension of the Euclidean space or to tameness of regions; and in dimension 3 or above, {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘ are not interestingly different from {a mathematical formula}RCC8.</paragraph><paragraph>We end this section with some separation results for {a mathematical formula}RCC8 over various salient sub-frames of {a mathematical formula}RC+(R2). To make the presentation more compact, we help ourselves with a result to be proved below (Theorem 25), which establishes the insensitivity of {a mathematical formula}RCC8c to tameness in the plane. Recall that {a mathematical formula}D denotes the frame of all closed disc-homeomorphs in {a mathematical formula}R2. Define {a mathematical formula}C to be the frame of all connected elements of {a mathematical formula}RC+(R2), and {a mathematical formula}I the frame of all interior-connected elements of {a mathematical formula}RC+(R2). Thus, {a mathematical formula}D⊆I⊆C⊆RC+(R2). It was observed [16] that {a mathematical formula}Sat(RCC8,D)⫋Sat(RCC8,RC+(R2)). In fact, we have the following:</paragraph><paragraph label="Theorem 13">{a mathematical formula}Sat(RCC8,D)⫋Sat(RCC8,I)⫋Sat(RCC8,C)⫋Sat(RCC8,RC+(R2)).</paragraph><paragraph label="Proof">The inclusions are trivial. To show that they are proper, we employ the graph {a mathematical formula}K5, with vertices and edges numbered identically to the points and arcs in Fig. 11a.To show that {a mathematical formula}Sat(RCC8,C)⫋Sat(RCC8,RC+(R2)), let Φ be the result of removing all c-constraints from {a mathematical formula}Θ(K5,∅). Since {a mathematical formula}K5 is non-planar, Lemma 10 ensures that {a mathematical formula}Θ(K5,∅) is not satisfiable over {a mathematical formula}RCP+(R2), whence, by Theorem 25, {a mathematical formula}Θ(K5,∅) is not satisfiable over {a mathematical formula}RC+(R2), and thus Φ is unsatisfiable over {a mathematical formula}C. On the other hand, Φ is trivially satisfiable over {a mathematical formula}RC+(R2), as we see from Fig. 11b. Note that {a mathematical formula}s10 is not connected in this assignment.To show that {a mathematical formula}Sat(RCC8,I)⫋Sat(RCC8,C), let {a mathematical formula}ΩˆK5∘ be the result of replacing the constraint {a mathematical formula}DC(s7,s10) in {a mathematical formula}ΩK5∘ by {a mathematical formula}EC(s7,s10), and let Ψ be the result of removing all {a mathematical formula}c∘-constraints from {a mathematical formula}ΩˆK5∘. By Lemma 9 (b), {a mathematical formula}ΩˆK5∘ is unsatisfiable over {a mathematical formula}RC+(R2), whence Ψ is not satisfiable over {a mathematical formula}I. On the other hand, Ψ is easily satisfiable over {a mathematical formula}C by taking {a mathematical formula}s7 and {a mathematical formula}s10 in Fig. 11b to be crossing strings-of-sausages as in Fig. 8.To show that {a mathematical formula}Sat(RCC8,D)⫋Sat(RCC8,I), we consider the graph {a mathematical formula}K5 with vertices and edges numbered identically to the points and arcs in Fig. 11a and let {a mathematical formula}K5− be the graph {a mathematical formula}K5 without the edge {a mathematical formula}α10. Since {a mathematical formula}K5− is 3-connected, by Whitney's theorem (see [30, p. 79]), Fig. 12a presents its only drawing in {a mathematical formula}S2 up to a homeomorphism of {a mathematical formula}S2 onto itself. In particular, in all drawings (in {a mathematical formula}R2), the points {a mathematical formula}x3 and {a mathematical formula}x5 are separated by the arcs {a mathematical formula}α1, {a mathematical formula}α7 and {a mathematical formula}α8. Let Ξ be the result of removing all {a mathematical formula}c∘-constraints from {a mathematical formula}ΩK5−∘. As we see from Fig. 12b, {a mathematical formula}ΩK5−∘ is satisfiable over {a mathematical formula}RC+(R2)—and hence Ξ is satisfiable over {a mathematical formula}I. However, by Lemma 9 (b), in any such satisfying assignment, the regular closed set {a mathematical formula}r1∪s1∪r2∪s7∪r4∪s8 separates {a mathematical formula}r3 from {a mathematical formula}r5. Now let t be a new variable, and {a mathematical formula}Ξ′ the result of adding to Ξ the constraints{a mathematical formula} Setting {a mathematical formula}t=r1∪s1∪r2∪s7∪r4∪s8 yields a satisfying assignment over {a mathematical formula}I. On the other hand, we have shown that t separates {a mathematical formula}r3 and {a mathematical formula}r5, and so must have a non-connected complement. Therefore, {a mathematical formula}Ξ′ is not satisfiable over {a mathematical formula}D.  □</paragraph></section><section label="5"><section-title>Separation results with connectedness constraints</section-title><paragraph>We now turn to the main subject of the present article: the languages {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘ in one- and two-dimensional space. Our first task is to show that these languages are indeed sensitive to dimension up to 3. Again, to obtain a compact presentation, we anticipate the result of Theorem 25 stating that {a mathematical formula}RCC8c is insensitive to tameness in the Euclidean plane.</paragraph><paragraph label="Proof">Let{a mathematical formula}Lbe either of the languages{a mathematical formula}RCC8cor{a mathematical formula}RCC8c∘. Then{a mathematical formula}{a mathematical formula}The inclusions hold because any tuple in {a mathematical formula}RC+(Rn) can easily be cylindrified to form a tuple in {a mathematical formula}RC+(Rm), for {a mathematical formula}m&gt;n, satisfying the same {a mathematical formula}L-networks. To show that the leftmost inclusions are proper, consider the network (5), saying that three connected regions {a mathematical formula}r1, {a mathematical formula}r2 and {a mathematical formula}r3 are in external contact with each other. This network cannot be satisfied over {a mathematical formula}RC+(R) because the {a mathematical formula}ri must be non-empty, closed, non-punctual intervals. However, we can easily satisfy (5) over any {a mathematical formula}RCP+(Rn) for {a mathematical formula}n≥2 (see Fig. 4a). The same argument holds for the {a mathematical formula}RCC8c∘-network obtained from (5) by replacing c with {a mathematical formula}c∘.To show that the rightmost inclusions are proper for {a mathematical formula}RCC8c∘, consider the constraint network {a mathematical formula}ΩK5∘ for the non-planar graph {a mathematical formula}K5. By Lemma 9 (b), it is not satisfiable over {a mathematical formula}RC+(R2), and thus over {a mathematical formula}RCP+(R2); on the other hand, it is clearly satisfiable over {a mathematical formula}RCP+(R3), and so over {a mathematical formula}RC+(R3). To show that the inclusions are proper for {a mathematical formula}RCC8c, consider the constraint network {a mathematical formula}Θ(K5,∅) for the same graph {a mathematical formula}K5. By Lemma 10, it is not satisfiable over {a mathematical formula}RCP+(R2), whence, by Theorem 25, it is not satisfiable over {a mathematical formula}RC+(R2). On the other hand, again, it is clearly satisfiable over both {a mathematical formula}RCP+(R3) and {a mathematical formula}RC+(R3).  □</paragraph><paragraph>What of sensitivity of {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘ to tameness in low dimensions? Here a more complicated picture emerges. In one-dimensional space (where connectedness and interior-connectedness coincide) we indeed observe sensitivity to tameness:</paragraph><paragraph label="Theorem 15">{a mathematical formula}Sat(RCC8c,RCP+(R))⫋Sat(RCC8c,RC+(R)). Indeed, there exists an{a mathematical formula}RCC8c-formula that is satisfiable over{a mathematical formula}RC+(R), but only by tuples some of whose elements have infinitely many components.</paragraph><paragraph label="Proof">The inclusion is trivial. Consider the {a mathematical formula}RCC8c-network{a mathematical formula}Figure 13, where 0 is the accumulation point for {a mathematical formula}r3 and {a mathematical formula}r4, shows how this network can be satisfied over {a mathematical formula}RC+(R). To see that it cannot be satisfied over {a mathematical formula}RCP+(R), let {a mathematical formula}r1=[c,d] and {a mathematical formula}r2=[a,b]. Since {a mathematical formula}EC(r1,r2), and by applying a reflection if necessary, {a mathematical formula}b=c. Since {a mathematical formula}DC(r2,r3) and {a mathematical formula}EC(r1,r3), {a mathematical formula}r3 includes some interval {a mathematical formula}[d,e] (with {a mathematical formula}e&gt;d). Since {a mathematical formula}EC(r3,r4) and {a mathematical formula}DC(r2,r4), it follows that {a mathematical formula}r4 has no points in {a mathematical formula}(a,b)∪(d,e), contrary to {a mathematical formula}EC(r1,r4).  □</paragraph><paragraph>In two dimensions, we find that {a mathematical formula}RCC8c∘ is sensitive to tameness.</paragraph><paragraph label="Theorem 16">{a mathematical formula}Sat(RCC8c∘,RCP+(R2))⫋Sat(RCC8c∘,RC+(R2)).</paragraph><paragraph label="Proof">Again, the inclusion is trivial. To show it is proper, we exhibit an {a mathematical formula}RCC8c∘-network Φ satisfiable over {a mathematical formula}RC+(R2), but not over {a mathematical formula}RCP+(R2). Let {a mathematical formula}G=(V,E) be the cyclic graph {a mathematical formula}C8 (see Fig. 14a), i.e.,{a mathematical formula} Let {a mathematical formula}r¯=r1,…,r8 and {a mathematical formula}s¯=s1,…,s8 be tuples of variables and consider the network {a mathematical formula}ΩG∘(r¯,s¯). Let {a mathematical formula}t¯=t1,t2 be a pair of fresh variables. We form the network {a mathematical formula}Φ(r¯,s¯,t¯) by adding to {a mathematical formula}ΩG∘ the constraints{a mathematical formula}{a mathematical formula} We first show that Φ is not satisfiable over {a mathematical formula}RCP+(R2). For suppose to the contrary that there exist regular closed polygons {a mathematical formula}r¯, {a mathematical formula}s¯, {a mathematical formula}t¯ making Φ true. By Lemma 9 (b), there exists a drawing of the cyclic graph {a mathematical formula}C8, with points {a mathematical formula}x1,…,x8 and arcs {a mathematical formula}α1,…,α8, such that {a mathematical formula}xi⊆ri∘ and {a mathematical formula}αi⊆ri∘∪si∘∪ri+1∘, for {a mathematical formula}1≤i≤7, and {a mathematical formula}α8⊆r8∘∪s8∘∪r1∘. Let γ denote the Jordan curve {a mathematical formula}α1…α8. Note that the four points {a mathematical formula}x2, {a mathematical formula}x4, {a mathematical formula}x6 and {a mathematical formula}x8 divide γ into the four segments {a mathematical formula}α2α3, {a mathematical formula}α4α5, {a mathematical formula}α6α7 and {a mathematical formula}α8α1, as shown in Fig. 14b.Setting {a mathematical formula}k=1 in (16), we have {a mathematical formula}EC(t1,r1) and {a mathematical formula}EC(t1,r5), so let {a mathematical formula}y2∈t1∩r1 and {a mathematical formula}y3∈t1∩r5. From {a mathematical formula}ΩG∘, {a mathematical formula}r1 is interior-connected; and using the curve selection property, we can construct a Jordan arc {a mathematical formula}β10⊆r1 from {a mathematical formula}x1 to {a mathematical formula}y2. Similarly, we can construct a Jordan arc {a mathematical formula}β30⊆r5 from {a mathematical formula}y3 to {a mathematical formula}x5. By (16), {a mathematical formula}t1 is also interior-connected, whence the curve selection property again ensures the existence of a Jordan arc {a mathematical formula}β2⊆{y2}∪t1∘∪{y3} from {a mathematical formula}y2 to {a mathematical formula}y3. Let {a mathematical formula}y1 be the last point of {a mathematical formula}β10 lying on γ, and let {a mathematical formula}β1=β10[y1,y2] (that is, {a mathematical formula}β1 is the segment of {a mathematical formula}β10 between {a mathematical formula}y1 and {a mathematical formula}y2). Let {a mathematical formula}y4 be the first point of {a mathematical formula}β30 lying on γ, and let {a mathematical formula}β3=β30[y3,y4]. From the DC-constraints in {a mathematical formula}ΩG∘, {a mathematical formula}y1 must be an internal point of {a mathematical formula}α8α1, and {a mathematical formula}y4 an internal point of {a mathematical formula}α4α5. Furthermore, {a mathematical formula}β=β1β2β3⊆r1∪t1∘∪r5 is a chord of γ. By setting {a mathematical formula}k=2 in (16), we can find another chord {a mathematical formula}β′⊆r3∪t2∘∪r7 joining an internal point of {a mathematical formula}α2α3 to an internal point of {a mathematical formula}α6α7. Since {a mathematical formula}γ⊆⋃i=18(ri∘∪si∘), (16) guarantees that {a mathematical formula}t1 and {a mathematical formula}t2 are disjoint from γ. In addition, (17) ensures that {a mathematical formula}t1 and {a mathematical formula}t2—and hence also the chords β and {a mathematical formula}β′—lie on the same side of γ. By inspection of Fig. 14, β and {a mathematical formula}β′—and hence {a mathematical formula}r1∪t1∘∪r5 and {a mathematical formula}r3∪t2∘∪r7—intersect. On the other hand, {a mathematical formula}ΩG∘ ensures that the {a mathematical formula}ri are pairwise disjoint; moreover (16) prevents {a mathematical formula}t1∘ or {a mathematical formula}t2∘ from intersecting any of the {a mathematical formula}rj. Therefore, {a mathematical formula}t1∘ intersects {a mathematical formula}t2∘, contradicting (17). This completes the proof that Φ is not satisfiable over {a mathematical formula}RCP+(R2).We next show that Φ is satisfiable over {a mathematical formula}RC+(R2). Let {a mathematical formula}r1,…,r8 and {a mathematical formula}s1,…,s8 be arranged as a (hexadecagonal) annulus as in Fig. 15. Denote the inner disc of the annulus by {a mathematical formula}d∈RC+(R2). Now let {a mathematical formula}t1 be an infinitely long spiral strip lying in d, and converging to the frontier of the annulus as shown; and let {a mathematical formula}t2=d⋅(−t1). It is obvious that {a mathematical formula}ΩG∘ and (16), (17) hold.  □</paragraph><paragraph>We remark that it was falsely claimed [36] that {a mathematical formula}Sat(RCC8c∘,RCP+(R2))=Sat(RCC8c∘,RC+(R2)).{sup:3} Observe that the set {a mathematical formula}t1∈RC+(R2) illustrated in Fig. 15 lacks the curve selection property: we can find points {a mathematical formula}y2∈t1∩r1 and {a mathematical formula}y3∈t1∩r5; but there is no arc {a mathematical formula}β2⊆{y2}∪t1∘∪{y3} connecting them. Observe also that the proof that Φ is unsatisfiable over {a mathematical formula}RCP+(R2) collapses if we replace the interior-connectedness predicate {a mathematical formula}c∘ with the connectedness predicate c: if β and {a mathematical formula}β′ are arcs lying in {a mathematical formula}t1 and {a mathematical formula}t2, respectively, but not necessarily in {a mathematical formula}t1∘ and {a mathematical formula}t2∘, then the condition {a mathematical formula}EC(t1,t2) cannot be used to force their disjointness. Indeed, as we shall see below (Theorem 25), {a mathematical formula}RCC8c is insensitive to tameness in two dimensions.</paragraph></section><section label="6">NP-completeness over {a mathematical formula}RCP+(R) and {a mathematical formula}RC+(R)<paragraph>In the one-dimensional space {a mathematical formula}R, the notions of connectedness and interior-connectedness coincide: a non-empty regular closed subset of {a mathematical formula}R is (interior-) connected if and only if it has one of the forms {a mathematical formula}[a,b], {a mathematical formula}(−∞,b], {a mathematical formula}[a,+∞) or {a mathematical formula}(−∞,+∞), for some {a mathematical formula}a&lt;b in {a mathematical formula}R. Hence, we only consider the language {a mathematical formula}RCC8c. Note also that polyhedra in {a mathematical formula}R are finite unions of regular closed, connected subsets—i.e., finite unions of non-punctual, closed intervals. Arbitrary regular closed subsets of {a mathematical formula}R may be infinite unions of such intervals together with their accumulation points (see Fig. 13, Fig. 19).</paragraph><paragraph>We show first that the satisfiability problem for {a mathematical formula}RCC8c-networks is harder over {a mathematical formula}R than over {a mathematical formula}R3 (cf. Corollary 12) unless {a mathematical formula}NLogSpace=NP:</paragraph><paragraph label="Theorem 17">Both{a mathematical formula}Sat(RCC8c,RCP+(R))and{a mathematical formula}Sat(RCC8c,RC+(R))areNP-hard.{sup:4}</paragraph><paragraph label="Proof">The proof is by reduction of the 3-colourability problem, which is known to be NP-complete: given a graph, decide whether its vertices can be painted in 3 different colours in such a way that no two vertices connected by an edge of the graph are of the same colour. So suppose we are given a graph {a mathematical formula}G=(V,E). We are going to construct an {a mathematical formula}RCC8c-network {a mathematical formula}ΦG such that {a mathematical formula}ΦG is satisfiable over {a mathematical formula}RCP+(R) or {a mathematical formula}RC+(R) if and only if G is 3-colourable. (The idea of the construction is similar to the one used to prove NP-hardness of Allen's interval calculus [38].) We represent the colours by the connected regions {a mathematical formula}p1,p2,p3: the constraints{a mathematical formula}{a mathematical formula} say that p is a closed interval divided into three subintervals, {a mathematical formula}p1, {a mathematical formula}p2 and {a mathematical formula}p3, with {a mathematical formula}p2 being in the middle. The constraints{a mathematical formula} say that the meeting point of {a mathematical formula}p1 and {a mathematical formula}p2 is in the interior of some interval {a mathematical formula}q1, the meeting point of {a mathematical formula}p2 and {a mathematical formula}p3 is in the interior of some interval {a mathematical formula}q2, and that the {a mathematical formula}qi are disjoint and lie inside p, as shown in Fig. 16.The constraints{a mathematical formula} ensure then that each interval v, for {a mathematical formula}v∈V, lies entirely inside one of the {a mathematical formula}pi (here we deliberately overload notation and use v to denote both vertices of G and the region variables representing those vertices). Thus, it remains to ensure that the intervals corresponding to adjacent vertices in G are of different colours. This can be done using the following constraints, for all {a mathematical formula}(u,v)∈E:{a mathematical formula}{a mathematical formula} By (23), one of the end-points of the interval {a mathematical formula}suv belongs to {a mathematical formula}p2, while the other either to {a mathematical formula}p1 or {a mathematical formula}p3. It follows that the end-points of {a mathematical formula}tuv are of different colours, and so u and v must be of different colours, too. Thus, if the union {a mathematical formula}ΦG of (18), (19), (20), (21), (22), (23) is satisfiable, then G is 3-colourable.To prove the converse, suppose that G is 3-colourable with the colours {a mathematical formula}p1, {a mathematical formula}p2 and {a mathematical formula}p3. First we satisfy (18), (19), (20) as shown in Fig. 16. Now, take any edge {a mathematical formula}(u,v)∈E. If u is of colour {a mathematical formula}p1 and v of colour {a mathematical formula}p2, then we define {a mathematical formula}suv and {a mathematical formula}tuv such that their left ends are in {a mathematical formula}p1, right ends are in {a mathematical formula}p2, {a mathematical formula}NTPP(q1,suv) and {a mathematical formula}NTPP(suv,tuv), and take u to be some interval inside {a mathematical formula}p1 for which {a mathematical formula}EC(u,tuv) holds, and v to be some interval inside {a mathematical formula}p2 for which {a mathematical formula}EC(v,tuv) holds. If v is of colour {a mathematical formula}p3, then we define {a mathematical formula}suv as before, but extend {a mathematical formula}tuv to some point inside {a mathematical formula}p3 after {a mathematical formula}q2, and take v to be in {a mathematical formula}p3 as well. The remaining cases are mirror-images, and left to the reader. It should be clear that we can define such an assignment simultaneously for all edges in G.  □</paragraph><paragraph>Now, we establish a matching upper bound. Let us assume first that an {a mathematical formula}RCC8c-network {a mathematical formula}Φ(r¯) is satisfied over {a mathematical formula}RCP+(R) by some assignment {a mathematical formula}a. For any open interval I of the form {a mathematical formula}(a,b), {a mathematical formula}(−∞,b) or {a mathematical formula}(a,∞), we take the set{a mathematical formula} and call it the Φ-character of I under{a mathematical formula}a. We say that {a mathematical formula}a is uniform over I if each of its points belongs to each of the regions of {a mathematical formula}χa(I); in other words, if {a mathematical formula}χa(I)=χa(I′), for each open subinterval {a mathematical formula}I′⊆I. Since every element of {a mathematical formula}RCP+(R) is a finite union of closed intervals, we can find finitely many points {a mathematical formula}z1&lt;⋯&lt;zk in {a mathematical formula}R such that {a mathematical formula}a is uniform over each of the open intervals {a mathematical formula}(zi,zi+1), for {a mathematical formula}0≤i≤k, where {a mathematical formula}z0=−∞ and {a mathematical formula}zk+1=+∞. For all i ({a mathematical formula}0≤i≤k), let {a mathematical formula}χi be the Φ-character of {a mathematical formula}(zi,zi+1) under {a mathematical formula}a. Notice that {a mathematical formula}zi∈a(r) if and only if {a mathematical formula}r∈χi−1∪χi. As the exact values of {a mathematical formula}z1,…,zk are irrelevant as far as satisfiability is concerned, we can think of {a mathematical formula}a as given by the tuple {a mathematical formula}(χ0,…,χk). We illustrate this representation by an example.</paragraph><paragraph label="Example 18">Consider the following {a mathematical formula}RCC8c-network Φ:{a mathematical formula}{a mathematical formula} This network is satisfied over {a mathematical formula}RCP+(R) by the assignment {a mathematical formula}(χ0,…,χ6), where each {a mathematical formula}χi is the Φ-character of {a mathematical formula}(zi,zi+1), {a mathematical formula}i=0,…,6, in Fig. 17 (for instance, {a mathematical formula}χ0={p,p1,p2}).</paragraph><paragraph>Our plan is to show that, given an assignment {a mathematical formula}a satisfying Φ, we can transform it into an assignment that has a small (polynomial in {a mathematical formula}|Φ|) number of Φ-characters.</paragraph><paragraph label="Lemma 19">Let{a mathematical formula}Φ(r1,…,rn)be an{a mathematical formula}RCC8c-network satisfied by an assignment{a mathematical formula}aover{a mathematical formula}RCP+(R)and let{a mathematical formula}x1,…,xmbe a point-certificate for Φ under{a mathematical formula}a. Let{a mathematical formula}[z1,z2]be a closed non-punctual interval containing no{a mathematical formula}xiand such that{a mathematical formula}ais uniform over{a mathematical formula}(z1−ε,z1)and{a mathematical formula}(z2,z2+ε), for some{a mathematical formula}ε&gt;0. Then Φ is satisfied by an assignment{a mathematical formula}a′that differs from{a mathematical formula}aonly on{a mathematical formula}[z1,z2]in such a way that{a mathematical formula}[z1,z2]is partitioned into{a mathematical formula}2n−1intervals with{a mathematical formula}a′uniform over the interior of each of them.</paragraph><paragraph label="Proof">Without loss of generality, we may assume that Φ contains no {a mathematical formula}EQ(ri,rj)—if this is not the case, we replace all occurrences of {a mathematical formula}ri with {a mathematical formula}rj and remove {a mathematical formula}EQ(rj,rj). Denote the Φ-character of {a mathematical formula}(z1−ε,z1) by {a mathematical formula}χ− and the Φ-character of {a mathematical formula}(z2,z2+ε) by {a mathematical formula}χ+. Starting with {a mathematical formula}χ− and {a mathematical formula}χ+, we construct a tuple of Φ-characters that gives the required assignment between {a mathematical formula}z1 and {a mathematical formula}z2.It may be impossible (due to connectedness constraints in Φ) to take the empty set for the character of {a mathematical formula}(z1,z2): cf. r in Example 18. On the other hand, due to DC-constraints in Φ, it may also be impossible to split {a mathematical formula}[z1,z2] in half to obtain a pair of adjacent open intervals with the characters {a mathematical formula}χ− and {a mathematical formula}χ+, respectively: in Example 18 (see Fig. 18), {a mathematical formula}χ− contains {a mathematical formula}p1 and {a mathematical formula}χ+ contains {a mathematical formula}q1, which cannot share boundary points because they are included in disjoint {a mathematical formula}p2 and {a mathematical formula}q2, respectively. The following notation will be useful. If χ is a set of variables of Φ, denote by {a mathematical formula}χ↑ the smallest extension of χ that contains each s with {a mathematical formula}r∈χ↑ and either {a mathematical formula}TPP(r,s)∈Φ or {a mathematical formula}NTPP(r,s)∈Φ. Our strategy, then, will be to ensure that {a mathematical formula}(z1,z2) has character{a mathematical formula} (although the assignment {a mathematical formula}a′ we are constructing will not necessarily be uniform over this interval). By definition, {a mathematical formula}χ0⊆χ−∩χ+. Moreover, {a mathematical formula}χ0 respects all the universal conditions of the constraints in Φ. (In Fig. 18, we have {a mathematical formula}χ0={r}.) However, {a mathematical formula}χ0 cannot be simply assigned to {a mathematical formula}(z1,z2) and thus made adjacent to {a mathematical formula}χ− and {a mathematical formula}χ+ because of the NTPP constraints in Φ, as illustrated by Example 18, where {a mathematical formula}χ−={r,p1,p2} and {a mathematical formula}χ0={r}: since {a mathematical formula}NTPP(p1,p2)∈Φ, the regions {a mathematical formula}p1 and {a mathematical formula}p2 cannot share boundary points, and so we have to insert an intermediate character {a mathematical formula}χ−1={r,p2} between {a mathematical formula}χ− and {a mathematical formula}χ0; see Fig. 18. In general, we define two sequences of characters{a mathematical formula} We begin with {a mathematical formula}χ−n=χ− and, if {a mathematical formula}χ−n,…,χ−(j+1) have already been defined, then we set{a mathematical formula} Intuitively, {a mathematical formula}χ−j eliminates from {a mathematical formula}χ−(j+1) the elements that are minimal with respect to NTPP: in Example 18, {a mathematical formula}χ−1 eliminates {a mathematical formula}p1 from {a mathematical formula}χ−2 and {a mathematical formula}χ−0 further eliminates {a mathematical formula}p2 from {a mathematical formula}χ−1. First, observe that {a mathematical formula}χ0⊆χ−j⊆χ−(j+1), for all j, {a mathematical formula}0≤j&lt;n. Moreover, we claim that {a mathematical formula}χ−0=χ0. Indeed, assume that {a mathematical formula}χ−0⊋χ0. Let {a mathematical formula}s0∈χ−0∖χ0. Then there is some {a mathematical formula}s1∈χ−1 such that {a mathematical formula}NTPP(s1,s0)∈Φ. We have {a mathematical formula}s1∉χ0 for otherwise {a mathematical formula}s0∈χ0, which is impossible. Thus, there is some {a mathematical formula}s2∈χ−2 such that {a mathematical formula}NTPP(s2,s1)∈Φ. As Φ is satisfied (by {a mathematical formula}a), we cannot repeat this argument more than n times, which proves our claim. The other sequence, {a mathematical formula}χ+n,…,χ−0, is defined symmetrically.We can redefine the assignment {a mathematical formula}a over {a mathematical formula}[z1,z2] by taking the tuple of characters (24). We claim that the resulting assignment {a mathematical formula}a′ satisfies Φ. Indeed, by construction, {a mathematical formula}a′(r) is connected, for all {a mathematical formula}c(r)∈Φ. The existential conditions of the constraints in Φ are satisfied by {a mathematical formula}a′ because their adjacent Φ-characters are the same as under {a mathematical formula}a. The new characters are subsets of {a mathematical formula}χ− and {a mathematical formula}χ+, and so respect all the DC constraints in Φ; the universal conditions of the EC constraints in Φ are respected because the characters (24) are subsets of {a mathematical formula}χ− and {a mathematical formula}χ+ and touch only them; the universal conditions of the TPP and NTPP constraints in Φ are satisfied by construction.  □</paragraph><paragraph>As an almost immediate consequence, we obtain:</paragraph><paragraph label="Theorem 20">{a mathematical formula}Sat(RCC8c,RCP+(R))isNP-complete.</paragraph><paragraph label="Proof">NP-hardness is by Theorem 17. The matching upper bound follows from a polynomial model property of the kind established by Lemma 19: if Φ is satisfied by {a mathematical formula}a then we can fix at most {a mathematical formula}3|Φ| points of a point-certificate for Φ under {a mathematical formula}a and, by Lemma 19, find a tuple of at most {a mathematical formula}3|Φ|×2|Φ|Φ-characters that induce a satisfying assignment for Φ. Clearly, we can guess such a tuple of {a mathematical formula}6|Φ|2Φ-characters and check in polynomial time that: (i) the set of Φ-types obtained by taking {a mathematical formula}{r∘|r∈χ1∩χ2}∪χ1∪χ2, for each pair of adjacent Φ-characters {a mathematical formula}χ1 and {a mathematical formula}χ2, is a type-certificate for Φ; and (ii) any region r with {a mathematical formula}c(r)∈Φ is connected in the sense that the set of Φ-characters containing r is contiguous in the tuple.  □</paragraph><paragraph>We now show how the construction above can be modified to the case of arbitrary regular closed regions in {a mathematical formula}R. Recall (cf. Fig. 13) that such regions can be infinite unions of closed non-punctual intervals with their accumulation points. The first step in the proof of Theorem 20 was to pick some point-certificate for {a mathematical formula}Φ(r¯). Over {a mathematical formula}RC+(R), however, a satisfying assignment may not be uniform in any of the intervals to the left or to the right of a point z in the point-certificate. Nevertheless, since the regions are regular closed sets, there is an interval {a mathematical formula}(z−ε,z) such that each of its subintervals of the form {a mathematical formula}(z−ε′,z), {a mathematical formula}0&lt;ε′&lt;ε, contains points not only from the same collection of {a mathematical formula}a(ri) as {a mathematical formula}(z−ε,z) but also points from the same collection of {a mathematical formula}−a(ri); recall that {a mathematical formula}−X=(R∖X)−. For example, in the context of Fig. 13, the point 0 belongs to any point-certificate because its type is required for {a mathematical formula}EC(r1,r3), {a mathematical formula}EC(r1,r4) and {a mathematical formula}EC(r3,r4). Every sufficiently small neighbourhood {a mathematical formula}(−ε,0) contains points in {a mathematical formula}a(r1) only (these points are also in the complements of {a mathematical formula}a(ri) for {a mathematical formula}i=2,3,4); but every sufficiently small neighbourhood {a mathematical formula}(0,ε) contains not only points in {a mathematical formula}a(r3) and points in {a mathematical formula}a(r4) but also points in the complements of {a mathematical formula}a(r3) and {a mathematical formula}a(r4).</paragraph><paragraph>We say that {a mathematical formula}a is left-uniform in{a mathematical formula}z2over{a mathematical formula}(z1,z2) if every subinterval {a mathematical formula}(z2−ε,z2)⊆(z1,z2) satisfies the following:{a mathematical formula} We say that {a mathematical formula}a is right-uniform in{a mathematical formula}z1over{a mathematical formula}(z1,z2) if the mirror image condition is satisfied. For example, the assignment in Fig. 13 is right-uniform in 0 over {a mathematical formula}(0,+∞) but it is not uniform over any {a mathematical formula}(0,ε). On the other hand, if {a mathematical formula}a is uniform over {a mathematical formula}(a,b) then it is both left-uniform in b over {a mathematical formula}(a,b) and right-uniform in a over {a mathematical formula}(a,b). Note that an interval with a left- or right-uniform assignment can contain points of exponentially many distinct Φ-types (this is in contrast to an interval with a uniform assignment, all points of which are of the same Φ-type). Nevertheless, an assignment left-uniform in {a mathematical formula}z2 over {a mathematical formula}(z1,z2) can be redefined on that interval so that it is uniform over each of the intervals forming an infinite sequence converging to {a mathematical formula}z2; moreover, the converging intervals can be made to have a small (linear in {a mathematical formula}|Φ|) number of Φ-characters (the case of right-uniform assignments is symmetrical). This will provide us with polynomial representations of assignments.</paragraph><paragraph label="Lemma 21">Let{a mathematical formula}Φ(r1,…,rn)be an{a mathematical formula}RCC8c-network satisfied by an assignment{a mathematical formula}aover{a mathematical formula}RC+(R). Fix a point-certificate for Φ under{a mathematical formula}a. Let z be one of them and{a mathematical formula}ε&gt;0be such that the distance between any two points in the certificate is at least 3ε. If{a mathematical formula}ais left-uniform in z over{a mathematical formula}(z−ε,z)(right-uniform in z over{a mathematical formula}(z,z+ε)) then Φ has a satisfying assignment{a mathematical formula}a′that differs from{a mathematical formula}aonly on{a mathematical formula}[z−ε,z)(respectively, on{a mathematical formula}(z,z+ε]) and such that this interval is a union of intervals converging to z and having at most 2n distinct Φ-characters under{a mathematical formula}a′, with{a mathematical formula}a′uniform over the interior of each of these intervals.</paragraph><paragraph label="Proof">Let Θ be the set of all r with {a mathematical formula}a(r)∩(z−ε,z)≠∅ and {a mathematical formula}(−a(r))∩(z−ε,z)≠∅. If {a mathematical formula}Θ=∅ then {a mathematical formula}a is uniform over {a mathematical formula}(z−ε,z) and we are done. Otherwise, for each {a mathematical formula}r∈Θ, z is a boundary point of {a mathematical formula}a(r), and so, since {a mathematical formula}a(r) is regular closed, there is a pair of open intervals {a mathematical formula}Ir,Ir′⊆(z−ε,z) such that {a mathematical formula}Ir⊆a(r) and {a mathematical formula}Ir′∩a(r)=∅ with {a mathematical formula}a uniform over both {a mathematical formula}Ir and {a mathematical formula}Ir′ (that is, each of the two intervals is either entirely in {a mathematical formula}a(ri) or does not intersect {a mathematical formula}a(ri), for any {a mathematical formula}ri, {a mathematical formula}1≤i≤n). Let {a mathematical formula}χ1,…,χ2k be a tuple of Φ-characters of the intervals {a mathematical formula}Ir and {a mathematical formula}Ir′, for {a mathematical formula}r∈Θ. Consider an infinite sequence of intervals in {a mathematical formula}(z−ε,z) converging to z and assign the characters {a mathematical formula}χ1,…,χ2k to the members of this sequence in a cyclical way (see Fig. 19). Define {a mathematical formula}a′ by taking the Φ-types of points induced by this sequence of Φ-characters over {a mathematical formula}[z−ε,z); {a mathematical formula}a′ coincides with {a mathematical formula}a elsewhere. To see that {a mathematical formula}a′ satisfies Φ, observe that {a mathematical formula}a′(r) is connected, for each connected {a mathematical formula}a(r). The Φ-type of z under {a mathematical formula}a′ coincides with the type of z under {a mathematical formula}a, and so the existential conditions of all constraints are satisfied because the types of the points in the point-certificate have not changed. The Φ-characters under {a mathematical formula}a′ are all taken from {a mathematical formula}a, and thus satisfy the universal conditions of the DC, TPP and NTPP constraints in Φ. Finally, the Φ-type of {a mathematical formula}z−ε is also consistent with Φ (for otherwise, {a mathematical formula}a{a mathematical formula} would not be left-uniform in z over {a mathematical formula}(z−ε,z)).  □</paragraph><paragraph label="Theorem 22">{a mathematical formula}Sat(RCC8c,RC+(R))isNP-complete.</paragraph><paragraph label="Proof">NP-hardness was shown by Theorem 17. The matching upper bound follows from the polynomial model property established by Lemma 19, Lemma 21. Indeed, suppose an {a mathematical formula}RCC8c-network {a mathematical formula}Φ(r1,…,rn) is satisfied by an assignment {a mathematical formula}a over {a mathematical formula}RC+(R). Let {a mathematical formula}z1&lt;⋯&lt;zm, for {a mathematical formula}m≤3|Φ|, be a point-certificate for Φ under {a mathematical formula}a. Take some ε such that {a mathematical formula}0&lt;ε&lt;min1≤i&lt;m⁡(zi+1−zi)/3, {a mathematical formula}a is left-uniform in {a mathematical formula}zi over each {a mathematical formula}(zi−ε,zi) and right-uniform in {a mathematical formula}zi over each {a mathematical formula}(zi,zi+ε). By Lemma 21, we can construct a satisfying assignment {a mathematical formula}a′ for Φ such that {a mathematical formula}a′ differs from {a mathematical formula}a only on {a mathematical formula}[zi−ε,zi) and {a mathematical formula}(zi,zi+ε], {a mathematical formula}1≤i≤m, and on each of these intervals {a mathematical formula}a′ is induced by a converging sequence of 2n Φ-characters. Next, by Lemma 19, each closed interval {a mathematical formula}[zi+ε,zi+1−ε], {a mathematical formula}1≤i&lt;m, is subdivided into a sequence of {a mathematical formula}2n−1 subintervals and {a mathematical formula}a′ is redefined so that the result is uniform over each of the subintervals; the two infinite intervals, {a mathematical formula}(−∞,z1−ε] and {a mathematical formula}[zm+ε,∞), are dealt with in a similar way. This gives us a polynomial representation of a satisfying assignment. More precisely, we obtain a sequence of {a mathematical formula}6mnΦ-characters that are arranged in the following structure{a mathematical formula} and such that the following Φ-types form a type-certificate for Φ:<list>{a mathematical formula}τ+ij and {a mathematical formula}τ−ij, for i, {a mathematical formula}0≤i≤n, and j, {a mathematical formula}1≤j≤m;{a mathematical formula}{r∘|r∈χ+ij∩χ+(i+1)j}∪χ+ij∪χ+(i+1)j and {a mathematical formula}{r∘|r∈χ−ij∩χ−(i+1)j}∪χ−ij∪χ−(i+1)j, for i, {a mathematical formula}0≤i&lt;n, and j, {a mathematical formula}1≤j≤m;{a mathematical formula}τi,Lj and {a mathematical formula}τi,Rj, for i, {a mathematical formula}1≤i≤2n, and j, {a mathematical formula}1≤j≤m;{a mathematical formula}{r∘|r∈⋂i=12n(χi,Lj∩χi,Rj)}∪⋃i=12n(χi,Lj∪χi,Rj), for j, {a mathematical formula}1≤j≤m,Our </list><paragraph>NP satisfiability checking algorithm guesses such a structure of {a mathematical formula}O(|Φ|)Φ-characters and then checks whether its induced Φ-types form a type-certificate for Φ and every region {a mathematical formula}ri with {a mathematical formula}c(ri)∈Φ is connected in the obvious sense.  □</paragraph></paragraph></section><section label="7">NP-completeness of {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘ in the Euclidean plane<paragraph>In this section, we show that the problems {a mathematical formula}Sat(RCC8c,RCP+(R2)) and {a mathematical formula}Sat(RCC8c,RC+(R2)) are identical and NP-complete. In addition, we show that the problem {a mathematical formula}Sat(RCC8c∘,RCP+(R2)) is NP-complete, and that the problem {a mathematical formula}Sat(RCC8c∘,RC+(R2)) is NP-hard. We showed in Section 5 that these problems are distinct. At the time of writing, the decidability of {a mathematical formula}Sat(RCC8c∘,RC+(R2)) is open.</paragraph><paragraph>We begin with the lower bounds, which are established by reduction of the NP-complete string graph problem (Proposition 6).</paragraph><paragraph label="Lemma 23">Let{a mathematical formula}Lbe either of{a mathematical formula}RCC8cor{a mathematical formula}RCC8c∘. Then the problems{a mathematical formula}Sat(L,RCP+(R2))and{a mathematical formula}Sat(L,RC+(R2))areNP-hard.</paragraph><paragraph label="Proof">(b) ⇒ (c) and (c) ⇒ (d): Trivial.(d) ⇒ (e): Suppose {a mathematical formula}v1,…,vn∈RC+(R2) satisfies {a mathematical formula}ΦG. By Lemma 8, we can find interior-connected regions {a mathematical formula}r1,…,rn in {a mathematical formula}RC+(R2) such that, for all i, j ({a mathematical formula}1≤i,j≤n): (i) {a mathematical formula}vi⊆ri∘; (ii) if {a mathematical formula}i≠j, then {a mathematical formula}ri⊈rj; and (iii) if {a mathematical formula}DC(vi,vj), then {a mathematical formula}DC(ri,rj). Thus, {a mathematical formula}r1,…,rn satisfies {a mathematical formula}ΦG∘. Notice that we do not require {a mathematical formula}r1,…,rn to be polygons.(e) ⇒ (a): Suppose {a mathematical formula}v1,…,vn∈RC+(R2) satisfies {a mathematical formula}ΦG∘. For any {a mathematical formula}e=(vi,vj)∈E, select {a mathematical formula}xe∈vi∘∩vj∘. For each i, {a mathematical formula}1≤i≤n, consider the collection of those {a mathematical formula}xe in {a mathematical formula}vi∘, and let {a mathematical formula}αi⊆vi∘ be a Jordan arc connecting all these points. Then {a mathematical formula}α1,…,αn is a string representation of G.  □</paragraph><paragraph>We next establish the matching upper complexity bounds by giving criteria for satisfiability of a given constraint network Φ in terms of a type-certificate for Φ and certain planarity conditions, which ensure that the type-certificate for Φ is realizable on the plane (and not just in some topological space as in Theorem 11). Let {a mathematical formula}Φ(r1,…,rn) be an {a mathematical formula}RCC8c-constraint network and let {a mathematical formula}τ¯=τ1,…,τm be a type-certificate for Φ. We proceed to construct a graph {a mathematical formula}GΦ,τ¯. For all k ({a mathematical formula}1≤k≤m), let {a mathematical formula}Vk={vi,k|1≤i≤n} and let {a mathematical formula}Gk=(Vk,Dk) be a fresh copy of the cyclic graph of order n. Take a fresh vertex {a mathematical formula}v⁎ and set {a mathematical formula}T={(v1,k,v⁎)|1≤k≤m}. For any i ({a mathematical formula}1≤i≤n), define the set of edges{a mathematical formula} Let {a mathematical formula}GΦ,τ¯=(V,E), where {a mathematical formula}V=⋃k=1mVk∪{v⁎} and {a mathematical formula}E=⋃k=1mDk∪T∪⋃i=1nCi. Finally, let {a mathematical formula}SΦ,τ¯ be the set of all pairs of distinct edges of E given by{a mathematical formula}</paragraph><paragraph label="Lemma 24">Let{a mathematical formula}Φ(r¯)be an{a mathematical formula}RCC8c-constraint network. Then the following are equivalent:</paragraph><list><list-item label="(a)">Φ is satisfiable over{a mathematical formula}RC+(R2);</list-item><list-item label="(b)">there exist a type-certificate{a mathematical formula}τ¯for Φ of{a mathematical formula}3|Φ|types and{a mathematical formula}S⊆SΦ,τ¯such that the design{a mathematical formula}(GΦ,τ¯,S)has a drawing;</list-item><list-item label="(c)">Φ is satisfiable over{a mathematical formula}RCP+(R2)by a tuple of bounded polygons, each of which has at most{a mathematical formula}3|Φ|components.</list-item></list><paragraph label="Proof">In demonstrating these equivalences, we rely in several places on Lemma 8. Accordingly, if {a mathematical formula}X1,…,Xn is some collection of sets under consideration, we denote their ‘thickenings,’ obtained by Lemma 8, by {a mathematical formula}X1+,…,Xn+. We silently assume that any set (mentioned in the context of the discussion) not intersecting {a mathematical formula}Xi also does not intersect {a mathematical formula}Xi+—and in particular, that any point (mentioned in the context of the discussion) not contained in {a mathematical formula}Xi is also not contained in {a mathematical formula}Xi+. Likewise, we silently assume that {a mathematical formula}Xi+ is interior-connected if {a mathematical formula}Xi is connected.{a mathematical formula}(a)⇒(b): Suppose {a mathematical formula}Φ(r1,…,rn) is satisfied by some {a mathematical formula}a:V→RC+(R2). By adding dummy arguments if necessary, we may assume {a mathematical formula}n≥3. Let {a mathematical formula}x1,…,xm be a point-certificate for Φ under {a mathematical formula}a and let {a mathematical formula}τ¯=τ1,…,τm, where {a mathematical formula}τk=τ(xk,a), for {a mathematical formula}1≤k≤m. Let {a mathematical formula}Xi=a(ri), for {a mathematical formula}1≤i≤n, and let {a mathematical formula}X1+,…,Xn+∈RC+(R2) be the thickenings of {a mathematical formula}X1,…,Xn guaranteed by Lemma 8. Let {a mathematical formula}d1,…,dm be closed discs, centred on the respective points {a mathematical formula}x1,…,xm, such that {a mathematical formula}xk∈(Xi+)∘ implies {a mathematical formula}dk⊆(Xi+)∘, and {a mathematical formula}xk∉Xi+ implies {a mathematical formula}dk∩Xi+=∅. It is then obvious that none of the sets {a mathematical formula}(Xi+)∘ is disconnected by (simultaneous) removal of all the {a mathematical formula}d1,…,dm.Fixing k ({a mathematical formula}1≤k≤m), take a set of points {a mathematical formula}{y1,k,…,yn,k} lying on {a mathematical formula}δdk. Thus, for all i ({a mathematical formula}1≤i≤n), the following are equivalent:{a mathematical formula} Since {a mathematical formula}n≥3, we can decompose each Jordan curve {a mathematical formula}δdk into a collection {a mathematical formula}Δk={γ1,k,…,γn,k} of Jordan arcs connecting the various points {a mathematical formula}yi,k in a cycle. In addition, let {a mathematical formula}y⁎ be a point lying outside all the {a mathematical formula}dk, and let {a mathematical formula}θk be a Jordan arc connecting {a mathematical formula}y1,k to {a mathematical formula}y⁎. Evidently, we may choose the {a mathematical formula}θk in such a way that, together with the arcs {a mathematical formula}γi,k, they form a plane graph; see Fig. 20. Set {a mathematical formula}Θ={θ1,…,θm}. Fixing i ({a mathematical formula}1≤i≤n), we define a further set of edges {a mathematical formula}Γi as follows. If {a mathematical formula}c(ri)∉Φ, then {a mathematical formula}Γi=∅. Otherwise, {a mathematical formula}(Xi+)∘ is connected. Hence, for any pair of distinct points {a mathematical formula}yi,k and {a mathematical formula}yi,k′∈(Xi+)∘, we may draw a Jordan arc {a mathematical formula}γ⊆(Xi+)∘, such that γ avoids all the disks {a mathematical formula}dh, except at the endpoints {a mathematical formula}yi,k and {a mathematical formula}yi,k′. (This is possible because {a mathematical formula}(Xi+)∘ is not disconnected by simultaneous removal of the {a mathematical formula}d1,…,dm.)Recalling the definition of {a mathematical formula}GΦ,τ¯=(V,E), we see that the function {a mathematical formula}f:vi,k↦yi,k and {a mathematical formula}f:v⁎↦y⁎ induces a natural map from the edges in each {a mathematical formula}Dk to the arcs in {a mathematical formula}Δk, and from the edges in T to the arcs in Θ. Furthermore, by (27), {a mathematical formula}ri∈τk if and only if {a mathematical formula}yi,k∈(Xi+)∘, and so f induces a natural map from the edges in each {a mathematical formula}Ci to the arcs in {a mathematical formula}Γi. That is: f is a realization of {a mathematical formula}GΦ,τ¯. Furthermore, suppose α and β are arcs in this realization which cross at some point—i.e., which have points in common other than a common endpoint. By the construction of these arcs, and exchanging α, β if necessary, we have {a mathematical formula}α∈Γi for some i, and either {a mathematical formula}β∈Θ, or {a mathematical formula}β∈Γj for some j such that {a mathematical formula}DC(ri,rj)∉Φ. (Indeed, {a mathematical formula}DC(ri,rj)∈Φ implies {a mathematical formula}Xi+ and {a mathematical formula}Xj+ are disjoint, whence no arc in {a mathematical formula}Γi can intersect an arc in {a mathematical formula}Γj.) Thus, the pair {a mathematical formula}(α,β) is in the set {a mathematical formula}SΦ,τ¯ of allowed edge crossings, and we have a drawing of {a mathematical formula}(GΦ,τ¯,S), for some {a mathematical formula}S⊆SΦ,τ¯, as required.(b) ⇒ (c): Let {a mathematical formula}τ¯=τ1,…,τm be a type-certificate for Φ and {a mathematical formula}S⊆SΦ,τ¯. If there is a drawing of {a mathematical formula}(GΦ,τ¯,S) in {a mathematical formula}R2, then there is one in the closed plane, {a mathematical formula}S2. Let f be such a drawing. Write {a mathematical formula}f(vi,k)=yi,k, {a mathematical formula}f(Ci)=Γi and {a mathematical formula}f(Dk)=Δk for all i and k ({a mathematical formula}1≤i≤n and {a mathematical formula}1≤k≤m); and write {a mathematical formula}f(v⁎)=y⁎ and {a mathematical formula}f(T)=Θ. Thus, each {a mathematical formula}Δk defines a Jordan curve in {a mathematical formula}S2, with the set of allowed edge-crossings {a mathematical formula}SΦ,τ¯ ensuring that none of these {a mathematical formula}Δk separates any other from the point {a mathematical formula}y⁎. Denote by {a mathematical formula}dk the closed disc-homeomorph enclosed by {a mathematical formula}Δk and not containing {a mathematical formula}y⁎. By taking the point at infinity so that it is close to {a mathematical formula}y⁎, we may regard f as a drawing of {a mathematical formula}(GΦ,τ¯,S) in {a mathematical formula}R2: the various {a mathematical formula}dk will still be closed disc-homeomorphs, and {a mathematical formula}y⁎ will lie outside all of them. Indeed, without loss of generality, we may assume that this drawing is rectified. (Hence, any two arcs which intersect at an internal point cross each other in the obvious sense.) We proceed to construct an assignment {a mathematical formula}a:V→RCP+(R2) of polygons satisfying Φ.Without loss of generality, we may assume that Φ contains no {a mathematical formula}EQ(ri,rj). By (type), (tpp-u), (ntpp-u), we can order the variables {a mathematical formula}r¯=r1,…,rn in such a way that{a mathematical formula} For each i ({a mathematical formula}1≤i≤n) and each k ({a mathematical formula}1≤k≤m), we select a region {a mathematical formula}Wi,k∈RCP(R2) as follows:<list>If {a mathematical formula}ri∘∈τk, let {a mathematical formula}Wi,k⊆dk be a lozenge such that {a mathematical formula}xk∈(Wi,k)∘ and {a mathematical formula}yi,k∈δWi,k; see Fig. 21a.If {a mathematical formula}ri∈τk but {a mathematical formula}ri∘∉τk, let {a mathematical formula}Wi,k⊆dk be a lozenge such that {a mathematical formula}xk,yi,k∈δWi,k; we may choose these {a mathematical formula}Wi,k in such a way that no two of them have intersecting interiors; see Fig. 21b.Otherwise, i.e., if {a mathematical formula}ri∉τk, let {a mathematical formula}Wi,k=∅.Fix any </list><paragraph>(c) ⇒ (a): Trivial.  □</paragraph></paragraph><paragraph>It is then immediate from Lemma 23, Lemma 24 that we have the following result.</paragraph><paragraph label="Theorem 25">The problems{a mathematical formula}Sat(RCC8c,RCP+(R2))and{a mathematical formula}Sat(RCC8c,RC+(R2))coincide and areNP-complete.</paragraph><paragraph>The case of {a mathematical formula}RCC8c∘ is similar to that of {a mathematical formula}RCC8c, and we briefly indicate the main differences. If Φ is an {a mathematical formula}RCC8c∘-network and {a mathematical formula}τ¯=τ1,…,τm a type-certificate for Φ, we first define, in place of the edge-sets {a mathematical formula}Ci given in (25), the edge-sets{a mathematical formula} (Intuitively, the condition {a mathematical formula}ri∈τk∩τk′ states that region {a mathematical formula}ri—but not necessarily {a mathematical formula}ri∘—contains both {a mathematical formula}xk and {a mathematical formula}xk′; hence if {a mathematical formula}ri is interior-connected, then there are points in {a mathematical formula}ri∘ close to {a mathematical formula}xk and {a mathematical formula}xk′, and connected by an arc lying in {a mathematical formula}ri∘.) This yields, in place of the graph {a mathematical formula}GΦ,τ¯, the graph {a mathematical formula}GΦ,τ¯∘=(V,E) where {a mathematical formula}V=⋃k=1mVk∪{v⁎} and {a mathematical formula}E=⋃k=1mDk∪T∪⋃i=1nCi∘. We next define, in place of the set of allowed edge-crossings {a mathematical formula}SΦ,τ¯ given in (26), the set of allowed edge-crossings{a mathematical formula} (Intuitively, since the arcs in {a mathematical formula}Ci∘ are all meant to lie in the interior of {a mathematical formula}ri, arcs in {a mathematical formula}Cj∘ can intersect those in {a mathematical formula}Ci∘ only if {a mathematical formula}ri and {a mathematical formula}rj have interior points in common.) The proof then proceeds as for Lemma 24, but with {a mathematical formula}GΦ,τ¯∘ and {a mathematical formula}SΦ,τ¯∘ replacing {a mathematical formula}GΦ,τ¯ and {a mathematical formula}SΦ,τ¯, respectively.</paragraph><paragraph label="Lemma 26">Let{a mathematical formula}Φ(r¯)be an{a mathematical formula}RCC8c∘-constraint network. Then the following are equivalent:</paragraph><list><list-item label="(a)">Φ is satisfiable over{a mathematical formula}RCP+(R2);</list-item><list-item label="(b)">there exist a type-certificate{a mathematical formula}τ¯for Φ of{a mathematical formula}3|Φ|types and{a mathematical formula}S⊆SΦ,τ¯∘such that the design{a mathematical formula}(GΦ,τ¯∘,S)has a drawing;</list-item><list-item label="(c)">Φ is satisfiable over{a mathematical formula}RCP+(R2)by a tuple of bounded regions, each of which has at most{a mathematical formula}3|Φ|components and at most{a mathematical formula}3|Φ|2i-components.</list-item></list><paragraph label="Proof">(c) ⇒ (a): Trivial.  □</paragraph><paragraph>It is then immediate from Lemma 23, Lemma 26 that we have the following result.</paragraph><paragraph label="Theorem 27">{a mathematical formula}Sat(RCC8c∘,RCP+(R2))isNP-complete.</paragraph><paragraph>It is illuminating to ask why the proof of Lemma 26 fails when {a mathematical formula}RCP+(R2) is replaced by {a mathematical formula}RC+(R2). The answer lies in the innocent-looking wedges {a mathematical formula}Wi,k, which may be required to connect points {a mathematical formula}yi,k∈Xi∘ to points {a mathematical formula}xk∈δXi. The problem is that, for {a mathematical formula}RC+(R2), we cannot guarantee that these wedges exist (cf. Fig. 15), and hence, we cannot use arcs included in {a mathematical formula}Xi∘ to ensure the satisfaction of the constraint {a mathematical formula}c∘(ri). When dealing with {a mathematical formula}RCC8c, we could afford to be more relaxed, drawing the wedges {a mathematical formula}Wi,k and arcs {a mathematical formula}Γi within the expanded region {a mathematical formula}Xi+, and using sausage-like regions {a mathematical formula}Yi to connect up the pieces. But sausage-like regions do not suffice for {a mathematical formula}RCC8c∘, since they do not secure interior-connectedness. We remark that a purported proof of Theorem 25 was presented in [21]; however, this proof contains an error.{sup:5} Another incorrect proof of the same theorem was given in [36].{sup:6}</paragraph></section><section label="8"><section-title>The fragmentation of satisfying configurations</section-title><paragraph>Let Φ be a constraint network in any of the languages {a mathematical formula}RCC8, {a mathematical formula}RCC8c or {a mathematical formula}RCC8c∘, and suppose Φ is satisfiable over {a mathematical formula}RC+(Rn) or {a mathematical formula}RCP+(Rn). What can we say about the amount of information required to store some satisfying assignment, as a function of the number of variables involved? In particular, what can we say about the extent to which Φ forces satisfying assignments to ‘chop up’ the space in which they are embedded? As we shall see, the answer is only loosely related to the complexity-theoretic bounds derived above.</paragraph><paragraph>We first consider the fragmentation of satisfying assignments for the language {a mathematical formula}RCC8 over {a mathematical formula}RC+(Rn) and {a mathematical formula}RCP+(Rn), for all {a mathematical formula}n≥1. Bearing in mind that any satisfiable {a mathematical formula}RCC8-constraint network Φ has a point-certificate of at most {a mathematical formula}3|Φ| points, Lemma 19 guarantees that if Φ is satisfiable over {a mathematical formula}RCP+(R), it can be satisfied by an assignment dividing {a mathematical formula}R into at most {a mathematical formula}6|Φ|2 intervals over each of which it is uniform.</paragraph><paragraph label="Corollary 28">If Φ is an{a mathematical formula}RCC8-network satisfiable over{a mathematical formula}RCP+(Rn)({a mathematical formula}n≥1), then Φ has a satisfying assignment of bounded polyhedral regions all of whose vertices have integer coordinates in the range{a mathematical formula}[0,O(|Φ|2)].</paragraph><paragraph>We next consider the fragmentation of satisfying assignments for the languages {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘ over {a mathematical formula}RC+(Rn) and {a mathematical formula}RCP+(Rn) for all {a mathematical formula}n≥3.</paragraph><paragraph label="Proof">If Φ is an{a mathematical formula}RCC8c- or{a mathematical formula}RCC8c∘-network satisfiable over{a mathematical formula}RC+(Rn)({a mathematical formula}n≥3), then Φ has a satisfying assignment of bounded polyhedral regions all of whose vertices have integer coordinates in the range{a mathematical formula}[0,O(|Φ|2)].Let {a mathematical formula}Φ− be the result of removing all c- or {a mathematical formula}c∘-constraints from Φ. We take a satisfying assignment in {a mathematical formula}RCP+(R) whose vertices have integer coordinates in the range {a mathematical formula}[0,O(|Φ|2)]. Now cylindrify to an assignment in {a mathematical formula}RCP+(R3), and connect up regions as necessary using points whose coordinates in the second and third dimensions are bounded by {a mathematical formula}O(|Φ|). For {a mathematical formula}n&gt;3, cylindrify again.  □</paragraph><paragraph>The fragmentation of satisfying assignments for {a mathematical formula}RCC8c over {a mathematical formula}RC+(R) and {a mathematical formula}RCP+(R) has likewise already been dealt with (recall that connectedness coincides with interior-connectedness over {a mathematical formula}R, and so {a mathematical formula}RCC8c∘ is the same as {a mathematical formula}RCC8c). Theorem 15 tells us that {a mathematical formula}RCC8c-networks satisfiable over {a mathematical formula}RC+(R) can force regions to have infinitely many components. By contrast, Lemma 19 shows that {a mathematical formula}RCC8c-networks satisfiable over {a mathematical formula}RCP+(R) have satisfying assignments with integer coordinates in the range {a mathematical formula}[0,O(|Φ|2)].</paragraph><paragraph>This leaves the more interesting case of the fragmentation of satisfying assignments for the languages {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘ over {a mathematical formula}RC+(R2) and {a mathematical formula}RCP+(R2). We consider first the language {a mathematical formula}RCC8c. Let Φ be an {a mathematical formula}RCC8c-network satisfiable over {a mathematical formula}RC+(R2). By Lemma 24, Φ is satisfiable over {a mathematical formula}RCP+(R2) (by bounded polygons). But how complicated does this arrangement of polygons have to be? In terms of numbers of components, not very. Recall the terminology introduced in Section 3.1: if {a mathematical formula}r∈RC+(R2) and X is a component of {a mathematical formula}r∘, then {a mathematical formula}X− is an i-component of r (Fig. 6). As we noted, both {a mathematical formula}RC+(R2) and {a mathematical formula}RCP+(R2) are closed under taking i-components, and every {a mathematical formula}r∈RCP+(R2) is the sum of its i-components. By Lemma 24, {a mathematical formula}(r)if Φ is an {a mathematical formula}RCC8c-constraint network satisfied by a tuple of regions in {a mathematical formula}RC+(R2), then it is satisfied by a tuple of bounded regions in {a mathematical formula}RCP+(R2) each of which has at most {a mathematical formula}3|Φ| components. Similarly, by Lemma 26, {a mathematical formula}(r∘)if Φ is an {a mathematical formula}RCC8c∘-constraint network satisfied by a tuple of regions in {a mathematical formula}RCP+(R2), then it is satisfied by a tuple of bounded regions in {a mathematical formula}RCP+(R2) each of which has at most {a mathematical formula}3|Φ| components and at most {a mathematical formula}3|Φ|2 i-components. As we might say, over {a mathematical formula}RC+(R2) and {a mathematical formula}RCP+(R2), {a mathematical formula}RCC8c can force no more than linearly many components; and over {a mathematical formula}RCP+(R2), {a mathematical formula}RCC8c∘ can force no more than quadratically many i-components.</paragraph><paragraph>We now proceed to show that (r) becomes false if ‘component’ is replaced by ‘i-component’: {a mathematical formula}RCC8c-constraint networks can in general force satisfying tuples to have exponentially many i-components (Theorem 30, Theorem 31). Likewise, ({a mathematical formula}r∘) becomes false if ‘{a mathematical formula}RCP+(R2)’ is replaced by ‘{a mathematical formula}RC+(R2)’—indeed radically so: there exist {a mathematical formula}RCC8c∘-constraint networks, satisfiable over {a mathematical formula}RC+(R2), but only by tuples of regions some of which have infinitely many components (Theorem 32).</paragraph><paragraph>The following result uses the construction originally devised by Kratochvíl and Matoušek [31] to establish Proposition 2.</paragraph><paragraph label="Theorem 30">There exists a sequence{a mathematical formula}Φnof{a mathematical formula}RCC8c-constraint networks, satisfiable over{a mathematical formula}RCP+(R2), such that{a mathematical formula}|Φn|is{a mathematical formula}O(n), but every satisfying assignment contains some element with{a mathematical formula}2Ω(n)i-components.</paragraph><paragraph label="Proof">Let {a mathematical formula}G3=(V3,E3) be the planar graph given by the solid lines in Fig. 23. We generalize this graph by inserting new vertices (of degree 2) as follows. If {a mathematical formula}Gi is defined for {a mathematical formula}i≥3, we take {a mathematical formula}Gi+1=(Vi+1,Ei+1) to be the result of inserting a new vertex {a mathematical formula}ui+1 into the edge {a mathematical formula}(ui,y), a new vertex {a mathematical formula}wi+1 into the edge {a mathematical formula}(wi,w), a new vertex {a mathematical formula}vi+1 into the edge {a mathematical formula}(ui,ui−1) and adding a new edge {a mathematical formula}(ui+1,wi+1). Having defined {a mathematical formula}Gn=(Vn,En) for some fixed {a mathematical formula}n≥3, let {a mathematical formula}En′ be a set of additional edges involving the vertices {a mathematical formula}Vn such that {a mathematical formula}Gn′=(Vn,En∪En′) is a 3-connected planar graph (such an {a mathematical formula}En′ can easily be constructed). In addition, let {a mathematical formula}En″ be the set of edges {a mathematical formula}{(u1,v1),…,(un,vn)}, realized by arcs arranged as shown (for {a mathematical formula}n=3) by the grey lines in Fig. 23. We call the edges in {a mathematical formula}En∪En″visible, and we call the edges in {a mathematical formula}En′invisible. (Note that the latter cannot be seen in Fig. 23.) Let {a mathematical formula}Gn⁎=(Vn,En∪En′∪En″). Thus, {a mathematical formula}Gn⁎ is a non-planar graph; however, it has a specific realization in which the visible edges {a mathematical formula}En∪En″ are arranged as in Fig. 23. Let {a mathematical formula}Sn⁎ be the set of pairs of distinct edges of {a mathematical formula}Gn⁎ which cross in this realization. Thus, {a mathematical formula}Dn⁎=(Gn⁎,Sn⁎) by definition has a drawing, and, by inspection of Fig. 23, permits visible edges e and {a mathematical formula}e′ to cross only if either: (i) {a mathematical formula}e=(ui,vi) for some i ({a mathematical formula}1≤i≤n) and {a mathematical formula}e′=(x,u0); or (ii) {a mathematical formula}e=(ui,vi) for some i ({a mathematical formula}2≤i≤n) and {a mathematical formula}e′ lies on the line-segment {a mathematical formula}ui−2,z¯.By the first statement of Lemma 10, {a mathematical formula}ΘDn⁎ is satisfiable over {a mathematical formula}RCP+(R2). Conversely, suppose {a mathematical formula}(r¯,s¯) is a satisfying assignment for {a mathematical formula}ΘDn⁎. By the second statement of Lemma 10, this tuple weakly embeds a rectified drawing of {a mathematical formula}ΘDn⁎, which contains a drawing of the 3-connected planar graph {a mathematical formula}Gn′. By Whitney's theorem, {a mathematical formula}Gn′ has only one drawing in {a mathematical formula}S2 (up to homeomorphism of {a mathematical formula}S2 onto itself). Hence—by applying a homeomorphism if necessary—we may assume that the induced drawing of the subgraph {a mathematical formula}Gn is exactly as depicted (for {a mathematical formula}n=3) by the solid lines in Fig. 23. Since the allowed crossings of visible edges are given by {a mathematical formula}Sn⁎, it is then obvious from inspection of Fig. 23 that, in the given drawing of {a mathematical formula}ΘDn⁎, the arc realizing the (visible) edge {a mathematical formula}(un,vn) must cross {a mathematical formula}(x,u0) at least {a mathematical formula}2n−1 times. And since, in {a mathematical formula}ΘDn⁎, regions corresponding to pairs of crossing edges are required to satisfy EC, we see that the member of the tuple {a mathematical formula}s¯ corresponding to the edge {a mathematical formula}(un,vn) must have at least {a mathematical formula}(2n−1+1) i-components—each separated from the others by these crossing points.  □</paragraph><paragraph>The next observation shows that this is as bad as things get.</paragraph><paragraph label="Proof">If Φ is an{a mathematical formula}RCC8c- or{a mathematical formula}RCC8c∘-network satisfiable over{a mathematical formula}RCP+(R2), then Φ has a satisfying assignment that can be drawn using points with integer coordinates in a square grid of size{a mathematical formula}2O(|Φ|).Immediate from the proofs of Lemma 24, Lemma 26 together with Proposition 1, Proposition 5.  □</paragraph><paragraph>Thus, over {a mathematical formula}RCP+(R2) (and hence also over {a mathematical formula}RC+(R2)), {a mathematical formula}RCC8c can force arrangements with polynomially many components, but exponentially many i-components.</paragraph><paragraph>Turning now to {a mathematical formula}RCC8c∘, a different pattern emerges. We consider first satisfiability over {a mathematical formula}RCP+(R2). As we have already observed, in terms of counting i-components, there is even less scope for forcing complexity than with {a mathematical formula}RCC8c: by Lemma 26, if an {a mathematical formula}RCC8c∘-network Φ is satisfiable over {a mathematical formula}RCP+(R2), then Φ has a satisfying assignment in which no region has more than {a mathematical formula}3|Φ|2 i-components. Of course, just because each region in a satisfying assignment has only polynomially many i-components, that says nothing about how these i-components intersect. And indeed, a simple modification of the argument of Theorem 30 shows that there exists a sequence {a mathematical formula}{Φn}n≥1 of {a mathematical formula}RCC8c∘-networks, satisfiable over {a mathematical formula}RCP+(R2), such that {a mathematical formula}|Φn| is {a mathematical formula}O(n), but every satisfying assignment involves a drawing with {a mathematical formula}2Ω(n) arc-crossings. (Again, we know from Theorem 31 that this is as bad as things get.) Thus, over {a mathematical formula}RCP+(R2), {a mathematical formula}RCC8c∘ can force arrangements with polynomially many i-components, but exponentially complicated drawings.</paragraph><paragraph>Finally, we consider the complexity of satisfying assignments for {a mathematical formula}RCC8c∘-networks over {a mathematical formula}RC+(R2). We show that, in 2-dimensional space, {a mathematical formula}RCC8c∘-networks can force regions in satisfying assignments to be infinitely fragmented.</paragraph><paragraph label="Theorem 32">There exists an{a mathematical formula}RCC8c∘-formula that is satisfiable over{a mathematical formula}RC+(R2), but only by tuples some of whose elements have infinitely many components.</paragraph><paragraph label="Proof">We briefly outline the underlying intuition. Using Lemma 9, we write {a mathematical formula}RCC8c∘-constraints whose only satisfying assignments strongly embed the plane graph in Fig. 24. By adding the constraints (39), (40), (41), (42), (43), (44), (45) we ensure the existence of a region t, including the point {a mathematical formula}v1, and containing points close to {a mathematical formula}w2, and a region u, including the point {a mathematical formula}w1, and containing points close to {a mathematical formula}v2. The regions t and u are both confined to the interior of the large triangle, and have no internal points in common. These constraints thus force t and u to consist of infinitely many interleaving ‘fingers’, arranged as indicated by the bold lines in Fig. 25. By adding the constraints (46), (47), we ensure the existence of a region {a mathematical formula}u0⊆u such that infinitely many of the fingers of u contain points of {a mathematical formula}u0.Let H be the plane graph depicted in Fig. 24. We label the points of H as {a mathematical formula}v1,…,v7,w1,…,w7 and its arcs as {a mathematical formula}α0,…,α7,β1,…,β7, the double sets of letters broadly reflecting the symmetry of H about the central arc {a mathematical formula}α0. Let {a mathematical formula}H+ be a 3-connected, plane graph extending H.We may regard H and {a mathematical formula}H+ as graphs (as opposed to plane graphs) in the usual way, so that the constraint networks {a mathematical formula}ΩH∘ and {a mathematical formula}ΩH+∘ are as defined in Section 3. Let us write {a mathematical formula}ΩH∘=ΩH∘(p¯q¯;r¯s¯), where the variables {a mathematical formula}p¯=p1,…,p7 and {a mathematical formula}q¯=q1,…,q7 correspond to the points (vertices) {a mathematical formula}v1,…,v7 and {a mathematical formula}w1,…,w7, respectively, and the variables {a mathematical formula}r¯=r0,r1,…,r7 and {a mathematical formula}s¯=s1,…,s7 correspond to the arcs (edges) {a mathematical formula}α0,α1,…,α7 and {a mathematical formula}β1,…,β7, respectively. Letting the variables {a mathematical formula}p¯′ correspond to those points of {a mathematical formula}H+ not present in H, and the variables {a mathematical formula}r¯′ to those arcs of {a mathematical formula}H+ not present in H, we may write {a mathematical formula}ΩH+∘=ΩH+∘(p¯q¯p¯′;r¯s¯r¯′). Obviously, {a mathematical formula}ΩH+∘ includes {a mathematical formula}ΩH∘ as a subset. We shall sometimes refer to the regions denoted by {a mathematical formula}p¯q¯p¯′ as vertex-regions, and those denoted by {a mathematical formula}r¯s¯r¯′ as edge-regions.Now let t, u and {a mathematical formula}u0 be fresh variables, and let {a mathematical formula}Ψ(p¯q¯p¯′,r¯s¯r¯′,t,u,u0) be the union of {a mathematical formula}ΩH+∘ with the constraints (39), (40), (41), (42), (43), (44), (45), (46), (47) given below. To help motivate the construction, we divide these constraints into groups. We have included some deliberate redundancies for the sake of clarity.We shall require t and u to be interior-connected regions, in external contact with both {a mathematical formula}p2 and {a mathematical formula}q2, and with each other:{a mathematical formula}{a mathematical formula}{a mathematical formula} In addition, {a mathematical formula}t∘ includes {a mathematical formula}p1 and {a mathematical formula}u∘ includes {a mathematical formula}q1:{a mathematical formula}We further insist that neither t nor u intersect any of the vertex-regions {a mathematical formula}p3,…,p7 or {a mathematical formula}q3,…,q7. In addition, t may not intersect any of the edge-regions {a mathematical formula}r¯,s¯, except (possibly) {a mathematical formula}r0 or {a mathematical formula}r1; and u may not intersect any of {a mathematical formula}r¯,s¯, except (possibly) {a mathematical formula}r0 or {a mathematical formula}s1.{a mathematical formula}{a mathematical formula}{a mathematical formula} Finally, we take {a mathematical formula}u0 to be a region included in u, in external contact with {a mathematical formula}p2 but disjoint from both {a mathematical formula}r0 and {a mathematical formula}r1.{a mathematical formula}{a mathematical formula} Notice that we do not require {a mathematical formula}u0 to be interior-connected.We first show that Ψ is satisfiable. Returning to the view of {a mathematical formula}H+ as a plane graph, let {a mathematical formula}p¯, {a mathematical formula}q¯, {a mathematical formula}p¯′, {a mathematical formula}r¯, {a mathematical formula}s¯ and {a mathematical formula}r¯′ be the tuples of regions obtained by canonically thickening the vertices and edges of {a mathematical formula}H+, as in the proof of Lemma 9 (a), so that {a mathematical formula}ΩH+∘ is satisfied. Thus, each point of H lies in the interior of the corresponding vertex-region: {a mathematical formula}vi∈pi∘ and {a mathematical formula}wi∈qi∘ ({a mathematical formula}1≤i≤7). Furthermore, each arc of H lies in the union of the interiors of the corresponding edge- and vertex-regions: for example, {a mathematical formula}α0⊆p7∘∪r0∘∪q7∘, and so on. Fig. 25 shows some representative examples.Let {a mathematical formula}{xi}i≥0 be an infinite sequence of points, arranged as shown in Fig. 25, and having an accumulation point {a mathematical formula}x⁎ on the boundary of {a mathematical formula}q2. For each {a mathematical formula}i≥0, let {a mathematical formula}ζi be an arc from {a mathematical formula}v1 to {a mathematical formula}xi, drawn as shown (up to {a mathematical formula}i=1) in Fig. 25. Let the points {a mathematical formula}yi and arcs {a mathematical formula}ηi be constructed similarly, with the {a mathematical formula}yi having an accumulation point {a mathematical formula}y⁎ on the boundary of {a mathematical formula}p2, and {a mathematical formula}ηi connecting {a mathematical formula}w1 to {a mathematical formula}yi. Now let t be the result of thickening all the {a mathematical formula}ζi and taking the infinite sum in {a mathematical formula}RC(R2); and let u be the result of thickening all the {a mathematical formula}ηi and taking the infinite sum in {a mathematical formula}RC(R2). Clearly, this may be done in such a way that constraints (39), (40), (41), (42), (43), (44), (45) are satisfied. Finally, draw a small disc around each {a mathematical formula}yi, lying in the interior of u. Clearly, this may be done so that each disc maintains some fixed minimum distance from both {a mathematical formula}r0 and {a mathematical formula}r1. Let {a mathematical formula}u0 be the infinite sum, in {a mathematical formula}RC(R2), of these discs. Then the constraints (46), (47) are satisfied: in particular, the accumulation point {a mathematical formula}y⁎ lies on the frontier of {a mathematical formula}u0. Thus, Ψ is satisfiable over {a mathematical formula}RC+(R2), as required. Observe that, in this satisfying assignment, {a mathematical formula}u0 has infinitely many components, namely, the discs around the {a mathematical formula}yi.Now suppose {a mathematical formula}Ψ(p¯q¯p¯′,r¯s¯r¯′,t,u,u0) holds; we show that {a mathematical formula}u0 has infinitely many components. Since {a mathematical formula}Ψ⊇ΩH+∘⊇ΩH∘, the tuple {a mathematical formula}(p¯q¯p¯′;r¯s¯r¯), by Lemma 9 (b), strongly embeds some drawing of the planar graph H. In fact, since the graph {a mathematical formula}H+ is 3-connected, it has at most one drawing in {a mathematical formula}S2 up to isomorphism, so that, applying a homeomorphism if necessary, the induced embedding of the subgraph H is exactly as shown in Fig. 24. Thus, each point of H lies in the interior of the corresponding vertex-region: {a mathematical formula}vi∈pi∘ and {a mathematical formula}wi∈qi∘ ({a mathematical formula}1≤i≤7). Furthermore, each arc of H lies in the union of the interiors of the corresponding edge- and vertex-regions: for example, {a mathematical formula}α0⊆p7∘∪r0∘∪q7∘, and so on. In what follows we assume some orientation of arcs (which should be clear from the context) and often identify arcs with their loci, to reduce clutter.Denote by {a mathematical formula}V0 the closed trapezoid indicated in Fig. 26 by the dark grey shading. From the constraints in {a mathematical formula}ΩH+∘, we have {a mathematical formula}q2⊆V0∘ and so, by (40), {a mathematical formula}V0∘∩t≠∅, whence there exists a point {a mathematical formula}x0∈V0∘∩t∘. On the other hand, by (42), {a mathematical formula}v1∈t∘. Since {a mathematical formula}t∘ is connected, by (39), there exists an arc {a mathematical formula}ζ0′⊆t∘ from {a mathematical formula}v1 to {a mathematical formula}x0. By (43), (44), (45), {a mathematical formula}ζ0′ lies entirely within the large triangle. Let {a mathematical formula}x0′ be the first point of {a mathematical formula}ζ0′ lying on {a mathematical formula}α0 and let {a mathematical formula}x0″ be the last point of {a mathematical formula}ζ0′[v1,x0′] lying on {a mathematical formula}α1. Consider {a mathematical formula}ζ0=ζ0′[x0″,x0′]. Thus, {a mathematical formula}ζ0α0[x0′,v7]α3α4α1[v4,x0″] is a Jordan curve, which we denote by {a mathematical formula}Γ0.We claim that {a mathematical formula}Γ0 separates the region {a mathematical formula}p2 from the point {a mathematical formula}w1. To see this, note that {a mathematical formula}ζ0⊆t∘ can intersect, by (43), (44), (45), neither {a mathematical formula}α2⊆p2∘∪r2∘∪p3∘ nor the triangle T bounded by {a mathematical formula}β1, {a mathematical formula}β5 and {a mathematical formula}β6. Now connect {a mathematical formula}p2 to {a mathematical formula}w1 by first following {a mathematical formula}α2 upwards, and then proceeding along the dashed path in Fig. 26—i.e. leave the large triangle at {a mathematical formula}v3; re-enter it at {a mathematical formula}w5; and proceed directly to {a mathematical formula}w1. Since {a mathematical formula}ζ0∩(α2∪T)=∅, this path intersects {a mathematical formula}Γ0 at a single point, namely, {a mathematical formula}v3, establishing that {a mathematical formula}Γ0 separates {a mathematical formula}p2 and {a mathematical formula}w1. Denote by {a mathematical formula}U0 the closed region with frontier {a mathematical formula}Γ0 that includes {a mathematical formula}p2 (light grey shading in Fig. 26).Now fix any {a mathematical formula}i≥1, and assume that the points {a mathematical formula}xi−1″∈α1, {a mathematical formula}xi−1′∈α0 and arc {a mathematical formula}ζi−1⊆t∘ have been constructed such that {a mathematical formula}ζi−1 connects {a mathematical formula}xi−1″ to {a mathematical formula}xi−1′, and the Jordan curve {a mathematical formula}Γi−1=ζi−1α0[xi−1′,v7]α3α4α1[v4,xi−1″] is the frontier of a closed region {a mathematical formula}Ui−1 including the region {a mathematical formula}p2 in its interior, but not containing the point {a mathematical formula}w1 (dark grey area in Fig. 27). By the second constraint in (46), {a mathematical formula}Ui−1∘∩u0≠∅, whence there exists a point {a mathematical formula}yi∈Ui−1∘∩u0∘. By the first constraint in (46), {a mathematical formula}yi∈u∘. On the other hand, by (42), {a mathematical formula}w1∈u∘. Since {a mathematical formula}u∘ is connected, by (39), there exists an arc {a mathematical formula}ηi′⊆u∘ from {a mathematical formula}w1 to {a mathematical formula}yi (Fig. 27). By (43), (44), (45), {a mathematical formula}ηi′ lies entirely within the large triangle.We know that {a mathematical formula}ηi′ intersects {a mathematical formula}Γi−1. Indeed, by (43), (44), (45) and (41), {a mathematical formula}ηi′⊆u∘ must be disjoint from {a mathematical formula}α1, {a mathematical formula}α3, {a mathematical formula}α4 and {a mathematical formula}ζi−1, and therefore intersects {a mathematical formula}α0[xi−1′,v7]. Let {a mathematical formula}yi′ be the point of {a mathematical formula}ηi′∩α0[xi−1′,v7] lying nearest to {a mathematical formula}v7 (Fig. 27). Let {a mathematical formula}yi″ be the last point of {a mathematical formula}ηi′[w1,yi′] lying on {a mathematical formula}β1, and let {a mathematical formula}ηi=ηi′[yi″,yi′]. Thus, {a mathematical formula}ηiα0[yi′,v7]β3β4β1[w4,yi″] is a Jordan curve, which we denote by {a mathematical formula}Δi. We remark that {a mathematical formula}yi′ need not be the first, or the last point of {a mathematical formula}ηi′ lying on {a mathematical formula}α0 as we travel from {a mathematical formula}w1 to {a mathematical formula}yi; it is simply the nearest to {a mathematical formula}v7.We claim that {a mathematical formula}Δi separates the region {a mathematical formula}q2 from the point {a mathematical formula}v1. To see this, note that {a mathematical formula}ηi⊆u∘ can intersect, by (43), (44), (45), neither {a mathematical formula}β2⊆q2∘∪s2∘∪q3∘, nor the triangle S bounded by {a mathematical formula}α1, {a mathematical formula}α5 and {a mathematical formula}α6. Hence, using a mirror image of the construction for {a mathematical formula}Γ0, we may connect {a mathematical formula}q2 to {a mathematical formula}v1 by a path guaranteed to intersect {a mathematical formula}Δi at a single point, namely, {a mathematical formula}w3. Denote by {a mathematical formula}Vi the regular closed region with boundary {a mathematical formula}Δi which includes {a mathematical formula}q2 (light grey area in Fig. 27).Having constructed {a mathematical formula}Vi on the basis of {a mathematical formula}Ui−1, we proceed to construct {a mathematical formula}Ui on the basis of {a mathematical formula}Vi. We know that {a mathematical formula}q2⊆Vi∘, and that the frontier of {a mathematical formula}Vi is {a mathematical formula}Δi=ηiα0[yi′,v7]β3β4β1[w4,yi″]. By (40), {a mathematical formula}Vi∘∩t≠∅, whence there exists a point {a mathematical formula}xi∈Vi∘∩t∘. On the other hand, by (42), {a mathematical formula}v1∈t∘. Since {a mathematical formula}t∘ is connected, by (39), there exists an arc {a mathematical formula}ζi′⊆t∘ from {a mathematical formula}v1 to {a mathematical formula}xi. By (43), (44), (45), {a mathematical formula}ζi′ lies entirely within the large triangle (Fig. 28).We know that {a mathematical formula}ζi′ intersects {a mathematical formula}Δi. Indeed, {a mathematical formula}ζi′⊆t∘ must be disjoint, by (43), (44), (45) and (41), from {a mathematical formula}β1, {a mathematical formula}β3, {a mathematical formula}β4 and {a mathematical formula}ηi, and therefore intersects {a mathematical formula}α0[yi′,v7]. Let {a mathematical formula}xi′ be the first point of {a mathematical formula}ζi′ lying on {a mathematical formula}α0[yi′,v7] and let {a mathematical formula}xi″ be the last point of {a mathematical formula}ζi′[v1,xi′] lying on {a mathematical formula}α1. Let {a mathematical formula}ζi=ζi′[xi″,xi′]. Thus, {a mathematical formula}ζiα0[xi′,v7]α3α4α1[v4,xi″] is a Jordan curve, which we denote by {a mathematical formula}Γi.We claim that {a mathematical formula}Γi separates the region {a mathematical formula}p2 from the point {a mathematical formula}w1. To see this, note that {a mathematical formula}ζi⊆t∘ can intersect, by (43), (44), (45), neither {a mathematical formula}α2⊆p2∘∪r2∘∪p3∘ nor the triangle T bounded by {a mathematical formula}β1, {a mathematical formula}β5 and {a mathematical formula}β6. Now connect {a mathematical formula}p2 to {a mathematical formula}w1 by first following {a mathematical formula}α2 upwards, and then proceeding along the dashed path as with the construction of {a mathematical formula}Γ0 (in Fig. 26). Since {a mathematical formula}ζi∩(α2∪T)=∅, this path intersects {a mathematical formula}Γi at a single point, namely, {a mathematical formula}v3, establishing that {a mathematical formula}Γi separates {a mathematical formula}p2 and {a mathematical formula}w1. Denote by {a mathematical formula}Ui the closed region with frontier {a mathematical formula}Γi which includes {a mathematical formula}p2 (light grey shading in Fig. 28).We have constructed points {a mathematical formula}xi″∈α1, {a mathematical formula}xi′∈α0 and an arc {a mathematical formula}ζi⊆t∘, such that {a mathematical formula}ζi connects {a mathematical formula}xi″ to {a mathematical formula}xi′, and the Jordan curve {a mathematical formula}Γi=ζiα0[xi′,v7]α3α4α1[v4,xi″] forms the frontier of a region {a mathematical formula}Ui including {a mathematical formula}p2, but not containing the point {a mathematical formula}w1. The construction thus repeats indefinitely, generating series of points {a mathematical formula}xi″, {a mathematical formula}xi′, {a mathematical formula}yi″, {a mathematical formula}yi′ and arcs {a mathematical formula}ζi, {a mathematical formula}ηi, with the properties established above, for all {a mathematical formula}i≥1. We remark in passing that {a mathematical formula}Ui is not necessarily a subset of {a mathematical formula}Ui−1 (as shown in Fig. 27, Fig. 28).By definition, {a mathematical formula}yi∈Ui−1∘ for all {a mathematical formula}i≥1. We claim that {a mathematical formula}yj∉Ui−1, for all {a mathematical formula}j&lt;i−1. To see this, note first that, by construction, the sequence of points {a mathematical formula}x0′,y1′,x1′,y2′,… on the central arc {a mathematical formula}α0 creeps steadily upwards: hence, {a mathematical formula}yj′ lies (non-strictly) below {a mathematical formula}yi−1′, which in turn lies strictly below {a mathematical formula}xi−1′. Also by definition, {a mathematical formula}yj′ is that point of {a mathematical formula}ηj′∩α0 lying nearest to {a mathematical formula}v7: hence {a mathematical formula}ηj′ cannot intersect {a mathematical formula}α0[xi−1′,v7]. On the other hand, {a mathematical formula}ηj′⊆u∘ cannot intersect any of {a mathematical formula}ζi, {a mathematical formula}α3, {a mathematical formula}α4 or {a mathematical formula}α1 either, by (43), (44), (45). That is, {a mathematical formula}ηj′ does not intersect {a mathematical formula}Γi−1, and joins {a mathematical formula}w1∉Ui−1 to {a mathematical formula}yj. It follows that {a mathematical formula}yj∉Ui−1, as claimed.Consider the infinite sequence of points {a mathematical formula}y1,y2,… in {a mathematical formula}u0, and the infinite sequence of closed sets {a mathematical formula}U0,U1,…, with respective boundaries {a mathematical formula}Γ0,Γ1,…. Since {a mathematical formula}Γi=ζiα0[xi′,v7]α3α4α1[v4,xi″]⊆t∘∪r0∘∪p7∘∪r3∘∪p3∘∪r4∘∪p4∘∪r1∘, it does not intersect {a mathematical formula}u0, by (41) and (45), (46), (47). Further, we have established that, for {a mathematical formula}1≤j&lt;i, {a mathematical formula}yj∈Uj−1∖Ui−1 and {a mathematical formula}yj∈u0. Thus, {a mathematical formula}yi and {a mathematical formula}yj ({a mathematical formula}i≠j) lie in different components of {a mathematical formula}u0. Hence, {a mathematical formula}u0 has infinitely many components.  □</paragraph><paragraph>It is not known whether {a mathematical formula}Sat(RCC8c∘,RC+(R2)) is decidable. Theorem 32 suggests that resolving this issue may not be completely straightforward.</paragraph></section><section label="9"><section-title>Conclusion</section-title><paragraph>In this article, we investigated the widely studied qualitative spatial representation language known as {a mathematical formula}RCC8. This language allows us to write qualitative descriptions of spatial configurations in the form of networks of atomic constraints, with variables ranging over spatial regions, usually modelled as regular closed sets of some topological space. The satisfiability problem for this language is known to be largely independent of the topological space in question, and to have low computational complexity. Algorithms for solving this problem based on constraint satisfaction techniques have been known for some time, and their behaviour investigated in detail. Our point of departure was the observation that this formalism does not allow us to state that regions are connected (i.e. consist of a single piece), and we asked what would happen if such a facility were added. We considered two extensions of {a mathematical formula}RCC8: {a mathematical formula}RCC8c, in which we can state that a region is connected, and {a mathematical formula}RCC8c∘, in which we can instead state that a region has a connected interior. And we investigated the satisfiability problems for these languages over regular closed sets of low-dimensional Euclidean spaces. The work reported here is similar in spirit to Davis, Gotts and Cohn's analogous extension of {a mathematical formula}RCC8 by means of a convexity predicate [26], and partly relies on the remarkable results of Schaefer, Sedgwick and Štefankovič [24], [25] on the satisfiability problem for {a mathematical formula}RCC8 interpreted over the collection of disc-homeomorphs in the plane.</paragraph><paragraph>It is easy to see that, for both {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘, the satisfiability problem over the regular closed sets of {a mathematical formula}Rn depends on n, for {a mathematical formula}n≤3, but is identical for all {a mathematical formula}n≥3. Less obviously, we showed that, in the case of {a mathematical formula}RCC8c∘, there exist finite sets of constraints that are satisfiable over {a mathematical formula}RC+(R2), but only by ‘wild’ regions having no possible physical meaning. This prompted us to consider interpretations over the more restrictive domain of non-empty, regular closed, polyhedral sets, {a mathematical formula}RCP+(Rn). We found that the satisfiability problems for {a mathematical formula}RCC8c (equivalently, {a mathematical formula}RCC8c∘) over {a mathematical formula}RC+(R) and {a mathematical formula}RCP+(R) are distinct and both NP-complete; the satisfiability problems for {a mathematical formula}RCC8c over {a mathematical formula}RC+(R2) and {a mathematical formula}RCP+(R2) are identical and NP-complete; and the satisfiability problems for {a mathematical formula}RCC8c∘ over {a mathematical formula}RC+(R2) and {a mathematical formula}RCP+(R2) are distinct, with the latter being NP-complete. Decidability of the satisfiability problem for {a mathematical formula}RCC8c∘ over {a mathematical formula}RC+(R2) remains open. For {a mathematical formula}n≥3, {a mathematical formula}RCC8c and {a mathematical formula}RCC8c∘ are not interestingly different from {a mathematical formula}RCC8. The obtained separation and complexity results are collected in Table 1.</paragraph><paragraph>We finished by answering the following question: given that a set of {a mathematical formula}RCC8c- or {a mathematical formula}RCC8c∘-constraints is satisfiable over {a mathematical formula}RC+(Rn) or {a mathematical formula}RCP+(Rn), how complex is the simplest satisfying assignment? For both languages, we exhibited a sequence of constraints {a mathematical formula}Φn, satisfiable over {a mathematical formula}RCP+(R2), such that the size of {a mathematical formula}Φn grows polynomially in n, while the smallest configuration of polygons satisfying {a mathematical formula}Φn cuts the plane into a number of pieces that grows exponentially. Over {a mathematical formula}RC+(R2), the situation is still more dramatic: we showed that, over {a mathematical formula}RC+(R2), {a mathematical formula}RCC8c again requires exponentially large satisfying diagrams, while {a mathematical formula}RCC8c∘ can force regions in satisfying configurations to have infinitely many components.</paragraph></section></content><references><reference label="[1]"><authors>A. Galton</authors><title>Qualitative Spatial Change</title><host>(2000)Oxford University PressOxford</host></reference><reference label="[2]"><authors>A. Cohn,S. Hazarika</authors><title>Qualitative spatial representation and reasoning: an overview</title><host>Fundam. Inform.46 (2001) pp.1-29</host></reference><reference label="[3]"><authors>A. Cohn,J. Renz</authors><title>Qualitative spatial representation and reasoning</title><host>F. van HarmelenV. LifschitzB. PorterHandbook of Knowledge Representation(2008)Elsevier pp.551-596</host></reference><reference label="[4]"><authors>M. Egenhofer,R. Franzosa</authors><title>Point-set topological spatial relations</title><host>Int. J. Geogr. Inf. Syst.5 (1991) pp.161-174</host></reference><reference label="[5]">M. Egenhofer,J. HerringCategorizing topological relationships between regions, lines and point in geographic databasesTech. rep.<host>(1991)Department of Surveying Engineering, University of Maine</host></reference><reference label="[6]"><authors>D. Randell,Z. Cui,A. Cohn</authors><title>A spatial logic based on regions and connection</title><host>B. NebelC. RichW. SwartoutProc. of the 3rd International Conference on Principles of Knowledge Representation and Reasoning (KR'92)(1992)Morgan Kaufmann pp.165-176</host></reference><reference label="[7]"><authors>T. Smith,K. Park</authors><title>An algebraic approach to spatial reasoning</title><host>Int. J. Geogr. Inf. Syst.6 (1992) pp.177-192</host></reference><reference label="[8]"><authors>B. Clarke</authors><title>A calculus of individuals based on ‘connection’</title><host>Notre Dame J. Form. Log.23 (1981) pp.204-218</host></reference><reference label="[9]"><authors>B. Clarke</authors><title>Individuals and points</title><host>Notre Dame J. Form. Log.26 (1985) pp.61-75</host></reference><reference label="[10]"><authors>A. Whitehead</authors><title>Process and Reality</title><host>(1929)The MacMillan CompanyNew York</host></reference><reference label="[11]"><authors>T. de Laguna</authors><title>Point, line and surface as sets of solids</title><host>J. Philos.19 (1922) pp.449-</host></reference><reference label="[12]"><authors>I. Düntsch,H. Wang,S. McCloskey</authors><title>Relation algebras in qualitative spatial reasoning</title><host>Fundam. Inform.39 (1999) pp.229-248</host></reference><reference label="[13]"><authors>S. Li,M. Ying</authors><title>Extensionality of the RCC8 composition table</title><host>Fundam. Inform.55 (3–4)(2003) pp.363-385</host></reference><reference label="[14]"><authors>S. Li,Y. Li</authors><title>On the complemented disk algebra</title><host>J. Log. Algebr. Program.66 (2006) pp.195-211</host></reference><reference label="[15]"><authors>B. Bennett</authors><title>Spatial reasoning with propositional logic</title><host>J. DoyleE. SandewallP. TorassoProc. of the 4th International Conference on Principles of Knowledge Representation and Reasoning (KR'94)(1994)Morgan Kaufmann pp.51-62</host></reference><reference label="[16]"><authors>M. Grigni,D. Papadias,C. Papadimitriou</authors><title>Topological inference</title><host>Proc. of the 14th International Joint Conference on Artificial intelligence (IJCAI'95)(1995)Morgan Kaufmann pp.901-906</host></reference><reference label="[17]"><authors>B. Nebel</authors><title>Computational properties of qualitative spatial reasoning: first results</title><host>I. WachsmuthC.-R. RollingerW. BrauerProc. of the 19th Annual German Conference on Artificial Intelligence (KI-95)Lecture Notes in Computer Sciencevol. 981 (1995)Springer pp.233-244</host></reference><reference label="[18]"><authors>B. Bennett</authors><title>Determining consistency of topological relations</title><host>Constraints3 (1997) pp.1-13</host></reference><reference label="[19]"><authors>J. Renz</authors><title>Maximal tractable fragments of the region connection calculus: a complete analysis</title><host>T. DeanProc. of the 16th International Joint Conference on Artificial Intelligence (IJCAI'99)(1999)Morgan Kaufmann pp.448-454</host></reference><reference label="[20]"><authors>J. Renz</authors><title>A canonical model of the region connection calculus</title><host>A. CohnL. SchubertS. ShapiroProc. of the 6th International Conference on Principles of Knowledge Representation and Reasoning (KR'98)(1998)Morgan Kaufmann pp.330-341</host></reference><reference label="[21]">A. GriffithsComputational properties of spatial logics in the real planePh.D. thesis<host>(2008)School of Computer Science, University of Manchester</host></reference><reference label="[22]"><authors>J. Renz,B. Nebel</authors><title>On the complexity of qualitative spatial reasoning</title><host>Artif. Intell.108 (1999) pp.69-123</host></reference><reference label="[23]"><authors>M. Westphal,S. Wölfl</authors><title>Qualitative CSP, finite CSP, and SAT: comparing methods for qualitative constraint-based reasoning</title><host>C. BoutilierProc. of the 21st International Joint Conference on Artificial Intelligence (IJCAI-09)(2009)AAAI Publications pp.628-633</host></reference><reference label="[24]"><authors>M. Schaefer,E. Sedgwick,D. Štefankovič</authors><title>Recognizing string graphs in NP</title><host>J. Comput. Syst. Sci.67 (2)(2003) pp.365-380</host></reference><reference label="[25]"><authors>M. Schaefer,D. Štefankovič</authors><title>Decidability of string graphs</title><host>J. Comput. Syst. Sci.68 (2)(2004) pp.319-334</host></reference><reference label="[26]"><authors>E. Davis,N. Gotts,A. Cohn</authors><title>Constraint networks of topological relations and convexity</title><host>Constraints4 (3)(1999) pp.241-280</host></reference><reference label="[27]"><authors>S. Koppelberg</authors><title>Handbook of Boolean Algebras, vol. 1</title><host>(1989)North-Holland</host></reference><reference label="[28]"><authors>M. Newman</authors><title>Elements of the Topology of Plane Sets of Points</title><host>(1964)Cambridge University PressCambridge</host></reference><reference label="[29]"><authors>J. Bochnak,M. Coste,M.-F. Roy</authors><title>Real Algebraic Geometry</title><host>Ergebnisse der Mathematik und ihrer Grenzgebietevol. 36 (1998)Springer</host></reference><reference label="[30]"><authors>R. Diestel</authors><title>Graph Theory</title><host>Graduate Texts in Mathematicsvol. 173 (1991)Springer VerlagNew York</host></reference><reference label="[31]"><authors>J. Kratochvíl,J. Matoušek</authors><title>String graphs requiring exponential representations</title><host>J. Comb. Theory, Ser. B53 (1991) pp.1-4</host></reference><reference label="[32]"><authors>W. Schnyder</authors><title>Embedding planar graphs on the grid</title><host>D.S. JohnsonProc. of the 1st Annual ACM–SIAM Symposium on Discrete Algorithms (SODA'90)(1990)SIAM pp.138-148</host></reference><reference label="[33]"><authors>J. Kratochvíl</authors><title>String graphs. II. Recognizing string graphs is NP-hard</title><host>J. Comb. Theory, Ser. B52 (1991) pp.67-78</host></reference><reference label="[34]"><authors>E. Börger,E. Grädel,Y. Gurevich</authors><title>The Classical Decision Problem</title><host>Perspectives in Mathematical Logic (1997)Springer</host></reference><reference label="[35]"><authors>M. Bodirsky,S. Wölfl</authors><title>RCC8 is polynomial on networks of bounded treewidth</title><host>T. WalshProc. of the 22nd International Joint Conference on Artificial Intelligence (IJCAI 2011)(2011)IJCAI/AAAI pp.756-761</host></reference><reference label="[36]"><authors>R. Kontchakov,I. Pratt-Hartmann,M. Zakharyaschev</authors><title>Interpreting topological logics over Euclidean spaces</title><host>F. LinU. SattlerM. TruszczynskiProc. of the 12th International Conference on Principles of Knowledge Representation and Reasoning (KR 2010)(2010)AAAI Press pp.534-544</host></reference><reference label="[37]"><authors>A. Krokhin,P. Jeavons,P. Jonsson</authors><title>Reasoning about temporal relations: the tractable subalgebras of Allen's interval algebra</title><host>J. ACM50 (5)(2003) pp.591-640</host></reference><reference label="[38]"><authors>M. Vilain,H. Kautz</authors><title>Constraint propagation algorithms for temporal reasoning</title><host>T. KehlerProc. of the 5th National Conference on Artificial Intelligence (AAAI'86)(1986)Morgan Kaufmann pp.377-382</host></reference></references><footnote><note-para label="1">www.opengeospatial.org/standards/geosparql.</note-para><note-para label="2">One famous exception (proving the rule) is the town Jungholz, an exclave of Austria connected to the rest of that country by a single point (en.wikipedia.org/wiki/Jungholz). This configuration caused various problems before Austria joined the EU. See also jungholz.enclaves.org.</note-para><note-para label="3">This is the second statement of Theorem 6, p. 537; the first statement of that theorem, repeated here as Theorem 25, is correct.</note-para><note-para label="4">As observed by one of the anonymous reviewers, this theorem follows from the classification of tractable subalgebras of Allen's interval algebra given in [37].</note-para><note-para label="5">The first sentence on p. 105 makes a false claim.</note-para><note-para label="6">Theorem 9, p. 539; the preceding Lemma 2 is false, as shown by the first inequality {a mathematical formula}Sat(RCC8,D)⫋Sat(RCC8,I) of Theorem 13 of the present article.</note-para></footnote></root>