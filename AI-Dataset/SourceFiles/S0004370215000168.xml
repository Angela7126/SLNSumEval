<?xml version="1.0" encoding="UTF-8"?><root><url>https://www.sciencedirect.com/science/article/pii//S0004370215000168</url><title>Moving average reversion strategy for on-line portfolio selection</title><authors>Bin Li,Steven C.H. Hoi,Doyen Sahoo,Zhi-Yong Liu</authors><abstract>On-line portfolio selection, a fundamental problem in computational finance, has attracted increasing interest from artificial intelligence and machine learning communities in recent years. Empirical evidence shows that stock's high and low prices are temporary and stock prices are likely to follow the mean reversion phenomenon. While existing mean reversion strategies are shown to achieve good empirical performance on many real datasets, they often make the single-period mean reversion assumption, which is not always satisfied, leading to poor performance in certain real datasets. To overcome this limitation, this article proposes a multiple-period mean reversion, or so-called “Moving Average Reversion” (MAR), and a new on-line portfolio selection strategy named “On-Line Moving Average Reversion” (OLMAR), which exploits MAR via efficient and scalable online machine learning techniques. From our empirical results on real markets, we found that OLMAR can overcome the drawbacks of existing mean reversion algorithms and achieve significantly better results, especially on the datasets where existing mean reversion algorithms failed. In addition to its superior empirical performance, OLMAR also runs extremely fast, further supporting its practical applicability to a wide range of applications. Finally, we have made all the datasets and source codes of this work publicly available at our project website: http://OLPS.stevenhoi.org/.</abstract><keywords>Portfolio selection;On-line learning;Mean reversion;Moving average reversion</keywords><content><section label="1"><section-title>Introduction</section-title><paragraph>Portfolio selection is a fundamental problem of computational finance extensively explored across several fields, ranging from traditional finance theory and quantitative finance, to machine learning and artificial intelligence [43]. It generally aims to achieve some targets in the long run by sequentially allocating wealth across a set of assets. Two major schools of principles and theories for portfolio selection include: (i) Mean-variance theory [48] that trades off between expected return (mean) and risk (variance) of a portfolio, which is suitable for single-period portfolio selection; and (ii) Kelly investment [41], [10], [23] that aims to maximize the expected log return of a portfolio and is naturally available to multiple-period portfolio selection. Due to the sequential nature of a real-world portfolio selection task, many recent on-line portfolio selection techniques often follow the second approach.</paragraph><paragraph>One important property exploited by many existing studies [8], [46], [45] is the mean reversion property, which assumes poor performing stocks will perform well in the subsequent periods and vice versa. Although some recently proposed mean reversion algorithms [46], [45] have achieved promising results on many real datasets, they might perform extremely poorly on certain datasets, such as the DJIA dataset [8]. Comparing with Borodin et al. [8], which exploits multi-period correlation, we found that the assumption of single-period prediction may attribute to the performance degradation. On the other hand, as illustrated in existing studies [46], [45], Borodin et al. [8] cannot fully exploit the potential of (multi-period) mean reversion for its heuristical nature.</paragraph><paragraph>To address the above drawbacks, we present a new approach for on-line portfolio selection, named “On-Line Moving Average Reversion” (OLMAR). The basic idea is to represent multi-period mean reversion as “Moving Average Reversion” (MAR), which explicitly predicts next price relatives using moving averages, and then learns portfolios via online learning techniques [38]. To the best of our knowledge, OLMAR is the first algorithm that exploits moving average in the setting of on-line portfolio selection. Though simple in nature, OLMAR has a reasonable updating strategy and has been empirically validated via a set of extensive experiments on real markets. The experimental results show that OLMAR not only can achieve better performance (in terms of cumulative wealth) than existing algorithms, but also can avoid the significant performance degradation on certain datasets, such as the DJIA dataset [8], [46]. Finally, OLMAR runs highly efficiently, and thus is suitable for large-scale trading applications.</paragraph><paragraph>The rest of the paper is organized as follows. Section 2 formulates the on-line portfolio selection problem, and Section 3 reviews the background and analyzes related work. Section 4 presents the proposed OLMAR approach, and its effectiveness is validated by extensive empirical studies on real stock markets in Section 5. Section 6 discusses our empirical findings and some threats to validity. Section 7 summarizes the paper and provides directions for future work.</paragraph></section><section label="2"><section-title>Problem setting</section-title><paragraph>Before we formulate the online portfolio selection problem, we first introduce some notations to be used throughout the article. Symbols in bold are vectors, e.g., we define a as a scalar, and b and c as vectors. One typical operation is the product or division between a scalar and a vector, which means each element of the vector will multiply or divide by the scalar, e.g., {a mathematical formula}[ab]i=a⁎bi and {a mathematical formula}[ab]i=abi. For the element-wise operations between two vectors, we denote by {a mathematical formula}ab the element-wise division and {a mathematical formula}a⊗b the element-wise product, which means {a mathematical formula}[ab]i=ai/bi and {a mathematical formula}[a⊗b]i=ai⁎bi, respectively. The dot product between two vectors is defined as {a mathematical formula}a⋅b=aTb=∑i=1nai⁎bi.</paragraph><paragraph>Now let us consider an investment task over a financial market with m assets for n periods. On the tth period, the asset prices are represented by a close price vector{a mathematical formula}pt∈R+m, and each element {a mathematical formula}pt,i represents the close price of asset i. The price changes are represented by a price relative vector{a mathematical formula}xt∈R+m, and {a mathematical formula}xt,i=pt,ipt−1,i. Thus, an investment in asset i on the tth period increases by a factor of {a mathematical formula}xt,i. Let us denote {a mathematical formula}xt1t2={xt1,xt2,…,xt2} as a sequence of price relative vectors ranging from period t1 to t2. Therefore, {a mathematical formula}x1n={x1,…,xn} represents the sequence of price relative vectors over the entire n periods.</paragraph><paragraph>An investment on the tth period is specified by a portfolio vector{a mathematical formula}bt=(bt,1,…,bt,m), where {a mathematical formula}bt,i represents the proportion of wealth invested in asset i. Typically, we assume the portfolio is self-financed and no margin/short sale is allowed, therefore each entry of a portfolio is non-negative and adds up to one, that is, {a mathematical formula}bt∈Δm, where {a mathematical formula}Δm={bt:bt∈R+m,∑i=1mbt,i=1}. The investment procedure is represented by a portfolio strategy, that is, {a mathematical formula}b1=1m1 and the following sequence of mappings {a mathematical formula}bt:R+m(t−1)→Δm, {a mathematical formula}t=2,3,…, where {a mathematical formula}bt=bt(x1t−1) is the tth portfolio given past market sequence of {a mathematical formula}x1t−1={x1,…,xt−1}. We denote by {a mathematical formula}b1n={b1,…,bn} the strategy for n periods.</paragraph><paragraph>On the tth period, a portfolio {a mathematical formula}bt produces a portfolio period return{a mathematical formula}st, that is, the wealth increases by a factor of {a mathematical formula}st=bt⊤xt=∑i=1mbt,ixt,i. Since we reinvest and adopt price relative, the portfolio wealth would multiplicatively grow. Thus, after n periods, a portfolio strategy {a mathematical formula}b1n produces a portfolio cumulative wealth of {a mathematical formula}Sn, which increases the initial wealth by a factor of {a mathematical formula}∏t=1nbt⊤xt, that is, {a mathematical formula}Sn(b1n,x1n)=S0∏t=1nbt⊤xt, where {a mathematical formula}S0 is set to $1 for convenience.</paragraph><paragraph>Finally, we formally formulate the on-line portfolio selection procedure, and outline the algorithmic framework in Algorithm 1. In this task, a portfolio manager is a decision maker, whose goal is to produce a portfolio strategy {a mathematical formula}b1n, aiming to maximize the cumulative wealth {a mathematical formula}Sn. He/she computes the portfolios sequentially. On each period t, the manager has access to the sequence of previous price relative vectors {a mathematical formula}x1t−1. Then, he/she computes a new portfolio {a mathematical formula}bt for next price relative vector {a mathematical formula}xt, where the decision criterion varies among different managers. The portfolio {a mathematical formula}bt is scored based on portfolio period return {a mathematical formula}st. This procedure is repeated until the end, and the portfolio strategy is finally scored according to portfolio cumulative wealth {a mathematical formula}Sn.</paragraph><paragraph>It is important to note that we have made several general and common assumptions in the above model:</paragraph><list><list-item label="1.">Transaction cost: no commission fees or taxes exists;</list-item><list-item label="2.">Market liquidity: one can buy and sell any desired amount, even fractional, at last closing price of any given trading period;</list-item><list-item label="3.">Market impact: any portfolio selection strategy shall not influence the market, or other stocks' prices.</list-item></list><paragraph> Note that although these assumptions are commonly made in many literature studies, they are nontrivial in practice. We will further analyze and discuss their implications and effects in the empirical studies.</paragraph></section><section label="3"><section-title>Background review and related work</section-title><paragraph>In this section, we survey the on-line portfolio selection strategy literature. We start by introducing three benchmarks, that is, market strategy, best stock strategy, and constant rebalanced portfolios strategy. After that, we sequentially introduce three main categories of existing approaches, that is, “Follow-the-Winner”, “Follow-the-Loser”, and “Pattern-Matching” based approaches. Finally, we analyze existing algorithms following the framework of Kelly's investment. Readers are also encouraged to read a more comprehensive survey in [43].</paragraph><section label="3.1"><section-title>Benchmarks</section-title><paragraph>The simplest and commonly used baseline is the Buy-And-Hold (BAH) strategy, that is, one invests his capital among the market with an initial allocation of {a mathematical formula}b1 and holds the portfolio. The manager only buys assets at the beginning of the 1st period and does not rebalance in subsequent periods. BAH's cumulative wealth equals to weighted average of assets' returns, or {a mathematical formula}Sn(BAH(b1))=b1⋅(⨂t=1nxt). The BAH strategy with uniform initial portfolio {a mathematical formula}b1=(1m,…,1m) is referred to as uniform BAH strategy, which is usually adopted as market strategy to produce market index. Another common benchmark is the Best Stock (Best) strategy, a special BAH strategy that invests all capital on the best stock in hindsight.</paragraph><paragraph>One challenging benchmark is the Constant Rebalanced Portfolios (CRP) strategy, which rebalances to a fixed portfolio b every period. In particular, the portfolio strategy can be represented as {a mathematical formula}b1n={b,b,…}, in which b is a predefined portfolio. Thus, CRP's cumulative portfolio wealth can be calculated as {a mathematical formula}Sn(CRP(b))=∏t=1nb⊤xt. One special CRP is the best CRP (BCRP) strategy, which maximizes the cumulative wealth as,{a mathematical formula} Note that BCRP is only a hindsight strategy, which can only be calculated with complete market sequence. Cover and Thomas [16, Theorem 15.3.1] proved that BCRP is an optimal strategy in the i.i.d. market and Cover [14] showed its benefits as a target, that is, BCRP is guaranteed to outperform the Best Stock, Value Line Index and Dow Jones Index.</paragraph><paragraph>One desired theoretical result for an on-line portfolio selection algorithm is universality[14], [50]. An algorithm Alg is universal if the average (external) regret[54], [5] over all sequences of price relative vectors for n periods asymptotically approaches zero, that is,{a mathematical formula} In other words, for an arbitrary sequences of price relatives, a universal algorithm asymptotically approaches the same exponential growth rate as the BCRP strategy.</paragraph></section><section label="3.2"><section-title>Follow-the-Winner approaches</section-title><paragraph>The first approach, Follow-the-Winner, is characterized by increasing the relative weights of more successful experts/stocks. Instead of targeting market and the best stock, algorithms in this category often aim to approach the BCRP strategy.</paragraph><paragraph>Cover [14] proposed the Universal Portfolios (UP) strategy. Formally, its update scheme is historical performance weighted average of all possible constant rebalanced portfolios in the entire simplex domain,{a mathematical formula} In detail, UP's initial portfolio {a mathematical formula}b1 is uniform over the market, and its {a mathematical formula}t+1st portfolio is historical performance weighted average of all CRP experts with {a mathematical formula}b∈Δm. Thus, UP's final cumulative wealth is uniform weighted average of all CRP experts' wealth, {a mathematical formula}Sn(UP)=∫ΔmSn(b)db. Intuitively, Cover's UP operates similar to a Fund of Fund (FOF), and its main idea is to buy and hold the parameterized CRP strategies over the simplex domain. The regret achieved by Cover's UP is {a mathematical formula}O(mlog⁡n), and UP's time complexity is {a mathematical formula}O(nm).</paragraph><paragraph>Helmbold et al. [37] proposed the Exponential Gradient (EG) strategy, which is based on the same algorithm for mixture estimation [36]. The strategy generally formulated as the following optimization problem,{a mathematical formula} where {a mathematical formula}R(b,bt) denotes a regularization term and {a mathematical formula}η&gt;0 denotes the learning rate. Straightforwardly, the optimization is to track last best stock and keep previous portfolio information via regularization. EG adopts relative entropy as its regularization term, that is, {a mathematical formula}R(b,bt)=∑i=1mbilog⁡bibt,i. EG's formulation is convex in b, however, it is hard to solve since log is nonlinear. Thus, the authors took the log function's first-order Taylor expansion at {a mathematical formula}bt, which is linear and straightforward to solve. With a stronger assumption of lower bound on the price relatives than Cover's UP, EG has a regret bound of {a mathematical formula}O(nlog⁡m) and a running time of {a mathematical formula}O(mn). In terms of length of trading periods (n), the regret is not as tight as Cover's UP,{sup:1} however, its linear time substantially surpasses UP.</paragraph><paragraph>Gaivoronski and Stella [24] proposed Successive Constant Rebalanced Portfolios (SCRP) for stationary markets. For each period, SCRP directly adopts the BCRP to date,{sup:2}{a mathematical formula} The authors further solved the optimal portfolio {a mathematical formula}bt⁎ via stochastic optimization [3], resulting in SCRP's portfolio updates [24, Algorithm 1]. Under stronger assumptions [24, Eqs. (16) &amp; (17)] than Cover's UP, the regret bound achieved by SCRP is {a mathematical formula}O(mlog⁡n). Gaivoronski and Stella [25] further proposed Adaptive Portfolio Selection (APS), which can handle three portfolio selection tasks, including adaptive Markowitz portfolio, log-optimal constant rebalanced portfolio, and index tracking.</paragraph><paragraph>Agarwal et al. [1] formulated the Online Newton Step (ONS) as{a mathematical formula} where β denotes a trade-off parameter and {a mathematical formula}R(b) is a regularization term on b. Note that all historical information is exploited by the first term, thus the regularization term only involves next portfolio. It then solves the optimization problem with L2-norm regularization via online convex optimization [57], [35], [33], [34]. Similar to regular offline Newton method, ONS' basic idea is to replace log term via its second-order Taylor expansion at {a mathematical formula}bt, and then solve for the closed form updates. ONS' regret bound is {a mathematical formula}O(mlog⁡n), which is the same to Cover's UP. Note that ONS requires stronger assumptions on the price relatives than Cover's UP. Since it iteratively updates the first and second order information, it costs {a mathematical formula}O(m3) per period, which is irrelevant to the number of past periods.</paragraph></section><section label="3.3"><section-title>Follow-the-Loser approaches</section-title><paragraph>The underlying assumption for the optimality of BCRP strategy is that asset returns are i.i.d. However, according to the related empirical financial studies [11], [13], real asset returns may not be i.i.d.{sup:3} and they may be systematic or predictable. Although Cover [14] proved that BCRP is able to achieve maximum performance theoretically, BCRP didn't achieve outstanding performance in backtests (cf., Table 6.), as empirical asset returns violate the i.i.d. assumption. While the Follow-the-Winner strategies asymptotically approach the growth rate of BCRP, they often perform worse than BCRP. On the contrary, strategies in this section, or the Follow-the-Loser approaches, assume that asset returns follow a property of mean reversion[6], [52], [47], which indicates that the well (poor)-performing assets will perform poor (well) in the subsequent periods. Rather than tracking the winners, the Follow-the-Loser approach is often characterized by transferring the wealth from winners to losers.</paragraph><paragraph>Borodin et al. [8] proposed a Follow-the-Loser strategy named Anti Correlation (Anticor). Rather than no distributional assumption like Cover's UP, Anticor assumes that market follows the mean reversion principle. To exploit the property, it statistically makes bets on the consistency of positive lagged cross-correlation and negative auto-correlation. Anticor calculates a cross-correlation matrix {a mathematical formula}Mcor between two specific market windows. Following the mean reversion principle, Anticor transfers weights from winning assets to losing assets, and the corresponding amounts are adjusted by the cross-correlation matrix.</paragraph><paragraph>Li et al. [46] proposed Passive Aggressive Mean Reversion (PAMR) strategy, which exploits the mean reversion property with the Passive Aggressive (PA) online learning [53], [17]. The main idea of PAMR is to design a loss function of {a mathematical formula}ℓϵ(b;xt) in order to reflect the mean reversion property, that is, if the expected return based on last price relative is larger than a pre-defined threshold, the loss will linearly increase; otherwise, the loss is zero. Based on the loss function, PAMR passively maintains last portfolio if the loss is zero, otherwise it aggressively approaches a new portfolio that can force the loss to zero. In summary, PAMR obtains the next portfolio via the following optimization,{a mathematical formula} Solving the optimization problem, PAMR has a clean closed form update scheme,{a mathematical formula} Since the authors ignored the non-negativity constraint of the portfolio in the derivation, they also added a simplex projection step [22]. The closed form update scheme clearly reflects mean reversion by transferring the wealth from poor performing assets to well performing assets.</paragraph><paragraph>Li et al. [45] proposed Confidence Weighted Mean Reversion (CWMR) algorithm to further exploit the second order portfolio information and the mean reversion trading idea via Confidence Weighted (CW) online learning [20], [19], [18], [21]. The basic idea of CWMR is to model the portfolio vector (not the price relative vector) as a multivariate Gaussian distribution with mean {a mathematical formula}μ∈Rm and the diagonal covariance matrix {a mathematical formula}Σ∈Rm×m, which has nonzero diagonal elements {a mathematical formula}σ2 and zero for off-diagonal elements. While the mean represents the knowledge for the portfolio, the diagonal covariance matrix term stands for the confidence we have in the corresponding portfolio mean. Then CWMR sequentially updates the mean and covariance matrix of the Gaussian distribution. In particular, CWMR keeps the next distribution close to the last distribution in terms of Kullback–Leibler divergence if the probability that a portfolio return is lower than ϵ is higher than a pre-defined threshold. In summary, CWMR formulates the optimization as follows:{a mathematical formula} The above optimization can be solved by turning it into convex optimization and deriving closed-form updates.</paragraph><paragraph>Similar to Anticor, both PAMR and CWMR's mean reversion nature makes it hard to obtain a meaningful theoretical regret bound. Empirical performance show that the two algorithms can outperform the state-of-the-art, including Anticor, which passively reverts to the mean. However, both PAMR and CWMR suffer from drawbacks in risk management since it suffers significant performance degradation if the underlying single period mean reversion fails to exist. Such drawback is clearly indicated by its performance in the DJIA dataset [7], [8], [46], and motivates the proposed new algorithms in this article. Finally, we note that an early short version of this work has been published in the conference proceedings of ICML [42], and a recent robust variant in this series was also published in IJCAI [39].</paragraph></section><section label="3.4"><section-title>Pattern-Matching based approaches</section-title><paragraph>Besides the two categories of Follow-the-Winner/Loser, another type of strategies may utilize both winners and losers, which is based on pattern matching. Based on nonparametric prediction [29], this category consists of several pattern-matching based investment strategies [27], [31], [30], [44], [28].</paragraph><paragraph>The Pattern-Matching based approaches [27] consist of two steps: (i) sample selection and (ii) portfolio optimization. The first sample selection step selects a subset C of trading days, which have similar historical price relatives and will be used to predict the next price relatives. After locating the similarity set, each sample price relative {a mathematical formula}xi,i∈C is assigned with a probability {a mathematical formula}Pi,i∈C. The portfolio optimization step learns an optimal portfolio based on the set:{a mathematical formula} where {a mathematical formula}U(⋅) is a specified utility function. One particular utility function is the log utility, which is always the default function. In case of empty similarity set, a uniform portfolio is adopted.</paragraph><section label="3.4.1"><section-title>Sample selection techniques</section-title><paragraph>The general idea is to select similar samples from historical price relatives by comparing the preceding market windows of two price relatives. Let us assume that we are locating the price relatives that are similar to next price relative {a mathematical formula}xt+1. The basic routine is to iterate all historic price relatives {a mathematical formula}xi,i=w+1,…,t and count {a mathematical formula}xi as one similar price relative, if the preceding market window {a mathematical formula}xi−wi−1 is similar to the latest market window {a mathematical formula}xt−w+1t. A set C is maintained to contain the indexes of similar price relatives. Note that market window is a {a mathematical formula}w×m-matrix and the similarity between two market windows is often calculated on the concatenated {a mathematical formula}w×m-vector.</paragraph><paragraph>Nonparametric histogram-based sample selection [29] pre-defines a set of discretized partitions, and partitions both market windows, and chooses the price relatives whose {a mathematical formula}xi−1i−w is in the same partition as {a mathematical formula}xt−w+1t. In particular, given a partition {a mathematical formula}P=Aj,j=1,2,…,d of {a mathematical formula}R+m into d disjoint sets and a corresponding discretization function {a mathematical formula}G(x)=j, we can define the similarity set as,{a mathematical formula} Nonparametric kernel-based sample selection [27] identifies the similarity set by comparing two market windows via Euclidean distance, that is,{a mathematical formula} where c and ℓ are the thresholds used to control the number of similar samples. Note that the authors adopted two threshold parameters for theoretical analysis. Nonparametric nearest neighbor-based sample selection [30] searches the price relatives whose preceding market windows are within the ℓ nearest neighbor of the latest market window in terms of Euclidean distance, that is,{a mathematical formula} where ℓ is a threshold parameter. Correlation-driven nonparametric sample selection [44] identifies the linear similarity among two market windows via correlation coefficient, that is,{a mathematical formula} where ρ is a pre-defined correlation coefficient threshold.</paragraph></section><section label="3.4.2"><section-title>Portfolio optimization techniques</section-title><paragraph>The second step of the Pattern-Matching based Approaches is to construct an optimal portfolio based on the similar set C. Two main approaches are Kelly's capital growth portfolio and Markowitz's mean variance portfolio.</paragraph><paragraph>Györfi et al. [27] proposed to figure out a log-optimal (Kelly) portfolio based on similar price relatives, which clearly follows the Capital Growth Theory. Given a similarity set, the log-optimal utility function is defined as,{a mathematical formula} where {a mathematical formula}Pi denotes the probability assigned to the similar price relative {a mathematical formula}xi,i∈C(x1t). Györfi et al. [27] assumes a uniform probability among the similar samples, thus it is equivalent to the following utility function,{a mathematical formula}</paragraph><paragraph>Besides the log-optimal portfolio optimization, other methods can also be adopted, such as semi-log-optimal portfolio [56], [31], Markowitz-type portfolio [51], and GV-type portfolio [32], which we do not detail here.</paragraph><paragraph>In any above procedure, if the similarity set is empty, we can choose either uniform portfolio or previous portfolio.</paragraph></section><section label="3.4.3"><section-title>Combinations</section-title><paragraph>In this section, we combine the first and second step and describe the algorithms using Pattern-Matching based approaches. Table 1 shows the existing combinations, where “–” indicates there is no algorithm for such combination.</paragraph><paragraph>One default utility function is the log-optimal function or the BCRP portfolio. Györfi and Schäfer [29] introduced the nonparametric histogram-based log-optimal investment strategy ({a mathematical formula}BH), which combines the histogram-based sample selection and log-optimal utility function and proved its universality. Györfi et al. [27] presented nonparametric kernel-based log-optimal investment strategy ({a mathematical formula}BK), which combines the kernel-based sample selection and log-optimal utility function and proved its universality. Györfi et al. [30] proposed nonparametric nearest neighbor log-optimal investment strategy ({a mathematical formula}BNN), which combines the nearest neighbor sample selection and log-optimal utility function and proved its universality. Li et al. [44] created correlation-driven nonparametric learning approach (CORN) by combining the correlation driven sample selection and log-optimal utility function and showed its superior empirical performance over previous three combinations. Besides the log-optimal utility function, several algorithms using different utility functions have been proposed. Györfi et al. [31] proposed nonparametric kernel-based semi-log-optimal investment strategy ({a mathematical formula}BS) by combining the kernel-based sample selection and semi-log-optimal utility function to ease the computation of ({a mathematical formula}BK). Ottucsák and Vajda [51] proposed nonparametric kernel-based Markowitz-type investment strategy ({a mathematical formula}BM) by combining the kernel-based sample selection and Markowitz-type utility function to make trade-offs between the return (mean) and risk (variance) of expected portfolio return. Györfi and Vajda [32] proposed nonparametric kernel-based GV-type investment strategy ({a mathematical formula}BGV) by combining the kernel-based sample selection and GV-type utility function to construct portfolios in case of transaction costs.</paragraph></section></section><section label="3.5"><section-title>Analysis of existing work</section-title><paragraph>Most existing on-line portfolio selection research grounds on the principle of Kelly investment [41], [10], [55], [23], that is, to maximize the expected log return of a portfolio. In particular, a portfolio manager first predicts {a mathematical formula}x˜t+1 in terms of k possible outcomes {a mathematical formula}x˜t+11,…,x˜t+1k associated with some distribution ({a mathematical formula}p1,…,pk). Note that each {a mathematical formula}x˜t+1i denotes one possible outcome, or a vector of individual price relative predictions. Then, the optimal portfolio is generated by maximizing the expected log return: {a mathematical formula}bt+1=arg⁡maxb∈Δm∑i=1kpilog⁡(b⋅x˜t+1i).</paragraph><paragraph>Based on different methods of predicting {a mathematical formula}x˜t+1i and {a mathematical formula}pi, most existing algorithms can be classified into three categories, excluding the BCRP strategy in hindsight. Table 2 summarizes their formulations and underlying predictions. Note that we have done some transformations but maintained their key ideas. We introduce them according to their empirical performance.</paragraph><paragraph>The first category, which consists of SCRP and ONS, assumes the predictions consist of all historical price relatives with uniform distribution.{sup:4} That is, it assumes that on period {a mathematical formula}t+1, price relative vector may be {a mathematical formula}xi with a probability of {a mathematical formula}1t, {a mathematical formula}i=1,…,t. In other words, this category aims to model the next price relatives as the average of all historical price relatives. The algorithms in this category all have theoretical regret bound and are universal. However, their empirical results show that such assumption may not be precise enough to model the market.</paragraph><paragraph>The second category mainly consists of the pattern matching-based algorithms. It models next price relatives as the average of a sampled set of similar price relatives. Denoting the similar index set as {a mathematical formula}Ct, it models the next price relative as {a mathematical formula}xi,i∈Ct with a uniform probability of {a mathematical formula}1|Ct|. The algorithms in this category (except CORN) have been proved universal consistency, and their empirical results show that such assumption can fit the market well.</paragraph><paragraph>The last category, including EG, PAMR and CWMR, assumes a single prediction with {a mathematical formula}100% probability, and considers their former histories by regularizing the previous {a mathematical formula}bt−1. In particular, EG assumes {a mathematical formula}x˜t+11=xt with {a mathematical formula}p1=100%,{sup:5} while PAMR and CWMR assume {a mathematical formula}x˜t+11=1xt with {a mathematical formula}p1=100%, which is in essence the mean reversion idea. Note that the formulations of PAMR and CWMR ignore log utility due to their single-value prediction and the consideration of convexity and computational issues.{sup:6} Though all three algorithms assume that all information is fully reflected by {a mathematical formula}xt, their performance diverges and supports that mean reversion may better fit the markets. On the one hand, even with a decent theoretical result, EG always performs far behind. On the other hand, though without theoretical guarantees, PAMR and CWMR always produce the best results in various real markets. However, PAMR and CWMR suffer from dramatic failures when such single-period mean reversion is not satisfied [46], which motivates our study.</paragraph></section></section><section label="4"><section-title>On-Line Moving Average Reversion</section-title><section label="4.1"><section-title>Motivation</section-title><paragraph>Empirical results [46], [45] show that mean reversion, which assumes poor stock will perform well in the subsequent periods, may better fit the markets. PAMR and CWMR can exploit the mean reversion property well and achieve excellent results on most datasets at the time, especially the NYSE benchmark dataset [14]. However, they rely on a simple assumption that the predicted price relative {a mathematical formula}x˜t+1 will be inversely proportional to last price relative {a mathematical formula}xt. In particular, they implicitly assume that next price {a mathematical formula}p˜t+1 will revert to last price {a mathematical formula}pt−1 as follows,{a mathematical formula}</paragraph><paragraph>Though empirically effective on most datasets, PAMR and CWMR's single-period assumption causes two potential problems. Firstly, both algorithms suffer from the frequently fluctuating raw prices, as they often contain a lot of noises. Second, their assumption of single-period mean reversion may not be satisfied in the real world. Even two consecutively declining price relatives, which are common, can fail both algorithms. One real example [46] is DJIA dataset [8], on which PAMR performs the worst among the state of the art. Thus, traders are more likely to predict prices using certain long-term values. Also on the DJIA dataset, Anticor, which exploits the multi-period statistical correlation, performs much better. However, as illustrated in Li et al. [46], [45], due to its heuristic nature, Anticor cannot fully exploit the mean reversion property. The two problems caused by the single-period assumption and Anticor's inability to fully exploit mean reversion call for a more powerful approach to effectively exploit mean reversion, especially in terms of multi-period.</paragraph><paragraph>Now let us see a classic example [15], [46] to illustrate the drawbacks of single-period mean reversion, as shown in Table 3. The toy market consists of cash and one volatile stock, which follows market sequence A. It is easy to prove that BCRP ({a mathematical formula}b=(12,12)) grows by a factor of {a mathematical formula}(98)n/2, while PAMR &amp; CWMR can grow by a better factor of {a mathematical formula}32×2(n−1)/2. Note that this virtual sequence essentially follows singe-period mean reversion, which perfectly fits with PAMR and CWMR's assumption. However, if market sequence does not satisfy such assumption, both PAMR and CWMR would fail badly. Let us extend the market sequence to a two-period reversion, that is, market sequence B. In such a market, BCRP can achieve the same growth as before. Contrarily, PAMR/CWMR can achieve a constant wealth of {a mathematical formula}32, which means no growth! This shows that PAMR and CWMR actually will fail on such markets. More generally, if we further extend the market sequence to k-period mean reversion, BCRP can still achieve the same growth, while PAMR &amp; CWMR will grow to {a mathematical formula}32×(12)(n−1)×(12−1k), which will definitely approach bankruptcy when {a mathematical formula}k≥3.</paragraph><paragraph>To better exploit the (multi-period) mean reversion property, we proposed a new type of algorithm, named On-Line Moving Average Reversion (OLMAR), for on-line portfolio selection. The essential idea is to exploit multi-period moving average (mean) reversion via powerful online machine learning. Rather than {a mathematical formula}p˜t+1=pt−1, OLMAR assumes that next price will revert to a Moving Average (MA), that is, {a mathematical formula}p˜t+1=MAt, where {a mathematical formula}MAt denotes the Moving Average (MA) at the end of tth period. In time series analysis, MA is typically used to smooth short-term price fluctuations and focuses on long-term trends. Thus it can solve the two drawbacks of existing mean reversion algorithms.</paragraph><paragraph>Without detailing the calculation,{sup:7} we list the growth of OLMAR in different toy markets in Table 3. Clearly, OLMAR performs much better than PAMR/CWMR in the scenarios of multi-period mean reversion, while performs poor in single-period reversion. Our further empirical analysis in Section 5 shows that the markets are more likely to follow multi-period reversion.</paragraph></section><section label="4.2"><section-title>Formulations</section-title><paragraph>In this article, we adopt two types of moving average. The first, so-called “Simple Moving Average” (SMA), truncates the historical prices via a window and calculates its arithmetical average,{a mathematical formula} where w denotes the window size. Although we can enlarge the window size such that SMA can cover more historical price relatives, the empirical evaluations in Section 5 show that generally their performance drops as the window size increases.</paragraph><paragraph>To consider entire price relatives rather than a window, the second type, “Exponential Moving Average” (EMA), adopts all historical prices, and each price is exponentially weighted,{a mathematical formula} where {a mathematical formula}α∈(0,1) denotes a decaying factor.</paragraph><paragraph>To this end, we can calculate the predicted price relative vector following the idea of so-called “Moving Average Reversion” (MAR). Based on the two types of moving average, we can infer two types of MAR,</paragraph><paragraph>Moving Average Reversion: MAR-1{a mathematical formula} where w is the window size and ⊗ denotes element-wise product.</paragraph><paragraph>Moving Average Reversion: MAR-2{a mathematical formula} where {a mathematical formula}α∈(0,1) denotes the decaying factor and the operations are all element-wise.</paragraph><paragraph>Based on the expected price relative vector in Eq. (1) and Eq. (2), OLMAR further adopts the idea of an effective online learning algorithm, that is, Passive Aggressive (PA) [17] learning, to exploit the moving average reversion. Generally proposed for classification, PA passively keeps the previous solution if the classification is correct, while aggressively approaches a new solution if the classification is incorrect. After formulating the proposed OLMAR optimization, we solve its closed form update and design the proposed algorithm.</paragraph><paragraph>The proposed formulation, OLMAR, is to exploit moving average reversion via online learning techniques [38]. The basic idea is to maximize the expected return {a mathematical formula}b⋅x˜t+1, and keep last portfolio information via a regularization term, using the online passive–aggressive learning method [17]. Thus, we follow the similar idea of PAMR [46] and formulate an optimization as,</paragraph><paragraph>Optimization Problem: OLMAR{a mathematical formula} Note that we adopt expected return instead of expected log return.{sup:8} According to Helmbold et al. [37], to solve the optimization with expected log return, one can adopt the first-order Taylor expansion, which is essentially linear.</paragraph><paragraph>The above formulation explicitly reflects the basic idea of the proposed OLMAR. On the one hand, if its constraint is satisfied, that is, the expected return is higher than a threshold, then the resulting portfolio equals to previous portfolio. On the other hand, if the constraint is not satisfied, then the formulation will figure out a new portfolio such that the expected return is higher than the threshold, while the new portfolio is not far from previous one.</paragraph><paragraph>Note that although OLMAR's formulation looks similar to that of PAMR, they have some essential differences. In particular, PAMR's key constraint is {a mathematical formula}b⋅xt≤ϵ, while OLMAR's key constraint is {a mathematical formula}b⋅x˜t≥ϵ. First, PAMR uses raw price relative ({a mathematical formula}xt), while OLMAR adopts the price relative calculated by following the moving average reversion principle ({a mathematical formula}x˜t). Second, their inequality signs (“≤” for PAMR, and “≥” for OLMAR) are different. The different signs will make their behaviors different, which distinguish the two algorithms. After making certain transformations, PAMR may be written in a similar form, as shown in Table 2. However, their prediction functions are different, that is, OLMAR adopts multi-period mean reversion, while PAMR exploits single-period mean reversion.</paragraph></section><section label="4.3"><section-title>Algorithm and analysis</section-title><paragraph>The above formulations are convex and thus can be solved by convex optimization techniques [9]. We now derive the OLMAR solutions in closed form and show its solution in Proposition 1.</paragraph><paragraph label="Proposition 1">The solution of OLMAR without considering the non-negativity constraint is{a mathematical formula}where{a mathematical formula}x¯t+1=1m(1⋅x˜t+1)denotes the average predicted price relative and{a mathematical formula}λt+1is the Lagrangian multiplier calculated as,{a mathematical formula}</paragraph><paragraph>Note that in the derivations we do not consider the non-negativity constraint following Helmbold et al. [37]. Thus, it is possible that the resulting portfolio goes out the portfolio simplex domain. To maintain a proper portfolio, we finally project the portfolio calculated according to the Propositions to the simplex domain.</paragraph><paragraph>To this end, we can design the proposed algorithms based on the propositions. The on-line portfolio selection procedure is illustrated in Algorithm 2, and the proposed OLMAR procedures are illustrated in Algorithm 3.</paragraph><paragraph>In the above algorithms, there are several important parameters, including window size w, reversion threshold ϵ, and decaying factor α. Our empirical observations of the parameter sensitivity evaluation in Section 5.6 show that the final performance could be sensitive to the parameter w. To alleviate the parameter sensitivity issue, we propose to explore the online expert strategy for combining the OLMAR experts using different parameters in order to smooth the final performance of the trading system. In particular, we propose to adopt the Buy and Hold (BAH) combination strategy [8], [27], [46], that is, for each period, we treat an individual OLMAR model with a specified parameter {a mathematical formula}w≥3 as an expert and combine multiple experts' portfolios weighted by their historical trading performance. We denote the expert algorithm as BAHW(OLMAR) with a parameter W denoting the maximum window size, that is, BAHW(OLMAR) combines {a mathematical formula}W−2 individual OLMAR experts with {a mathematical formula}w=3,…,W.</paragraph><paragraph>Remark on the OLMAR optimization. We note that it is generally difficult to directly solve the OLMAR optimization, as there is no closed form solution. To solve it efficiently, we decompose the optimization task into two-step optimizations:{a mathematical formula}{a mathematical formula} Helmbold et al. [37] also used a similar approach to solve the optimization of EG. Following Helmbold et al. [37], Eq. (3) ignores portfolio's non-negativity constraint ({a mathematical formula}b⪰0), and thus allows shorting, which is common in the portfolio studies [26]. Proposition 1 gives the solution to this optimization. Moreover, Eq. (4) projects the solution into the simplex domain to satisfy the constraint in Section 2.</paragraph><paragraph>Remark on the update strategy. The update of OLMAR is straightforward, that is,{a mathematical formula} Basically, the above update divides the assets into two subgroups based on the prediction average {a mathematical formula}x¯t+1. For the assets with predicted values higher than the average, OLMAR increases their proportions; for the others, OLMAR decreases their proportions. The transferred proportions are related to the surprise of the predictions over their average and the positive Lagrangian multiplier, λ. This is consistent with normal portfolio selection procedure, that is, to transfer the wealth to the assets with better prospects.</paragraph><paragraph>Remark on the time and space complexity. The time complexity of the proposed OLMAR algorithm is {a mathematical formula}O(mn), which is linear with respect to the number of assets m and the total number of trading periods n. The space complexity is also linear, namely, {a mathematical formula}O(m). Note that the normalization step can be done efficiently by adopting some fast implementation that runs in linear time [22]. Overall, the entire algorithm is easy to implement and efficient to run. To the best of our knowledge, OLMAR's linear running time is no worse than any existing algorithms.</paragraph></section></section><section label="5"><section-title>Experiments</section-title><paragraph>In this section, we will present an extensive set of empirical studies, including our experimental testbed, experimental protocols, comparison schemes, experimental results and detailed empirical analysis. All the source code and datasets for this work can be found in our website: http://OLPS.stevenhoi.org/OLMAR/.</paragraph><section label="5.1"><section-title>Experimental testbed on real data</section-title><paragraph>In our study, we focus on historical daily prices in stock markets,{sup:9} which are easy to obtain from public domains (such as Yahoo Finance and Google Finance{sup:10}), and thus publicly available to other researchers. Data from other types of markets, such as high frequency intra-day quotes and Forex markets, are either too expensive or hard to obtain and process, and thus may reduce the experimental reproducibility. Summarized in Table 4, we employ six real and diverse datasets from several financial markets.{sup:11}</paragraph><paragraph>The first dataset, “NYSE (O)”, is one “standard” dataset pioneered by Cover [14] and followed by others [37], [8], [1], [27], [30]. This dataset contains 5651 daily price relatives of 36 stocks{sup:12} in New York Stock Exchange (NYSE) for a 22-year period from Jul. 3rd 1962 to Dec. 31st 1984.</paragraph><paragraph>The second dataset is an extended version of the NYSE dataset. For consistency, we collected the latest data in New York Stock Exchange (NYSE) from Jan. 1st 1985 to Jun. 30th 2010, which consists of 6431 trading days. We denote this new dataset as “NYSE (N)”.{sup:13} Note that the new dataset consists of 23 stocks rather than previous 36 stocks owing to amalgamations and bankruptcies. All self-collected price relatives are adjusted for splits and dividends, which is consistent with the previous “NYSE (O)” dataset.</paragraph><paragraph>The third dataset “TSE” is collected by Borodin et al. [8], which consists of 88 stocks from Toronto Stock Exchange (TSE) containing price relatives of 1259 trading days, ranging from Jan. 4th 1994 to Dec. 31st 1998. The fourth dataset “SP500” is collected by Borodin et al. [8], which consists of 25 stocks with the largest market capitalizations in the 500 SP500 components. It ranges from Jan. 2nd 1998 to Jan. 31st 2003, containing 1276 trading days.</paragraph><paragraph>The fifth dataset is “MSCI”, which is a collection of global equity indices that constitute the MSCI World Index.{sup:14} It contains 24 indices that represent the equity markets of 24 countries around the world, and consists of a total of 1043 trading days, ranging from Apr. 1st 2006 to Mar. 31st 2010. The final dataset is the “DJIA” dataset [8], which consists of 30 Dow Jones composite stocks. DJIA contains 507 trading days, ranging from Jan. 14th 2001 to Jan. 14th 2003.</paragraph><paragraph>Unlike previous studies, the above testbed covers much longer trading periods from 1962 to 2010 and much more diversified markets, which enables us to examine the behaviors of the proposed strategies under different events and crises. For example, it covers several well-known events in the stock markets, such as dot-com bubble from 1995 to 2000 and subprime mortgage crisis from 2007 to 2009. The five stock datasets are mainly chosen to test the capability of the proposed algorithms on regional stock markets, while the index dataset aims to test their capability on global indices, which may be potentially applicable to “Fund on Fund” (FOF).{sup:15} As a remark, although we numerically test the proposed algorithms on stock and ETF markets, we note that the proposed strategy could be generally applied to any types of financial markets.</paragraph></section><section label="5.2"><section-title>Experimental setup and metrics</section-title><paragraph>In our experiments, we implement the proposed OLMAR, and its BAH version BAH(OLMAR). For OLMAR, we denote algorithms by their moving average calculation (MAR-1/2). For example, OLMAR-2 denotes the algorithm with MAR2 prediction. In all cases, we empirically set the parameters, that is, {a mathematical formula}ϵ=10 and {a mathematical formula}w=5, which provide a consistent results for OLMAR in all cases. For BAH(OLMAR), we set their maximum window size {a mathematical formula}W=30, resulting in 28 OLMAR experts with {a mathematical formula}w=3 to 30. In addition to the empirical selection of parameters, we also evaluate the parameter scalability of the two possible parameters in Section 5.6. Finally, we also refer the best performance (in hindsight) among the underlying experts of the BAH version, named MAX(OLMAR).</paragraph><paragraph>We adopt the most common metric, cumulative wealth, to primarily compare different trading strategies. In addition to the cumulative wealth, we also adopt annualized Sharpe Ratio (SR) to compare the performance of different trading algorithms. In general, higher values of the cumulative wealth and annualized Sharpe Ratio indicate better algorithms. Besides, we also adopt Maximum Drawdown (MDD) and Calmar Ratio (CR) for analyzing a strategy's downside risk. The lower the MDD values, the less the strategy's (downside) risk is. The higher the CR values, the better the strategy's (downside) risk-adjusted return is. We summarize them in Table 5.</paragraph><paragraph>Besides, we also introduce two practical issues in on-line portfolio selection, that is, margin buying and transaction costs, in Section 5.2.1, and further evaluate them in Section 5.7.</paragraph><section label="5.2.1"><section-title>Practical issues</section-title><paragraph>While our model in Section 2 is concise and not complicated to understand, it omits some practical issues in the industry. We shall now relax some constraints to address these issues.</paragraph><paragraph>In reality, an important and unavoidable issue is transaction cost, which includes the commission fees and taxes imposed by brokers and governments, during the rebalance activities.{sup:16} Note that the transaction cost is imposed by markets, and a portfolio's behavior cannot change the properties of transaction costs, such as commission rates or tax rates. To handle the issue, the first way, which is commonly adopted by existing strategies, is that a portfolio selection model doesn't take transaction cost into account, and the second way is to directly integrate the costs in the model [32]. In this article, we take the first way and adopt the proportional transaction cost model [4]. To be specific, rebalancing a portfolio incurs transaction costs on every buy and sell operation, based upon a transaction cost rate of {a mathematical formula}γ∈(0,1). At the beginning of period t, the portfolio manager rebalances his/her wealth to the new portfolio {a mathematical formula}bt, from last close price adjusted portfolio {a mathematical formula}bˆt−1, each component of which is calculated as {a mathematical formula}bˆt−1,i=bt−1,i⁎xt−1,ibt−1⊤xt−1. Such rebalance incurs a transaction cost of {a mathematical formula}γ2×∑i=1m|bt,i−bˆt−1,i|, where the initial portfolio is set to {a mathematical formula}(0,…,0). Thus, the cumulative wealth after n periods can be expressed as,{a mathematical formula}</paragraph><paragraph>Another practical issue is margin buying, which allows the portfolio managers to buy securities with cash borrowed from securities brokers, using their own equity positions as collateral. Following existing studies [14], [37], [1], we relax this constraint and evaluate it empirically. We assume the margin setting to be {a mathematical formula}50% down and {a mathematical formula}50% loan,{sup:17} at an annual interest rate of {a mathematical formula}6% (equivalently, the corresponding daily interest rate of borrowing, c, is set to 0.000238). With such a setting, a new asset named “margin component” is generated for each asset and its price relative for period t equals {a mathematical formula}2⁎xt,i−1−c. As a result, the total number of assets becomes 2m, when margin buying is allowed. Adding such “margin component”, we can magnify both the potential profit or loss on the ith asset.</paragraph></section></section><section label="5.3"><section-title>Comparison approaches</section-title><paragraph>We compare the proposed algorithms with a number of benchmarks and representative strategies introduced in Section 3. Below we summarize a list of compared algorithms, all of which provide extensive empirical evaluations in their respective studies. All parameters are set following their original studies.{sup:18} Focusing on empirical studies, we ignore certain algorithms that focus on theoretical analysis and lack thorough empirical evolutions.</paragraph><list><list-item label="1.">Market: Market strategy, that is, uniform Buy-And-Hold (BAH) strategy;</list-item><list-item label="2.">Best-Stock: Best stock in the market, which is a strategy in hindsight;</list-item><list-item label="3.">BCRP: Best Constant Rebalanced Portfolios strategy in hindsight;</list-item><list-item label="4.">UP: Cover's Universal Portfolios implemented according to Kalai and Vempala [40], where the parameters are set as {a mathematical formula}δ0=0.004, {a mathematical formula}δ=0.005, {a mathematical formula}m=100, and {a mathematical formula}S=500;</list-item><list-item label="5.">EG: Exponential Gradient algorithm with the best learning rate {a mathematical formula}η=0.05 as suggested by Helmbold et al. [37];</list-item><list-item label="6.">ONS: Online Newton Step with the parameters suggested by Agarwal et al. [1], that is, {a mathematical formula}η=0, {a mathematical formula}β=1, {a mathematical formula}γ=18;</list-item><list-item label="7.">Anticor: {a mathematical formula}BAH30(Anticor(Anticor)) as a variant of Anticor to smooth the performance, which achieves the best performance among the three solutions proposed by Borodin et al. [8];</list-item><list-item label="8.">{a mathematical formula}BK: Nonparametric kernel-based moving window strategy with {a mathematical formula}W=5, {a mathematical formula}L=10 and threshold {a mathematical formula}c=1.0, which has the best empirical performance according to Györfi et al. [27];</list-item><list-item label="9.">{a mathematical formula}BNN: Nonparametric nearest neighbor-based strategy with parameters {a mathematical formula}W=5, {a mathematical formula}L=10 and {a mathematical formula}pℓ=0.02+0.5ℓ−1L−1 as the authors suggested [30];</list-item><list-item label="10.">CORN: Correlation-driven nonparametric learning approaches [44] with parameters {a mathematical formula}W=5, {a mathematical formula}P=1, {a mathematical formula}ρ=0.1;</list-item><list-item label="11.">PAMR: Passive aggressive mean reversion [46] with parameters {a mathematical formula}ϵ=0.5;</list-item><list-item label="12.">CWMR: Confidence weighted mean reversion [45] algorithm (exact version) with {a mathematical formula}ϵ=0.5.</list-item></list></section><section label="5.4"><section-title>Experimental results — cumulative wealth</section-title><paragraph>Table 6 illustrates the main results of this study, that is, the cumulative wealth on the six datasets achieved by various approaches. The results clearly show that OLMAR achieves the best performance among all competitors. On the well-known benchmark NYSE (O) dataset, OLMAR significantly outperforms the state of the art; similar observations also appear on the successive NYSE (N) and other datasets. In addition, though most existing algorithms except Anticor perform bad on the DJIA dataset, OLMAR achieves the best performance, which validates the motivating idea of the proposed algorithm. Besides, the proposed OLMAR-2, which exploits exponential moving average, can further improve the performance, as it achieves the best performance on most datasets. Moreover, the MAXs in hindsight show that it is feasible to achieve better performance via effective expert combination. Finally, we list the t-test statistics [26] in Table 7, which validate that the achieved results are not due to luck, whose chances are at most 1.69% on the DJIA dataset, and at most 2.62% on the SP500 dataset. In a word, the proposed OLMAR can outperform the state of the art on the widely used datasets with a high confidence.</paragraph></section><section label="5.5"><section-title>Experimental results — risk-adjusted return</section-title><paragraph>We now evaluate the volatility risk and drawdown risk, and the risk-adjusted return in terms of annualized Sharpe ratio and Calmar ratio. Fig. 1 shows the evaluation results on the six datasets. In addition to the proposed algorithms, we also plot two benchmarks (Market and BCRP) and five state-of-the-art algorithms (Anticor, {a mathematical formula}BNN, CORN, PAMR and CWMR).</paragraph><paragraph>In the preceding results on cumulative wealth, we find that the proposed OLMAR achieves the highest cumulative return on most datasets. However, high return is associated with high risk, as no real financial instruments can guarantee high return without high risk. The volatility risk in Fig. 1(a) shows that the proposed method almost achieves the highest risk in terms of volatility risk on most datasets. In addition, the drawdown risk in Fig. 1(b) also shows that the proposed method also achieves high drawdown risk in most datasets. These results are not difficult to understand since high return is often associated with high risk.</paragraph><paragraph>To further evaluate the return and risk, we examine the risk-adjusted return in terms of annualized Sharpe ratio and Calmar ratio. Despite the high risk, OLMAR yields a highly competitive result of risk-adjusted return. The results in Fig. 1(c) and Fig. 1(d) clearly show that OLMAR is always among the tops in most cases, including DJIA dataset. These encouraging results show that the proposed method is able to reach a good trade-off between return and risk, even though we do not explicitly consider risk in our method formulation.</paragraph></section><section label="5.6"><section-title>Parameter sensitivity</section-title><paragraph>Now we evaluate OLMAR's sensitivity to its parameters, that is, ϵ for both OLMAR-1 and OLMAR-2, and w and α for OLMAR-1 and OLMAR-2, respectively. Fig. 2 shows OLMAR-1's sensitivity of ϵ with fixed {a mathematical formula}w=5 and Fig. 3 shows its sensitivity of w with fixed {a mathematical formula}ϵ=10. Since OLMAR-2 and OLMAR-1 have the similar figures for ϵ, we only list its effect on OLMAR-1. Fig. 4 shows OLMAR-2's sensitivity of α with fixed {a mathematical formula}ϵ=10.</paragraph><paragraph>From Fig. 2, we can observe that in general the cumulative wealth sharply increases if ϵ approaches 1 and flattens if ϵ crosses a threshold. From Fig. 3, we can see that as w increases, the performance initially increases, spikes at a data-dependant value, and then decreases. Its performance with most choices of ϵ and w have much better performance than market and BCRP. To smooth the volatility of its performance, Fig. 3 also shows its Buy and Hold versions [42] by combining a set of OLMAR experts with varying ws. As we can see that the BAH version provides a much more smoother cumulative return than its underlying experts. Note that on DJIA, OLMAR performs much better than PAMR/CWMR as ϵ varies, which validates the motivating multi-period mean reversion. From Fig. 4, we can find that on most datasets, α provides significant high cumulative wealth in a wide range of values, except the two extreme endpoints, that is, 0 and 1. If {a mathematical formula}α=1, then all expected price relatives are always 1 and OLMAR-2 outputs {a mathematical formula}bt+1=bt, which is initialized to uniform portfolio. If {a mathematical formula}α=0, then its expected price relative vector equals {a mathematical formula}x˜t+1=1⨂i=1txi. Such price relatives inversely relate to asset's all historical price relatives, and produce bad results.</paragraph><paragraph>As a summary, OLMARs' performance is insensitive to ϵ and thus it is easy to choose appropriate values of ϵ. On the other hand, OLMARs' performance is sensitive to w. However, as shown in the figure, we can combine multiple OLMARs with different {a mathematical formula}w&lt;W such that the combined version is insensitive to w, and then we can easily choose a proper value of W.</paragraph></section><section label="5.7"><section-title>Practical performance under transaction cost and margin buying</section-title><paragraph>To evaluate the practical applicability, we firstly evaluate the performance of the proposed algorithms with respect to proportional transaction cost [8]. Fig. 5 illustrates the cumulative wealth achieved by OLMAR with increasing transaction cost rate γ, and also the results obtained by six representative algorithms (two benchmarks and four state of the art). On the one hand, the results clearly show that OLMAR can withstand reasonable transaction costs, as it often has high break-even rates with respect to the market. On the other hand, OLMAR can outperform the benchmarks and state of the art, under various transaction cost rates. In a word, OLMAR performs excellent when trading is not frictionless, supporting its practical applicability.</paragraph><paragraph>Second, margin buying is another practical concern for a real-world portfolio selection task. Theoretically, each algorithm still has the opportunity to trade without using margin, so it shouldn't perform particularly worse with an increase in the available set of actions. But, in online learning context, increasing the set of hypotheses can hurt regret (and hence performance), though only slightly. To evaluate the impact of margin buying, we adopt the model described in Section 5.2.1, and present the cumulative wealth achieved by the competing approaches with/without margin buying in Table 8. The results clear show that if margin buying is allowed, the profitability of the proposed algorithms on most datasets increases. Similar to the results without margin buying, the proposed OLMAR algorithm often achieves the best results with margin buying. In summary, the proposed strategy can be extended to handle margin buying issue and benefit from it, and thus are practical applicable.</paragraph></section><section label="5.8"><section-title>Evaluation of computational time cost</section-title><paragraph>Finally, we evaluate the computational time cost of the proposed algorithm. Table 9 shows their running time across six different datasets. Note that we only list the computational times of methods with comparable performance. As theoretically analyzed in Section 4.3, OLMAR enjoys linear computational time complexity. Empirically, as shown in the table, OLMAR algorithm takes the least time cost on all datasets. Note that with daily frequency, competitors' average times are acceptable. However, their times are not acceptable in the scenario of high frequency trading [2]. Such time efficiency supports OLMAR's large-scale real applications.</paragraph></section></section><section label="6"><section-title>Discussions and threats to validity</section-title><paragraph>Without theoretical guarantee, the empirical assumptions in Section 2 are worth inspecting, as done by all existing heuristic algorithms [8], [44], [46], [45]. As evaluated in Section 5.7, OLMAR can withstand reasonable rates of transaction cost. Note that the transaction cost rate in real market is low,{sup:19} and there exists various methods to reduce the rate for institutional investors. All the datasets are composed of the largest index composite stocks, which have the highest market liquidity. To limit market impact when portfolio is too big, one solution is to scale-down the portfolio, as done by several quantitative funds. Here, we emphasize again that even in such a “perfect market”, no algorithm has ever claimed such good performance.</paragraph><paragraph>Backtests in historical markets may suffer from “data-snooping bias” issues, one of which is the dataset selection issue. Note that we selected all datasets based on previous studies without consideration to the proposed approaches. However, even we are cautious about the dataset selection issue, it may still appear in the experiments, especially for the datasets with relatively long history, that is, NYSE (O) and NYSE (N). Although they provide fair comparison for different algorithms, they are worse than others in terms of survival bias. In a word, even though the empirical results on these datasets clearly show the effectiveness of the proposed algorithms, one cannot make claims without noticing the deficiencies of these datasets. Another common bias is asset selection issue. We try to avoid the asset selection bias via arbitrarily choosing some representative stocks in their respective markets, which usually have large capitalization and high liquidity and thus reduce the market impact caused by any proposed portfolio strategy.</paragraph></section><section label="7"><section-title>Conclusions</section-title><paragraph>This paper investigated the on-line portfolio selection problem and presented a novel strategy named “On-Line Moving Average Reversion” (OLMAR), which exploits “Moving Average Reversion” using on-line machine learning algorithms. The proposed approach is able to overcome the limitations of the existing state-of-the-art mean reversion strategies mainly due to the single-period assumption, and achieve fairly encouraging results on several datasets from real-world financial markets. Last but not least, the proposed algorithm runs extremely fast and is thus suitable for large-scale real-world financial applications. Despite achieving encouraging empirical results, several open issues are worth further exploration in future work. First of all, it will be interesting to explore theoretical analysis of the mean reversion property and investigate if it is possible to bound the worst-case performance of OLMAR. Besides, it may be possible to anatomize the portfolio's expected return to better understand the major sources of profit. Although pure trading strategies have been commonly anatomized{sup:20} in the finance fields [12] for a long time, on-line portfolio selection algorithms have seldom been anatomized in a systematic way, which certainly is worth further investigations.</paragraph><section-title>Acknowledgements</section-title></section></content><acknowledgements><paragraph>We want to thank the associate editor and anonymous reviewers for their helpful comments and suggestions. This work was in part supported by the National Natural Science Foundation of China (71401128) and “the Fundamental Research Funds for the Central Universities”, and the tier-1 research grant of Singapore Management University.</paragraph></acknowledgements><appendices><section label="Appendix A">Proof of Proposition 1<paragraph label="Proof">Since introducing nonnegative constraint of the simplex constraint causes much difficulty [37], at first we do not consider it and finally project on the simplex domain.The Lagrangian of optimization problem OLMAR is{a mathematical formula} where {a mathematical formula}λ≥0 and η are the Lagrangian multipliers. Taking the gradient with respect to b and setting it to zero, we get,{a mathematical formula} multiplying both sides by {a mathematical formula}1⊤, we get,{a mathematical formula} where {a mathematical formula}x¯t+1 denotes the average predicted price relative (market). Plugging the above equation to the update of b, we get the update of b,{a mathematical formula} To solve the Lagrangian multiplier, let us plug above equation to the Lagrangian,{a mathematical formula} Taking derivative with respect to λ and setting it to zero, we get{a mathematical formula} Further projecting the λ to {a mathematical formula}[0,+∞), we get,{a mathematical formula}  □</paragraph></section></appendices><references><reference label="[1]"><authors>A. Agarwal,E. Hazan,S. Kale,R.E. Schapire</authors><title>Algorithms for portfolio management based on the Newton method</title><host>Proceedings of International Conference on Machine Learning(2006)</host></reference><reference label="[2]"><authors>I. Aldridge</authors><title>High-Frequency Trading: A Practical Guide to Algorithmic Strategies and Trading Systems</title><host>(2010)WileyHoboken, NJ</host></reference><reference label="[3]"><authors>J.R. Birge,F. Louveaux</authors><title>Introduction to Stochastic Programming</title><host>(1997)SpringerNew York</host></reference><reference label="[4]"><authors>A. Blum,A. Kalai</authors><title>Universal portfolios with and without transaction costs</title><host>Mach. Learn.35 (3)(1999) pp.193-205</host></reference><reference label="[5]"><authors>A. Blum,Y. Mansour</authors><title>From external to internal regret</title><host>J. Mach. Learn. Res.8 (2007) pp.1307-1324</host></reference><reference label="[6]"><authors>W.F.M.D. Bondt,R. Thaler</authors><title>Does the stock market overreact?</title><host>J. Finance40 (3)(1985) pp.793-805</host></reference><reference label="[7]"><authors>A. Borodin,R. El-Yaniv,V. Gogan</authors><title>Can we learn to beat the best stock</title><host>Proceedings of the Annual Conference on Neural Information Processing Systems(2003)</host></reference><reference label="[8]"><authors>A. Borodin,R. El-Yaniv,V. Gogan</authors><title>Can we learn to beat the best stock</title><host>J. Artif. Intell. Res.21 (2004) pp.579-594</host></reference><reference label="[9]"><authors>S. Boyd,L. Vandenberghe</authors><title>Convex Optimization</title><host>(2004)Cambridge University PressNew York</host></reference><reference label="[10]"><authors>L. Breiman</authors><title>Optimal gambling systems for favorable games</title><host>Proceedings of the Berkeley Symposium on Mathematical Statistics and Probabilityvol. 1 (1961) pp.65-78</host></reference><reference label="[11]"><authors>J.Y. Campbell,A.W. Lo,A.C. Mackinlay</authors><title>The Econometrics of Financial Markets</title><host>(1996)Princeton University PressPrinceton, NJ</host></reference><reference label="[12]"><authors>J. Conrad,G. Kaul</authors><title>An anatomy of trading strategies</title><host>Rev. Financ. Stud.11 (3)(1998) pp.489-519</host></reference><reference label="[13]"><authors>R. Cont</authors><title>Empirical properties of asset returns: stylized facts and statistical issues</title><host>Quant. Finance1 (2)(2001) pp.223-236</host></reference><reference label="[14]"><authors>T.M. Cover</authors><title>Universal portfolios</title><host>Math. Finance1 (1)(1991) pp.1-29</host></reference><reference label="[15]"><authors>T.M. Cover,D.H. Gluss</authors><title>Empirical Bayes stock market portfolios</title><host>Adv. Appl. Math.7 (2)(1986) pp.170-181</host></reference><reference label="[16]"><authors>T.M. Cover,J.A. Thomas</authors><title>Elements of Information Theory</title><host>(1991)WileyNew York</host></reference><reference label="[17]"><authors>K. Crammer,O. Dekel,J. Keshet,S. Shalev-Shwartz,Y. Singer</authors><title>Online passive–aggressive algorithms</title><host>J. Mach. Learn. Res.7 (2006) pp.551-585</host></reference><reference label="[18]"><authors>K. Crammer,M. Dredze,A. Kulesza</authors><title>Multi-class confidence weighted algorithms</title><host>Proceedings of the Conference on Empirical Methods in Natural Language Processing(2009)</host></reference><reference label="[19]"><authors>K. Crammer,M. Dredze,F. Pereira</authors><title>Exact convex confidence-weighted learning</title><host>Proceedings of Annual Conference on Neural Information Processing Systems(2008)</host></reference><reference label="[20]"><authors>M. Dredze,K. Crammer,F. Pereira</authors><title>Confidence-weighted linear classification</title><host>Proceedings of International Conference on Machine Learning(2008)</host></reference><reference label="[21]"><authors>M. Dredze,A. Kulesza,K. Crammer</authors><title>Multi-domain learning by confidence-weighted parameter combination</title><host>Mach. Learn.79 (1–2)(2010) pp.123-149</host></reference><reference label="[22]"><authors>J. Duchi,S. Shalev-Shwartz,Y. Singer,T. Chandra</authors><title>Efficient projections onto the l1-ball for learning in high dimensions</title><host>Proceedings of International Conference on Machine Learning(2008)</host></reference><reference label="[23]"><authors>M. Finkelstein,R. Whitley</authors><title>Optimal strategies for repeated games</title><host>Adv. Appl. Probab.13 (2)(1981) pp.415-428</host></reference><reference label="[24]"><authors>A.A. Gaivoronski,F. Stella</authors><title>Stochastic nonstationary optimization for finding universal portfolios</title><host>Ann. Oper. Res.100 (2000) pp.165-188</host></reference><reference label="[25]"><authors>A.A. Gaivoronski,F. Stella</authors><title>On-line portfolio selection using stochastic programming</title><host>J. Econ. Dyn. Control27 (6)(2003) pp.1013-1043</host></reference><reference label="[26]"><authors>R. Grinold,R. Kahn</authors><title>Active Portfolio Management: A Quantitative Approach for Producing Superior Returns and Controlling Risk</title><host>(1999)McGraw-HillNew York</host></reference><reference label="[27]"><authors>L. Györfi,G. Lugosi,F. Udina</authors><title>Nonparametric kernel-based sequential investment strategies</title><host>Math. Finance16 (2)(2006) pp.337-357</host></reference><reference label="[28]"><authors>L. Györfi,G. Ottucsák,H. Walk</authors><title>Machine Learning for Financial Engineering</title><host>(2012)World ScientificSingapore</host></reference><reference label="[29]"><authors>L. Györfi,D. Schäfer</authors><title>Nonparametric prediction</title><host>Advances in Learning Theory: Methods, Models and Applications(2003)IOS PressNetherlands</host></reference><reference label="[30]"><authors>L. Györfi,F. Udina,H. Walk</authors><title>Nonparametric nearest neighbor based empirical portfolio selection strategies</title><host>Stat. Decis.26 (2)(2008) pp.145-157</host></reference><reference label="[31]"><authors>L. Györfi,A. Urbán,I. Vajda</authors><title>Kernel-based semi-log-optimal empirical portfolio selection strategies</title><host>Int. J. Theor. Appl. Finance10 (3)(2007) pp.505-516</host></reference><reference label="[32]"><authors>L. Györfi,I. Vajda</authors><title>Growth optimal investment with transaction costs</title><host>Proceedings of the International Conference on Algorithmic Learning Theory(2008)</host></reference><reference label="[33]">E. HazanEfficient algorithms for online convex optimization and their applicationsPh.D. thesis<host>(2006)Princeton University</host></reference><reference label="[34]"><authors>E. Hazan,A. Agarwal,S. Kale</authors><title>Logarithmic regret algorithms for online convex optimization</title><host>Mach. Learn.69 (2–3)(2007) pp.169-192</host></reference><reference label="[35]"><authors>E. Hazan,A. Kalai,S. Kale,A. Agarwal</authors><title>Logarithmic regret algorithms for online convex optimization</title><host>Proceedings of the Annual Conference on Learning Theory(2006)</host></reference><reference label="[36]"><authors>D.P. Helmbold,R.E. Schapire,Y. Singer,M.K. Warmuth</authors><title>A comparison of new and old algorithms for a mixture estimation problem</title><host>Mach. Learn.27 (1)(1997) pp.97-119</host></reference><reference label="[37]"><authors>D.P. Helmbold,R.E. Schapire,Y. Singer,M.K. Warmuth</authors><title>On-line portfolio selection using multiplicative updates</title><host>Math. Finance8 (4)(1998) pp.325-347</host></reference><reference label="[38]"><authors>S.C.H. Hoi,J. Wang,P. Zhao</authors><title>Libol: a library for online learning algorithms</title><host>J. Mach. Learn. Res.15 (2014) pp.495-499</host><host>http://LIBOL.stevenhoi.org/</host></reference><reference label="[39]"><authors>D. Huang,J. Zhou,B. Li,S.C.H. Hoi,S. Zhou</authors><title>Robust median reversion strategy for on-line portfolio selection</title><host>Proceedings of the Twenty-Third International Joint Conference on Artificial Intelligence(2013)AAAI Press pp.2006-2012</host></reference><reference label="[40]"><authors>A. Kalai,S. Vempala</authors><title>Efficient algorithms for universal portfolios</title><host>J. Mach. Learn. Res.3 (2002) pp.423-440</host></reference><reference label="[41]"><authors>J. KellyJr.</authors><title>A new interpretation of information rate</title><host>Bell Syst. Tech. J.35 (1956) pp.917-926</host></reference><reference label="[42]"><authors>B. Li,S.C.H. Hoi</authors><title>On-line portfolio selection with moving average reversion</title><host>Proceedings of the International Conference on Machine Learning(2012)</host></reference><reference label="[43]"><authors>B. Li,S.C.H. Hoi</authors><title>Online portfolio selection: a survey</title><host>ACM Comput. Surv.36 (2014) pp.35-</host></reference><reference label="[44]"><authors>B. Li,S.C.H. Hoi,V. Gopalkrishnan</authors><title>Corn: correlation-driven nonparametric learning approach for portfolio selection</title><host>ACM Trans. Intell. Syst. Technol.2 (3)(2011) pp.21-</host></reference><reference label="[45]"><authors>B. Li,S.C.H. Hoi,P. Zhao,V. Gopalkrishnan</authors><title>Confidence weighted mean reversion strategy for on-line portfolio selection</title><host>ACM Trans. Knowl. Discov. Data7 (Mar. 2013) pp.4-</host></reference><reference label="[46]"><authors>B. Li,P. Zhao,S.C.H. Hoi,V. Gopalkrishnan</authors><title>Pamr: passive aggressive mean reversion strategy for portfolio selection</title><host>Mach. Learn.87 (2)(2012) pp.221-258</host></reference><reference label="[47]"><authors>A.W. Lo,A.C. MacKinlay</authors><title>When are contrarian profits due to stock market overreaction?</title><host>Rev. Financ. Stud.3 (2)(1990) pp.175-205</host></reference><reference label="[48]"><authors>H. Markowitz</authors><title>Portfolio selection</title><host>J. Finance7 (1)(1952) pp.77-91</host></reference><reference label="[49]">E. OrdentlichUniversal investment and universal data compressionPh.D. thesis<host>(1996)Stanford University</host></reference><reference label="[50]"><authors>E. Ordentlich</authors><title>Universal Portfolios</title><host>(2010)John Wiley &amp; Sons, Ltd.</host></reference><reference label="[51]"><authors>G. Ottucsák,I. Vajda</authors><title>An asymptotic analysis of the mean-variance portfolio selection</title><host>Stat. Decis.25 (2007) pp.63-88</host></reference><reference label="[52]"><authors>J.M. Poterba,L.H. Summers</authors><title>Mean reversion in stock prices: evidence and implications</title><host>J. Financ. Econ.22 (1)(1988) pp.27-59</host></reference><reference label="[53]"><authors>S. Shalev-Shwartz,K. Crammer,O. Dekel,Y. Singer</authors><title>Online passive–aggressive algorithms</title><host>Proceedings of the Annual Conference on Neural Information Processing Systems(2003)</host></reference><reference label="[54]"><authors>G. Stoltz,G. Lugosi</authors><title>Internal regret in on-line portfolio selection</title><host>Mach. Learn.59 (1–2)(2005) pp.125-159</host></reference><reference label="[55]"><authors>E.O. Thorp</authors><title>Portfolio choice and the Kelly criterion</title><host>Business and Economics Section of the American Statistical Association(1971)</host></reference><reference label="[56]"><authors>I. Vajda</authors><title>Analysis of semi-log-optimal investment strategies</title><host>Proceedings of Prague Stochastic(2006)</host></reference><reference label="[57]"><authors>M. Zinkevich</authors><title>Online convex programming and generalized infinitesimal gradient ascent</title><host>Proceedings of the International Conference on Machine Learning(2003)</host></reference></references><footnote><note-para label="1">The EG approach has a better dependence on the number of assets, m.</note-para><note-para label="2">Ordentlich [49, Chapter 4.4] briefly mentioned a similar idea.</note-para><note-para label="3">The related test is refer to the test of “Random Walk 1”. For the test hypothesis and some existing evidences, please refer to Campbell et al. [11, Chapter 2]. There also exist a set of stylized facts or patterns of asset returns, please refer to Cont [13].</note-para><note-para label="4">This characterization is in the view of the authors. In the online learning community in general, “risk empirical risk minimization” is a good strategy for the “online convex optimization” problems. Such characterization also occurs on the below categories.</note-para><note-para label="5">But this does not mean that EG is forgetful. The former history is built into the vector of {a mathematical formula}bt−1 and the algorithm is designed to regularize from the previous solution.</note-para><note-para label="6">PAMR &amp; CWMR's formulations with log utility function make their optimization formulations non-convex and hard to solve. As done by Helmbold et al. [37], such formulation is often solved with linear approximation, which thus becomes the version without log utility. That is, as {a mathematical formula}log⁡(b⋅xt)≈log⁡(bt⋅xt)+xtbt⋅xt⋅(b−bt), minimizing {a mathematical formula}log⁡(b⋅xt) is often solved by minimizing {a mathematical formula}b⋅xt, which is convex and easy to solve. Please find the details in their respective studies. For the same reason, this article also ignores the log utility.</note-para><note-para label="7">We calculate OLMAR's growth using Algorithm 3, which will finally stabilize.</note-para><note-para label="8">With log function, the empirical performance does not make too much difference.</note-para><note-para label="9">We did evaluate certain algorithms using high frequency data and weekly data, as in Li et al. [45].</note-para><note-para label="10">Yahoo Finance: http://finance.yahoo.com; Google Finance: http://www.google.com/finance.</note-para><note-para label="11">All related codes and the datasets, including their compositions, are available on http://www.cais.ntu.edu.sg/~chhoi/olps. Borodin et al.'s [8] datasets (NYSE (O), TSE, SP500, DJIA) are available on http://www.cs.technion.ac.il/~rani/portfolios/.</note-para><note-para label="12">According to Helmbold et al. [37], the dataset was originally collected by Hal Stern. The stocks are mainly large cap stocks in NYSE, however, we do no know the criteria of choosing these stocks.</note-para><note-para label="13">The dataset before 2007 was collected by Gábor Gelencsér (http://www.cs.bme.hu/~oti/portfolio), we collected the remaining data from 2007 to 2010 via Yahoo Finance.</note-para><note-para label="14">The constituents of MSCI World Index are available on MSCI Barra (http://www.mscibarra.com), accessed on 28 May 2010.</note-para><note-para label="15">Note that not every index is tradable through Exchange Traded Funds (ETFs).</note-para><note-para label="16">Besides commission and taxes, some other factors, such as bid-ask spreads, also implicitly incur transaction costs to a portfolio.</note-para><note-para label="17">That is, if one has $100 stock (down or collateral), he/she can at most borrow $100 cash (loan).</note-para><note-para label="18">We can tune their parameters for better performance, but it is beyond the scope of this article.</note-para><note-para label="19">For example, without considering taxes and bid-ask, Interactive Broker (www.interactivebrokers.com) charges 0.005$ per share. Since the average price of Dow Jones Composites is around 50$ (Accessed on June 2011), the transaction cost rate is about {a mathematical formula}0.01%.</note-para><note-para label="20">In finance, the term “anatomy” means investigating the sources of a strategy's profit.</note-para></footnote></root>