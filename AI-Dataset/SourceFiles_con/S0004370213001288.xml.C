<?xml version="1.0" encoding="utf-8"?>
<html>
 <body>
  <root>
   <title>
    The complexity of manipulative attacks in nearly single-peaked electorates.
   </title>
   <abstract>
    Many electoral control and manipulation problems—which we will refer to in general as “manipulative actions” problems—are NP-hard in the general case. It has recently been noted that many of these problems fall into polynomial time if the electorate is single-peaked, i.e., is polarized along some axis/issue. However, real-world electorates are not truly single-peaked. There are usually some mavericks, and so real-world electorates tend merely to be nearly single-peaked. This paper studies the complexity of manipulative-action algorithms for elections over nearly single-peaked electorates. We do this for many notions of nearness and for a broad range of election systems. We provide instances where even one maverick jumps the manipulative-action complexity up to NP-hardness, but we also provide many instances where some number of mavericks can be tolerated without increasing the manipulative-action complexity.
   </abstract>
   <content>
    <section label="1">
     <section-title>
      Introduction
     </section-title>
     <paragraph>
      Elections are a model of collective decision-making so central in human and multiagent-systems contexts—ranging from planning to collaborative filtering to reducing web spam—that it is natural to want to get a handle on the computational difficulty of finding whether manipulative actions can obtain a given outcome (see the surveys [36], [12]). A recent line of work [64], [40], [10] started by Walsh [64] has looked at the extent to which NP-hardness results for the complexity of manipulative actions (bribery, control, and manipulation) may evaporate when one focuses on electorates that are (unidimensional) single-peaked, a central social-science model of electoral behavior. That model basically views society as polarized along some (perhaps hidden) issue or axis.
     </paragraph>
     <paragraph>
      However, real-world elections are unlikely to be perfectly single-peaked. Rather, they are merely very close to being single-peaked, a notion that was recently raised in a computational context by Conitzer [15] and Escoffier et al. [32]. There will almost always be a few mavericks, whose vote is based on some reason having nothing to do with the societal axis. For example, in recent US presidential primary and final elections, commentators discussed whether some voters might vote not based on the political positioning of the candidates but rather based on the candidatesʼ religion or race. In this paper, we study whether the evaporation of complexity results that often holds for single-peaked electorates will also occur in nearly single-peaked electorates. We prove that often the answer is yes, and sometimes the answer is no.
     </paragraph>
     <paragraph>
      Among the contributions of our paper are the following.
     </paragraph>
     <list>
      <list-item label="1.">
       A collection of votes is said to be single-peaked if all the votes respect—i.e., are consistent with, in a sense we will rigorously define later—some societal axis. We classify and quantify four natural notions of nearness to single-peakedness for elections. The four notions are the following: (a) we allow some number of “maverick” voters, whose preferences need not respect the societal axis, (b) all voters must be consistent with the societal order when we disregard each voterʼs top preferred candidate (that is, each voter may have “swooned” regarding his or her top choice), (c) every vote is within a small number of adjacent-candidate swaps of respecting the societal order, and (d) all the votes are consistent with some axis, but that axis may be one that is not the societal axis but rather is within a small number of adjacent-candidates swaps of the original axis. For each of these notions we show how, given the societyʼs axis, to compute in polynomial time how much the voters diverge from single-peakedness according to that notion.{sup:1}
      </list-item>
      <list-item label="2.">
       We establish the complexity of coalitional weighted manipulation under 3-candidate scoring protocols for nearly single-peaked elections. As summarized in Table 1 on page 79, we show that even a very slight deviation from single-peakedness, under any of our four distance models, can raise the manipulation complexity from P, which is what holds in the (perfectly) single-peaked case, to being just as hard as in the case of unrestricted preferences. Moving beyond three candidates, we extend our study of manipulation to m-candidate veto, for each m. As reflected in Table 2 on page 79, Theorem 5.3, Theorem 5.4 establish a tight relationship between m and the amount of divergence from single-peakedness that can be handled in polynomial time.
      </list-item>
      <list-item label="3.">
       We show, in all but one of the cases that we study, that the complexity of control problems for plurality, k-approval, and approval elections that are nearly single-peaked is the same as the control complexity for elections where the voters are (perfectly) single-peaked. For the only case (control by deleting voters under t-approval elections and swoon-SP societies; see Section 4 for the definitions) in which we do not reach the same result as for the case of single-peaked elections (i.e., where we do not obtain a polynomial-time algorithm), we construct a good polynomial-time approximation algorithm. Our results on this are summarized in Table 3 on page 82.
      </list-item>
     </list>
     <paragraph>
      This paper touches on control and manipulation, discusses various election systems and notions of nearness to single-peakedness, and gives both polynomial-time attack results and NP-hardness results. It thus is not surprising that the proofs vary broadly in their techniques and approaches; we have no single approach that covers this entire range of cases.
     </paragraph>
     <paragraph>
      The paper is organized as follows. Section 2 discusses related literature. Section 3 provides basic definitions regarding elections and the complexity of manipulating them. Section 4 defines what we mean by societies being nearly single-peaked and provides basic results and observations regarding our notions, justifying various modeling choices; some discussion related to this also can be found in the Related Work section. Section 4 also discusses median voting. Section 5 discusses the issue of manipulation in nearly-single peaked societies. Section 6 studies the extent to which nearness to single-peakedness affects the complexity of control problems. Section 7 provides conclusions and discusses some open problems.
     </paragraph>
    </section>
    <section label="2">
     <section-title>
      Related work
     </section-title>
     <paragraph>
      Although it has roots going even further back, the study of the computational complexity of control and manipulation actions was started by a series of papers of Bartholdi, Orlin, Tovey, and Trick around 1990 [4], [2], [5]. The complexity of bribery—which is mentioned only in passing in the present paper—was first studied by Faliszewski et al. [33]. For further references, history, context, discussions, and results regarding these three types of manipulative actions, see the surveys [34], [36]. For example, it is known that there exist election systems that are resistant to many control attacks [29], [26], [30], [35], [49].
     </paragraph>
     <paragraph>
      The four papers most related to the present one are the following. Walsh [64] insightfully raised the idea that general complexity results may change in single-peaked societies. His manipulation example, which regards so-called single transferable vote elections, actually provides a case where single-peakedness fails to lower manipulation complexity, but in a different context he did find a lowering of complexity for single-peakedness. Faliszewski et al. [40] and Brandt et al. [10] then broadly explored the effect of single-peakedness on manipulative actions. These three papers are all in the model of (perfect) single-peakedness. Conitzer [15], in the context of preference elicitation, raised and studied the issue of nearly single-peaked societies. It is important to mention that he explicitly mentions two contrasting types of approaches to modeling near-single-peakedness, namely, having at most a few voters diverge, potentially greatly, from single-peakedness (this is the model on which his work concentrates); and having all voters allowed to be (in some sense) close to single-peakedness. The present paper explores both nearness of the former type, as our “maverick”-based notions, and nearness of the latter type, as our “swoon”-based, “perception flip”-based, and “Dodgson”-based notions. Escoffier et al. [32] also discussed nearness to single-peakedness, and Faliszewski et al. [40] and Brandt et al. [10] raise as open issues whether shield-evaporation (complexity) results for single-peakedness will withstand near-single-peakedness, i.e., whether, in cases where a general-case NP-hardness result drops to P for single-peaked electorates, the complexity will stay in P even for nearly single-peaked electorates. Elkind et al. [25], among other issues, study algorithms for measuring societyʼs nearness to single-peakedness through removing clones, i.e., candidates that all voters rank in consecutive blocks. Cornaz et al. [18] discuss a similar notion of nearness to single-peakedness in the context of winner determination under Chamberlin and Courantʼs proportional representation voting rule. The present paper seeks to bring the “nearly single-peaked” lens to the study of manipulative actions.
     </paragraph>
     <paragraph>
      It is well known (see Elkind et al. [23] and the references therein) that many election systems are defined, or can be equivalently defined, as selecting whichever candidateʼs region of being a winner under some notion of “consensus” has a vote set that is “closest” to the input vote set, where “closest” is defined by applying some norm (e.g., sum or max) to a vector whose ith component is some notion of distance (e.g., number of adjacent-swaps to get between the votes) between the ith votes on each list. We note that, similarly, most of the notions we will give of nearness to single-peakedness can be framed as saying that the input vote set is close (in the same sense) to some vote set that is consistent with the input societal linear order, i.e., the order that is framing the (near) single-peakedness in the senses that will be defined in the coming sections. The parallel is not perfect, since in the former work there are multiple target regions and the minimum over them is crucially selecting the winner; and also, approaches focusing on distance typically require commutativity of the distance function, but notions of diverging from a societal order may, as a matter of human behavior, be asymmetric. (The swoon notion is asymmetric; for example, swooning for candidate d would move one from the preference {a mathematical formula}a&gt;b&gt;c&gt;d to the preference {a mathematical formula}d&gt;a&gt;b&gt;c, but no single swoon can reverse that.) We mention that most of our norms/distances have already proven useful in other election contexts, and that if one finds additional norms/distances natural here, then one could study what happens under those.
     </paragraph>
     <paragraph>
      Although for cohesiveness we do not include these results in the present paper, we mention that we have, related to this project, also proven some manipulation and control results for the model of electorates known as single-caved societies, and have studied the complexity of bribery with respect to nearly single-peaked electorates; these can be found in a technical report version [39].
     </paragraph>
     <paragraph>
      This paper is focused on the line of work that looks at whether single-peakedness removes NP-hardness results about manipulative actions. Most of our key results are cases where we show that even nearly single-peaked elections fall to P. Our results of that sort are polynomial-time upper bounds, and so apply on all inputs. However, a few of our results are about NP-hardness. For those, it is important to mention that NP-hardness is a worst-case theory, and so such results are just a first step on a path that one hopes may eventually reach some notion of average-case hardness. That is a long-term and difficult goal, but has not yet been proven impossible.
     </paragraph>
     <paragraph>
      Although many people have the impression that recent results such as the work of Friedgut et al. [42] prove that any reasonable election system can often be manipulated, that powerful paper, for example, merely proves that the manipulation probability cannot go very quickly to zero, asymptotically. It does not prove that the manipulation probability asymptotically does not go to zero. Other work that controls the candidates-to-voters cardinality relation has experimentally suggested stronger claims in certain settings, but is of necessity within the setting of making assumptions about the distribution of votes (see, e.g., Walsh [65]) and typically presents simulations but not theorems and proofs (see also the more general, related survey [61]).
     </paragraph>
     <paragraph>
      Finally, given the high hopes of many people for heuristic algorithms, it is extremely important to understand that it follows from known complexity-theoretic results that, unless shocking complexity-class collapses occur, no (deterministic) polynomial-time algorithm can come too close to accepting any NP-hard set. We more clearly define, and then justify and establish, that claim in Appendix A.
     </paragraph>
    </section>
    <section label="3">
     <section-title>
      Preliminaries
     </section-title>
     <paragraph>
      Elections and election systems. An election {a mathematical formula}E=(C,V) consists of a finite candidate set C and a finite collection V of votes over the candidates. V is a list of entries, one per voter, with each entry containing a linear (i.e., tie-free total) ordering of the candidates.{sup:2}
     </paragraph>
     <paragraph>
      The information associated with some of the voters may be different in some specific attack problems, and we will specify such differences in the section below defining the types of attacks. For example, in the so-called constructive coalition weighted manipulation problem, all voters have weights, and the voters in the manipulative coalition do not each have an initial preference order, although they all are working toward some particular, specified goal.
     </paragraph>
     <paragraph>
      An election system R is a function that takes as its input an election instance {a mathematical formula}E=(C,V) and outputs a set {a mathematical formula}W⊆C. Member(s) of W are described as winner(s) of the given election. Plurality is arguably the most important election system. In plurality elections, whichever candidate gets the most top-of-the-preference-order votes wins. Each vector {a mathematical formula}(α1,…,αm), {a mathematical formula}αi∈N, {a mathematical formula}α1⩾⋯⩾αm⩾0, defines an m-candidate scoring protocol election rule, in which each voterʼs ith favorite candidate gets {a mathematical formula}αi points, and whichever candidate gets the most points wins. m-candidate Borda is defined by the vector {a mathematical formula}(m−1,m−2,…,0). For each m and t, {a mathematical formula}0&lt;t&lt;m, m-candidate t-approval is defined by the vector {a mathematical formula}(1,…,1︷t,0,…,0︷m−t), (m-candidate) t-veto is a synonym for (m-candidate) {a mathematical formula}(m−t)-approval, and (m-candidate) veto is a synonym for (m-candidate) 1-veto. We will also, as is common, often use t-veto (respectively, t-approval) to refer to the system with no bound on the number of candidates that on each input having m candidates applies m-candidate t-veto (respectively, m-candidate t-approval). Note that plurality, which we defined directly above, actually is just 1-approval. In all the systems just mentioned, if candidates tie for the highest number of points, those tying for highest are all considered winners.
     </paragraph>
     <paragraph>
      An exception to our model that votes are linear orders is the voting system known as approval voting (which should not be confused with the t-approval voting system mentioned above). In approval elections, each vote is a {a mathematical formula}‖C‖-long 0–1 vector denoting disapproval/approval of each candidate, and whichever candidate—or candidates if there is a tie in most approvals—is approved of by the most voters wins. We will use “preference orders” to refer to linear orders over the candidates, or in the case of approval settings, {a mathematical formula}‖C‖-long 0–1 vectors. So a preference order typically will refer to a candidateʼs original, or in some cases altered, vote; the term is not making a philosophical claim about the voterʼs desires or why the voter cast that particular vote. We will use “preferences” a bit more flexibly to at times speak about a voterʼs true preferences. But even regarding that term, when we speak of societies restricted to have certain properties, such as being single-peaked, what we mean by that term is usually that the actual sets of cast votes must obey that restriction.
     </paragraph>
     <paragraph>
      We will write {a mathematical formula}score(C,V)(c) to denote the score of candidate c in election {a mathematical formula}(C,V), i.e., the score for scoring systems and the number of approvals for approval voting; naturally we require that {a mathematical formula}c∈C. The particular election system that we use will always be clear from context.
     </paragraph>
     <paragraph>
      Attacks. Let us now describe the types of attacks that we study, and formally define computational problems that correspond to them. Each of the problems is defined based on an election and some additional parameters.
     </paragraph>
     <paragraph label="Definition 3.1">
      Intuitively, manipulation problems model situations where a group of voters seeks to vote strategically, i.e., possibly against their true preferences, to obtain a desired result. In the constructive coalition weighted manipulation (CCWM) for an election system R, the input is as follows. The input provides a set of nonmanipulative voters, and for each nonmanipulative voter we are given as part of the input the voterʼs weight and the voterʼs preference over the candidates; the input also contains a list of the weights of the manipulative voters; and, finally, the input additionally specifies which candidate, p, the manipulative coalition wishes to be a winner. We ask whether there is a set of votes the manipulators can cast to make p a winner under election system R. Formally, we have the following definition. (Conitzer et al. [16].) Let R be an election system. In the CCWM problem for R we are given a set of candidates C, a preferred candidate {a mathematical formula}p∈C, a collection of nonmanipulative voters S (each vote consists of a preference order and a positive integer, the weight of the vote), and a collection T of manipulators, each specified by its positive integer weight. We ask whether it is possible to set the preference orders of the manipulators in such a way that p is a winner of the resulting R election {a mathematical formula}(C,S∪T).
     </paragraph>
     <paragraph>
      Control loosely models such real-world activities as get-out-the-vote drives, targeted advertising, and voter suppression. In each of the four types of control that we will discuss, the input is an election, the candidate p that one wants to be a winner, and a parameter K limiting how many actors one can influence in the designated way. Our four types of control will be adding voters (CCAV), deleting voters (CCDV), adding candidates (CCAC), and deleting candidates (CCDC).{sup:3} Each of those four problems is defined as the collection of inputs on which using at most K actions of the designated type (e.g., adding at most K voters) suffices to make p a winner. We have the following formal definition, which is due to the seminal paper of Bartholdi et al. [5], except that the notion below of CCAC follows Faliszewski et al. [35], and most subsequent papers, in employing a bound, K, to make it better correspond to the other control types.
     </paragraph>
     <paragraph label="Definition 3.2">
      ([5], [35].) Let R be an election system.
     </paragraph>
     <list>
      <list-item label="(a)">
       In the CCAC problem for R we are given two disjoint sets of candidates, C and A, a collection V of votes over {a mathematical formula}C∪A, a candidate {a mathematical formula}p∈C, and a nonnegative integer K. We ask whether there is a set {a mathematical formula}A′⊆A such that (a) {a mathematical formula}‖A′‖⩽K, and (b) p is a winner of R election {a mathematical formula}(C∪A′,V).
      </list-item>
      <list-item label="(b)">
       In the CCDC problem for R we are given an election {a mathematical formula}(C,V), a candidate {a mathematical formula}p∈C, and a nonnegative integer K. We ask whether there is a set {a mathematical formula}C′⊆C such that (a) {a mathematical formula}‖C′‖⩽K and (b) p is a winner of R election {a mathematical formula}(C−C′,V).
      </list-item>
      <list-item label="(c)">
       In the CCAV problem for R we are given a set of candidates C, two collections of voters, V and W, over C, a candidate {a mathematical formula}p∈C, and a nonnegative integer K. We ask whether there is a subcollection {a mathematical formula}W′⊆W such that (a) {a mathematical formula}‖W′‖⩽K, and (b) p is a winner of R election {a mathematical formula}(C,V∪W′).
      </list-item>
      <list-item label="(d)">
       In the CCDV problem for R we are given an election {a mathematical formula}(C,V), a candidate {a mathematical formula}p∈C, and a nonnegative integer K. We ask whether there is a collection {a mathematical formula}V′ of voters that can be obtained from V be deleting at most K voters such that p is a winner of R election {a mathematical formula}(C,V′).
      </list-item>
     </list>
     <paragraph>
      Some early papers on control focused on making p be the one and only winner, but we follow the more recent approach of focusing on making p become a winner. The older results for the former case that we cite here are known in the literature, or were verified for this paper by us, to hold also for the latter case. In the literature, the latter case, i.e., the “make p become a winner” model, is often referred to as the “nonunique-winner model” or “the co-winner model.” As has been previously suggested elsewhere (see, e.g., [52]), it is arguably the cleaner, more natural, and more elegant model to study; the other model blurs together issues of victory and tie-handling.
     </paragraph>
     <paragraph>
      All problems defined in Definition 3.1, Definition 3.2 are decision problems. That is, they are sets, i.e., languages. Each input either is in the set—namely if the (simple) conditions on the input are satisfied and the answer to the “we ask whether” question is yes—or is not in the set. The former cases are sometimes called yes instances, and the latter are sometimes called no instances. Problems, especially “standard” NP-complete sets, are often equivalently formulated directly using that nomenclature. We do that, for example, in Definition 3.3, Definition 3.4.
     </paragraph>
     <paragraph>
      Each of our algorithms for manipulation and control not only gives a yes/no answer for the decision variant of the problem, but also can be made to produce a successful manipulative action if the answer is yes; see the work of Hemaspaandra et al. [50] for why this distinction is important.
     </paragraph>
     <paragraph>
      Having fast algorithms for manipulative actions—such as manipulation, control, and bribery—is not inherently a “bad” or unethical thing. For example, algorithms for certain types of attacks (e.g., for control and for bribery [33], [22], [21]) are valuable tools for actors (party chairs, campaign managers, etc.) who are trying to use their resources most effectively. See [6], [58], [66] for three recent applications of problems, or their destructive variants, that were originally seen as ways of attacking elections, in the context of protecting them.
     </paragraph>
     <paragraph>
      Computational complexity. We assume the reader is familiar with standard notions of complexity theory such as P, NP, polynomial-time many-one reductions, NP-completeness, etc., as presented in any standard textbook, e.g., [63]. As is standard, throughout this paper the terms NP-hard/NP-hardness will refer to polynomial-time many-one NP-hard/NP-hardness. Our NP-completeness proofs employ the PARTITION and X3C problems, which are defined as follows.
     </paragraph>
     <paragraph label="Definition 3.3">
      (See, e.g., [17].) A PARTITION instance I is a set {a mathematical formula}{k1,…,kn} of n distinct positive integers such that {a mathematical formula}∑1⩽i⩽nki=2K; I is a yes instance if there exists a subset of {a mathematical formula}{k1,…,kn} that sums to K and it is a no instance otherwise.{sup:4}
     </paragraph>
     <paragraph label="Definition 3.4">
      (See, e.g., [45].) An X3C instance {a mathematical formula}I=(B,S) consists of a base set {a mathematical formula}B={b1,…,b3k} and a family {a mathematical formula}S={S1,…,Sn} of three-element subsets of B; I is a yes instance if it is possible to pick exactly k sets from {a mathematical formula}S so that their union is B and it is a no instance otherwise.
     </paragraph>
    </section>
    <section label="4">
     <section-title>
      Nearly single-peaked societies
     </section-title>
     <paragraph>
      Imagine that on some issue, for example what the tax rate should be for the richest Americans, each person has a utility curve that on a (perhaps empty) initial part is nondecreasing and then on the (perhaps empty) rest is nonincreasing. Suppose the candidates are spread along the tax-rate axis as to their positions, with no two on top of each other. The sets of preferences that can be supported among them by curves of the mentioned sort on which there are no ties among candidates in utility are precisely the single-peaked vote ensembles. Note that different voters can have different peaks/plateaus and different curves, e.g., if both Alice and Bob think 40 percent is the ideal top tax rate, it is completely legal for Alice to prefer 30 percent to 50 percent and Bob to prefer 50 percent to 30 percent.
     </paragraph>
     <paragraph>
      Formally, single-peakedness of a collection of votes with respect to a given societal order (which following Walsh [64] will be our standard model, as discussed later in this section), or without a societal order being given, is defined as follows.
     </paragraph>
     <paragraph label="Definition 4.1">
      (Black [8], [7], see also Arrow [1].) A collection V of votes (cast as linear orders) is said to be single-peaked with respect to L (see [40]), where L is a linear order over the candidate set, if for each triple of candidates, {a mathematical formula}c1, {a mathematical formula}c2, {a mathematical formula}c3, it holds that if {a mathematical formula}c1Lc2Lc3∨c3Lc2Lc1, then {a mathematical formula}(∀v∈V)[c1&gt;vc2⇒c2&gt;vc3], where {a mathematical formula}a&gt;vb means that voter v prefers a to b. A collection V of votes (cast as linear orders) is said to be single-peaked exactly if there is a linear order L, over the candidate set, such that V is single-peaked with respect to L.
     </paragraph>
     <paragraph label="Definition 4.2">
      (Faliszewski et al. [40].) A collection V of votes (cast as approval vectors) is said to be single-peaked with respect to L, where L is a linear order over the candidate set, if for each voter, v, all candidates that v approves of (if any) form a consecutive block in L. A collection V of votes (cast as approval vectors) is said to be single-peaked exactly if there is a linear order L, over the candidate set, such that for V is single-peaked with respect to L.
     </paragraph>
     <paragraph>
      There is extensive political science/economics literature on single-peaked votingʼs naturalness, ranging from conceptual discussions to empirical studies of actual US political elections, with few candidates, showing that most voters are single-peaked with respect to the left-right political spectrum. Single-peakedness has been described as “the canonical setting for models of political institutions” [44].
     </paragraph>
     <paragraph>
      In this paper, we will primarily focus on elections whose voters are “nearly” single-peaked, under the following notions of nearness.
     </paragraph>
     <paragraph label="Definition 4.3">
      Let V be a collection of votes (cast as linear orders), let L be a linear order over the candidate set (the societal axis), and let k be a nonnegative integer.
     </paragraph>
     <list>
      <list-item label="1.">
       We say that V is a k-maverick-SP society with respect to the axis L if there is a subcollection, W, {a mathematical formula}W⊆V, of at most k votes, such that {a mathematical formula}V−W is single-peaked with respect to L.
      </list-item>
      <list-item label="2.">
       We say that V is a swoon-SP society with respect to the axis L if for each vote v in V it holds that v with the top candidate removed is single-peaked with respect to L (with the same candidate removed).
      </list-item>
      <list-item label="3.">
       We say that V is a {a mathematical formula}Dodgsonk-SP society with respect to the axis L if for each vote v in V there exists a vote {a mathematical formula}v′ that is single-peaked with respect to L and that can be obtained from v by at most k (sequential) swaps of adjacent candidates.
      </list-item>
      <list-item label="4.">
       We say that V is a {a mathematical formula}PerceptionFlipk-SP society with respect to the axis L if for each vote v in V there exists an axis {a mathematical formula}Lv such that (a) {a mathematical formula}{v} is single-peaked with respect to {a mathematical formula}Lv, and (b) {a mathematical formula}Lv can be obtained from L by at most k (sequential) swaps of adjacent candidates.
      </list-item>
     </list>
     <paragraph>
      We also apply the notion of “maverick” in the natural, analogous way to voting by approval ballots.
     </paragraph>
     <paragraph>
      Our notions of nearness to single-peakedness capture various natural ways in which people may defect from being single-peaked. One can view a k-maverick-SP society as one with a group of up to k voters who simply do not agree on the axis, or for whom completely different issues than the one represented by the axis are most pressing. In swoon-SP societies, each person may have as her or his favorite some candidate chosen due to some personal passion (such as hairstyle, religion, or personal friendship with the candidate), but all the rest of that personʼs vote must be consistent with the societal polarization. Whether this captures peopleʼs behavior will depend on the situation, but surely it is not just teenagers with posters on their walls who can be made to swoon over a person or candidate for quirky, highly individual reasons. On the other hand, {a mathematical formula}Dodgsonk-SP societies, for example, may model cases where the voters correctly perceive the societal order but feel free to be slightly away from it. In contrast, {a mathematical formula}PerceptionFlipk-SP societies model situations where each voter is consistent with that voterʼs humanly blurred view of the societal order. We hope that these models of nearness may be useful in settings beyond this paper; certainly, as was mentioned in Section 2, in other election contexts notions of distance have been intensely studied, see, e.g., Elkind et al. [23] and the references therein.
     </paragraph>
     <paragraph label="Observation 4.4">
      Note that{a mathematical formula}Dodgsonk-SP and{a mathematical formula}PerceptionFlipk-SP are not the same notion. It is tempting to think they may be the same notion, since it indeed is true that for preference orders{a mathematical formula}o1and{a mathematical formula}o2it holds that one can with k adjacent exchanges move from{a mathematical formula}o1to{a mathematical formula}o2if and only if one can with k adjacent exchanges move from{a mathematical formula}o2to{a mathematical formula}o1. But such reasoning fails to take into account that at play here is not just adjacent transposing, but also consistency. To give a concrete example of a case where the notions differ, consider the case of societal order L being{a mathematical formula}c1Lc2Lc3Lc4Lc5. And consider the one-voter electorate{a mathematical formula}V={v}, where v is{a mathematical formula}c1&gt;c4&gt;c3&gt;c5&gt;c2. Note that two adjacent exchanges within L can turn L into{a mathematical formula}L′defined as{a mathematical formula}c2L′c3L′c1L′c4L′c5, with which v is consistent. But it is easy to see that it is impossible to transform, by at most two adjacent exchanges, v into a vote that is consistent with L.
     </paragraph>
     <paragraph>
      We will speak of {a mathematical formula}f(⋅)-maverick-SP societies when this usage and the type of fʼs argument(s) are clear from context; fʼs argument(s) will typically be the size of the election instance or some parameters of the election, e.g., the number of candidates or the number of voters. Also, we will prove some results that state that “PROBLEM for ELECTION-SYSTEM over log-maverick-SP societies is in P.” This is a shorthand for the claim that for each function f (that is computable in time polynomial in the size of the input—which is roughly {a mathematical formula}‖V‖‖C‖log‖C‖ for the election {a mathematical formula}(C,V) itself plus whatever space is taken by other parameters—and to avoid possible technical problems, we should assume f is nondecreasing) whose value is {a mathematical formula}O(log(ProblemInputSize)), it holds that “PROBLEM for ELECTION-SYSTEM over f-maverick-SP societies is in P,” where the argument to f is the input size of the problem.
     </paragraph>
     <paragraph>
      Our bound on mavericks is a bound on the number of mavericks, e.g., a 2-maverick-SP society can contain at most two mavericks. This is so even if the society is involved in an election involving weighted voting. This approach is a natural one, and arguably is the most natural model of framing a limit on the number of mavericks. The systematic study of weighted control, undertaken subsequent to this work, similarly focuses on the number of voters/candidates added/deleted, rather than on their total weight [41]. On the other hand, one certainly could, motivated by the fact that heavily weighted voters may more strongly influence the outcome of an election, also study models in which one put limits not on the number of mavericks but on the total weight, or the portion of the overall societal weight, of the mavericks. Such an approach would be quite reasonable and interesting. Our model is informed by a sense that there is a limit to what number or portion of a societyʼs members will be mavericks, and the alternate model is more closely limiting the total effect of mavericks on the outcome. Which approach is more appropriate will depend on the particular situation and society. For unweighted elections, the distinction discussed here will not be present.
     </paragraph>
     <paragraph>
      In all our manipulative action problems about single-peaked and nearly single-peaked societies, we will follow Walshʼs [64] model, which is that the societal order, L, is part of the input. Because of this, we henceforward when speaking of single-peakedness or nearness to single-peakedness, for some manipulative action, will often leave out the phrase “with respect to a given axis L,” because that phrase is implicit.
     </paragraph>
     <paragraph>
      We refer the reader to earlier papers, e.g., [64], [11], [40], for a discussion of why Walshʼs model is reasonable. For example, it has been pointed out that in many settings, an electionʼs polarizing issue and the candidatesʼ positions on that issue may be openly known [40], and indeed it may sometimes be as simple as having the single-peakedness be over the standard ordering of the integers for some election that is polarized on a “price in dollars” issue [64]. We also mention that one important technical benefit of using Walshʼs model is that for nearly single-peaked societies the difference between knowing the axis and not knowing it may have a tremendous impact on the complexity of election-related problems. For example, as Theorem 4.5 below we will soon show that finding the distance from a vote collection to a given societal ordering can be done in polynomial time. In contrast with this, Erdélyi et al. [31] and Bredereck and Chen [13]—motivated by an earlier version of the present paper—have shown that, for example, deciding whether a given collection of voters forms a k-maverick-SP society, where k itself is not globally fixed but rather is part of the input, is NP-complete. The same holds for the case of {a mathematical formula}Dodgsonk-SP societies, by the work of Erdélyi et al. [31], who there use the term “local swaps” to refer to this one of our distance models. For context and comparison, we mention that for perfectly single-peaked societies, both in the case of linear-order voters and in the case of approval votes, in polynomial time one can test consistency with an axis, in polynomial time one can find whether there exists an axis with which the society is consistent, and in polynomial time one can even produce an axis with which the society is consistent when such an axis exists; these results are variously due to [3], [32], [20], [9], [43], see the discussion at the end of Section 2.2 of Faliszewski et al. [40]. Let us now state and prove our result, mentioned above, showing that given an axis it is easy to find “how nearly single-peaked” a society is with respect to that axis.
     </paragraph>
     <paragraph label="Theorem 4.5">
      There are polynomial-time algorithms that given a collection V of voters and a linear order L compute the smallest k such that V is a:
     </paragraph>
     <list>
      <list-item label="1.">
       k-maverick-SP society with respect to L,
      </list-item>
      <list-item label="2.">
       {a mathematical formula}Dodgsonk-SP society with respect to L, and
      </list-item>
      <list-item label="3.">
       {a mathematical formula}PerceptionFlipk-SP society with respect to L.
      </list-item>
     </list>
     <paragraph label="Proof">
      Note that given a preference order and societal axis L, it is easy to verify whether this preference order is single-peaked with respect to L. We consider separately each of the notions of nearness to single-peakedness.The Swoon-SP case. To decide whether V is a swoon-SP society, it suffices to do the following for each vote: (a) delete the top-ranked candidate and (b) verify that the resulting vote is single-peaked with respect to the given axis (with the same candidate deleted).The k-maverick-SP case. For the case of k-maverick-SP societies, it suffices to check for each vote in V whether it is single-peaked with respect to the given societal axis L and output the number of votes that fail this test.The{a mathematical formula}Dodgsonk-SP case. For the case of {a mathematical formula}Dodgsonk-SP societies, it suffices to give a polynomial-time algorithm that given a vote v and a societal axis L (both over the same set of candidates) computes the smallest k such that using k swaps of adjacent candidates it is possible to transform v into a vote {a mathematical formula}v′ that is single-peaked with respect to L. Our algorithm for this task works as follows.We do not know which candidate c is ranked first in {a mathematical formula}v′, but there are only polynomially many choices and we try them all. We show how to compute the minimal swap distance between v and a single-peaked vote {a mathematical formula}v′ that ranks a given candidate c first. We rename the candidates to be {a mathematical formula}ℓm′,…,ℓ1,c,r1,…,rm″ in such a way that the societal axis L is {a mathematical formula}ℓm′L⋯Lℓ1LcLr1L⋯Lrm″.It is easy to see that, if {a mathematical formula}v′ were known, one of the optimal ways of transforming v into {a mathematical formula}v′ through swaps of adjacent candidates would be to do the following. First shift c forward to the top position. Then shift the second choice of {a mathematical formula}v′ to the second position. Then shift the third choice of {a mathematical formula}v′ to the third position, and so on. This suggests a natural dynamic-programming algorithm for our task.Let {a mathematical formula}v″ be a vote identical to v except c is shifted to the top position. Let {a mathematical formula}kc be the minimal number of swaps required to obtain {a mathematical formula}v″ from v; this is easily computed. For each {a mathematical formula}t′,t″, {a mathematical formula}t′⩽m′ and {a mathematical formula}t″⩽m″, we define {a mathematical formula}f(t′,t″) to be the minimal number of swaps of adjacent candidates needed to transform {a mathematical formula}v″ so that:
      <list>
       the top candidate is c,the following {a mathematical formula}t′+t″ candidates form set {a mathematical formula}{ℓ1,…,ℓt′,r1,…,rt″}, andif we restrict the vote to candidates {a mathematical formula}ℓ1,…,ℓt′ (candidates {a mathematical formula}r1,…,rt″) then they are ranked in the order of their increasing indices.Naturally, it holds that
      </list>
      <paragraph>
       {a mathematical formula}f(0,0)=0. For each {a mathematical formula}t′, {a mathematical formula}t″ ({a mathematical formula}t′⩽m′ and {a mathematical formula}t″⩽m″) define {a mathematical formula}v″(t′,t″) to be a vote identical to {a mathematical formula}v″, but where candidates from the set {a mathematical formula}{ℓ1,…,ℓt′,r1,…,rt″} have been shifted to the {a mathematical formula}t′+t″ positions just below c (the particular order of the candidates in these {a mathematical formula}t′+t″ positions is irrelevant); for each candidate {a mathematical formula}d∈{ℓt′+1,rt″+1}, define {a mathematical formula}c(d,t′,t″) to be the number of adjacent swaps of candidates needed to shift d to be ranked in position {a mathematical formula}t′+t″+2 in {a mathematical formula}v″(t′,t″) (note that this number does not depend on the order of candidates {a mathematical formula}ℓ1,…,ℓt′,r1,…,rt″ in {a mathematical formula}v″(t′,t″)).Using the just-defined function c, it is easy to observe the following two recursive relations (we assume that {a mathematical formula}t′ and {a mathematical formula}t″ are such that the arguments of f are within the domain of the function):{a mathematical formula} and{a mathematical formula} Thus it is possible to compute f using standard dynamic programming techniques. The total (minimal) number of swaps of adjacent candidates needed to obtain an appropriate {a mathematical formula}v′ (i.e., a closest possible vote that is single-peaked with respect to L and has c as its top candidate) from v is {a mathematical formula}kc+f(m′,m″).The{a mathematical formula}PerceptionFlipk-SP case. For the case of {a mathematical formula}PerceptionFlipk-SP societies it suffices to give a polynomial-time algorithm that does the following. Given a vote v and a societal axis L, both over the same set of candidates, the algorithm finds the smallest number of (sequential) swaps of adjacent candidates so as to transform L into {a mathematical formula}L′ such that v is single-peaked with respect to {a mathematical formula}L′. (Axes with respect to which a given vote v is single-peaked certainly exist. For example, v is single-peaked with respect to the societal order that is vʼs ordering of the candidates.) Below we give such an algorithm.By renaming the candidates appropriately, we can assume that v ranks candidates as follows {a mathematical formula}c&gt;d1&gt;⋯&gt;dm; thus our set of candidates is {a mathematical formula}C={c,d1,…,dm}. It is easy to see that every societal axis {a mathematical formula}L′ with respect to which v is single-peaked is of the form {a mathematical formula}AL′cL′B, where (a) A and B form a partition of {a mathematical formula}{d1,…,dm}, (b) {a mathematical formula}L′ ranks the candidates in B in the same order as v does, and (c) {a mathematical formula}L′ ranks the candidates in A in the reverse of the order given by v. Further, the process of transforming L into {a mathematical formula}L′ can be viewed as first moving {a mathematical formula}dm (using swaps of adjacent candidates) to one of the extreme ends within L, then moving {a mathematical formula}dm−1 either to the opposite extreme end or to directly precede {a mathematical formula}dm, and so on.For each t, {a mathematical formula}1⩽t⩽m, we define {a mathematical formula}g(t) to be the minimal number of swaps of adjacent candidates within L that transforms L into {a mathematical formula}L″ that satisfies the following condition: There is a partition of the set {a mathematical formula}{dt,…,dm} into sets {a mathematical formula}A″ and {a mathematical formula}B″ such that {a mathematical formula}L″ is of the form {a mathematical formula}A″L″(C−(A″∪B″))L″B″, where the candidates in {a mathematical formula}B″ are ranked in the same way as ranked by v and the candidates in {a mathematical formula}A″ are ranked in the reverse of the order given by v. It is easy to see that our algorithm should return {a mathematical formula}g(1). We now show how to compute g.For each t, {a mathematical formula}1⩽t⩽m, we define {a mathematical formula}c(t) to be the minimal number of swaps of adjacent candidates that are needed to move {a mathematical formula}dt to the closer extreme end within L restricted to candidates in {a mathematical formula}C−{dt+1,…,dm}. Clearly, {a mathematical formula}c(t) is polynomial-time computable. For convenience, we define {a mathematical formula}g(m+1) to be 0. For each t, {a mathematical formula}1⩽t⩽m, {a mathematical formula}g(t)=g(t+1)+c(t). This gives an easy way of computing {a mathematical formula}g(1) and concludes our proof.  □
      </paragraph>
     </paragraph>
     <paragraph>
      We assume that our requirements regarding nearness to single-peakedness are for all the voters that appear in our problems. Specifically, for control by adding voters for maverick-SP societies, the total number of mavericks in the initial voter set and the pool of potential additional voters is what the maverick bound limits. For manipulation, nonmanipulators as well as manipulators can be mavericks, and we bound the total number of mavericks.
     </paragraph>
     <paragraph>
      In all our problems, we are asking whether a certain goal (such as making a particular candidate win) can be reached by the given kind of action (such as control or manipulation), and within the constraints in effect (such as how badly single-peakedness may be violated). As just mentioned, our limits on how badly single-peakedness can be violated apply to all voters that appear in our problems. So, to be completely clear, our nearness limits must hold both regarding the collection of voters input as part of the problem and regarding whatever set of voters is created by any manipulative action that changes/sets votes—in particular manipulation, although this comment would also apply to bribery if we were studying that in this paper. So if the input to a problem violates the nearness type in effect, that input simply is not a positive instance of that problem. It is also important to mention, as has been extensively discussed in earlier papers, that in defining the various problems, we do not have to take a position as to whether those votes are sincere or strategic. Rather, the problems model the challenge the manipulative coalition (for manipulation) or the attacker (for control, where in the literature that person is traditionally called “the chair”) faces given the votes, whatever their nature or source. However, since this paper is dealing with nearly single-peaked elections, it is well worth commenting about the interaction between truthfulness and amount of nearness to single-peakedness. In discussing this, for focus let us concentrate on the maverick case. Even if many peopleʼs true preferences are consistent with the societal linear order, it is natural to worry that some of these people might, due to casting strategic votes, vote in ways that are inconsistent with the societal linear order. The extent to which this will occur will heavily depend on many factors, including such issues as the nature of the voters and how public the individual votes are. For example, in an election where votes are made public, voters might fear to cast a strategic vote violating the societal order since that might make it clear that they had voted strategically, something that might be frowned on. Also, in many settings, it would be natural to assume that very few voters would vote in ways that violate the societal axis— for example, because most or all are truthful and few will truthfully not be in harmony with the axis. And that harmonizes well with the flavor of our model. But certainly this paper is more a first word—providing theoretical results for the case of societies where the nearness to single-peakedness is bounded—than a last word. We feel that studies of other models would be very interesting and important, and also important would be human-subject behavioral studies to understand in various settings the factors that cause humans to cast, or push humans away from casting, votes against societal axes.
     </paragraph>
     <paragraph>
      At this point we have defined all our attack and nearness notions. We also have mentioned that we follow Walshʼs model of having the societal axis specified as part of the input, and that even in weighted cases we limit the number of mavericks rather than the total maverick weight. And we have made clear that our nearness notions must apply to all voters that appear in our problems, and that those nearness notions must hold both before and after any manipulative action. We now give an extended example, to highlight the difference between our various nearness notions, and to illustrate a few of the points just mentioned.
     </paragraph>
     <paragraph label="Example 4.6">
      Let us consider the case of weighted manipulation under plurality elections. In our example, the input candidate set will be {a mathematical formula}{a,b,c,d,e}, and the input set of nonmanipulative votes consists of the following four votes, each of weight one:
      <list>
       We have not yet specified what nearness notion is in effect; we will cover below various examples involving four different notions of distance.The k-maverick-SP case.
      </list>
      <paragraph>
       This completes our series of examples regarding mavericks.The{a mathematical formula}PerceptionFlipk-SP case. In the case of {a mathematical formula}PerceptionFlipk-SP, each voter may be misperceiving the societal axis in a way that involves up to k sequential swaps of adjacent candidates. The important thing to remember here is that it is quite valid for different voters to have different misperceptions of the axis. After all, we each have our own quirks and flaws.Note that our set of four initially input votes satisfy a {a mathematical formula}PerceptionFlip3-SP restriction with respect to the given societal axis. Namely, the first two votes are consistent with the axis itself, unchanged. The third vote, {a mathematical formula}a&gt;e&gt;b&gt;c&gt;d, is not, but it is consistent with the axis {a mathematical formula}bLaLeLcLd, a distorted axis that can be reached from the true axis {a mathematical formula}aLbLcLdLe by three adjacent swaps, for example, by flipping a over b, and then flipping e first past d, and then past c. (This example shows that the three flips do not need to always involve the same candidate, though in this case we also could have simply flipped e three times to get instead to {a mathematical formula}aLeLbLcLd, which would also support the given vote.) The fourth vote, {a mathematical formula}d&gt;e&gt;c&gt;a&gt;b, is not consistent with the initial axis either, but the axis {a mathematical formula}bLaLcLdLe, which is distorted from the true axis just by a 1-flip misperception, supports this vote. So a {a mathematical formula}PerceptionFlip3-SP restriction is met here, since 0, 0, 3, and 1 are all less than or equal to 3.It would be a mistake to say that we need a {a mathematical formula}PerceptionFlip4-SP restriction since {a mathematical formula}0+0+3+1=4; the limit on perception flips gives a bound on the most distortion an individual voter can have, not on the overall total distortion over all voters. We mention in passing that that latter notion, however, is itself a potentially interesting one for further study.Of course, if we are under a {a mathematical formula}PerceptionFlip3-SP restriction, then when we set the vote of the manipulative voter, we must make sure that it too satisfies that restriction. For example, we could set our manipulative voter to cast the vote {a mathematical formula}b&gt;a&gt;c&gt;d&gt;e, which makes b a winner, and is a vote consistent with the input axis without any distorted perception being needed.Might the input set of votes even meet a {a mathematical formula}PerceptionFlip2-SP restriction? Clearly that is impossible. The third vote, {a mathematical formula}a&gt;e&gt;b&gt;c&gt;d, has a first and e second. But given their distance from each other on the input societal axis, no two sequential swaps of adjacent candidates in the input axis can support any vote in which a is first and e is second. So if our problem were CCWM for plurality elections over {a mathematical formula}PerceptionFlip2-SP societies, then this input would not be a part of the problem under study, and any correct algorithm would need to reject on that input.Finally, this example shows rather dramatically why it matters that in our notion each voter can have his or her own distortions. Suppose we wanted to define a different nearness notion, say “a SharedDelusion{a mathematical formula}k-SP society,” defined by there having to be some linear order, {a mathematical formula}L′, that is at most k (sequential) swaps of adjacent candidates away from the input societal order, and such that the vote set is single-peaked with respect to {a mathematical formula}L′. Note that there exists no k at all under which our input votes are a SharedDelusion{a mathematical formula}k-SP society. The way to see that is to note that votes 1, 3, and 4 have, as their relationship between c, d, and e, respectively {a mathematical formula}c&gt;d&gt;e, {a mathematical formula}e&gt;c&gt;d, and {a mathematical formula}d&gt;e&gt;c. This is a so-called Condorcet cycle, and it is well-known and not hard to see that no axis can exist relative to which votes containing a Condorcet cycle can be single-peaked.The{a mathematical formula}Dodgsonk-SP case. The third vote can with three flips be transformed into {a mathematical formula}a&gt;b&gt;c&gt;d&gt;e and the fourth vote can with one flip be transformed into {a mathematical formula}d&gt;e&gt;c&gt;b&gt;a. Each of those transformed votes is consistent with the input societal axis. So the input here obeys a Dodgson{a mathematical formula}3-SP restriction.The input vote collection can easily be seen not to obey a Dodgson{a mathematical formula}2-SP restriction. Nonetheless, as noted in Observation 4.4, there are cases where the Dodgson and the PerceptionFlip approaches yield differing nearness amounts.The Swoon-SP case. The input votes are not a valid swoon-SP society. Even with its top choice removed, vote 3 remains inconsistent with the input societal axis. The same is true for vote 4. However, for example, a vote of {a mathematical formula}e&gt;b&gt;c&gt;a&gt;d would, relative to the societal axis {a mathematical formula}aLbLcLdLe, be a valid vote in a swoon-SP society, since {a mathematical formula}b&gt;c&gt;a&gt;d is consistent with the axis {a mathematical formula}aLbLcLd.
      </paragraph>
     </paragraph>
     <section>
      <section-title>
       Comments on median voting
      </section-title>
      <paragraph>
       For single-peaked electorates, “median voting” (in which the candidate wins who on the societal axis is preferred by the “median voter”) is known to be strategy-proof, i.e., a voter never benefits from misrepresenting his or her preferences. From that, it might seem tempting to conclude that all elections on single-peaked societies “should” use median voting, and that we thus need not discuss single-peaked—or perhaps even nearly single-peaked—elections with respect to other voting systems, such as plurality, veto, etc. But that temptation should be resisted. First, median votingʼs strategy-proofness regards manipulation and not control. Second, even in real-world political elections broadly viewed as being (nearly) single-peaked, it simply is not the case that median voting is used. People, for whatever reasons of history and comfort, use such systems as plurality, approval, and so on for such elections. And so algorithms for those systems are worth studying. Third, for manipulation of nearly single-peaked electorates, strategy-proofness does not even hold. And although for such elections only the mavericks can have an incentive to lie, that doesnʼt mean that the outcome wonʼt be utterly distorted even by a single maverick. There are arbitrarily large electorates, having just one maverick, where that maverick can change the winner from being the median one to being instead a candidate on the outer extreme of the societal order.
      </paragraph>
     </section>
    </section>
    <section label="5">
     <section-title>
      Manipulation
     </section-title>
     <paragraph>
      This paperʼs section on control focuses on, and provides many examples of, settings where not just the single-peaked case but even the nearly single-peaked cases have polynomial-time algorithms. Regarding manipulation, the results are more sharply varied. We first focus on the complexity of manipulation, under our four notions of nearness to single-peakedness, for 3-candidate weighted elections. Our results are summarized in Table 1. Then we provide some additional results for larger veto elections. An overview of our results on veto elections is given in Table 2.
     </paragraph>
     <section label="5.1">
      <section-title>
       Weighted manipulation under 3-candidate scoring protocols
      </section-title>
      <paragraph>
       We first consider k-maverick-SP elections. We show that NP-hardness holds for a rich class of scoring protocols, in the presence of even one maverick. (When {a mathematical formula}α2=α3 the system is either equivalent to plurality or is a trivial system where everyone always is a winner. These cases are easily seen to be in P.) Recall from Section 3 the meaning of “{a mathematical formula}(α1,α2,α3) elections,” namely, scoring protocol elections using the vector {a mathematical formula}(α1,α2,α3).
      </paragraph>
      <paragraph label="Theorem 5.1">
       For each{a mathematical formula}α1⩾α2&gt;α3, CCWM for{a mathematical formula}(α1,α2,α3)elections over 1-maverick-SP societies is NP-complete.
      </paragraph>
      <paragraph>
       We point out that this theorem is of the same form as that for the general case (see [16], [47], [60]). However, the proofs for the general case do not work in our case, since those proofs construct elections with at least two mavericks.
      </paragraph>
      <paragraph label="Proof of Theorem 5.1">
       Without loss of generality, we assume that {a mathematical formula}α3=0. We will reduce from PARTITION. Given a set {a mathematical formula}{k1,…,kn} of n distinct positive integers that sums to 2K, define the following instance of CCWM. Let {a mathematical formula}C={p,a,b}, let societyʼs order be {a mathematical formula}aLpLb, let S consist of one voter with preference order {a mathematical formula}a&gt;b&gt;p (note that this voter is the maverick) with weight {a mathematical formula}(2α1−α2)α1K, and one voter with preference order {a mathematical formula}b&gt;p&gt;a with weight {a mathematical formula}(2α1−α2)(α1−α2)K. (Technically, weights need to be positive, but if {a mathematical formula}α1=α2 we can get the same effect by letting S consist of just the maverick.) Note that {a mathematical formula}score(C,S)(a)=score(C,S)(b)=(2α13−α12α2)K and that {a mathematical formula}score(C,S)(p)=(2α1−α2)(α1−α2)α2K=(2α12α2−3α1α22+α23)K. Let T consist of n manipulators with weights {a mathematical formula}(α12−α1α2+α22)k1,…,(α12−α1α2+α22)kn.If there is a subset of {a mathematical formula}k1,…,kn that sums to K, then we let all manipulators in T whose weight divided by {a mathematical formula}(α12−α1α2+α22) is in this subset vote {a mathematical formula}p&gt;a&gt;b, and all manipulators in T whose weight divided by {a mathematical formula}(α12−α1α2+α22) is not in this subset vote {a mathematical formula}p&gt;b&gt;a. It is immediate that {a mathematical formula}score(C,S∪T)(a)=score(C,S∪T)(b)=score(C,S)(a)+(α12α2−α1α22+α23)K=(2α13−α1α22+α23)K and that {a mathematical formula}score(C,S∪T)(p)=score(C,S)(p)+(2α13−2α12α2+2α1α22)K=(2α13−α1α22+α23)K. It follows that all candidates are tied, and thus all candidates are winners. Recall that in our model even manipulators must cast votes respecting the societal ordering, L; the manipulative votes just specified indeed do respect L.For the converse, suppose the manipulators vote so that p becomes a winner. It is easy to see that we can assume that all manipulators rank p first. From the calculations above, it is also easy to see that it is always the case that {a mathematical formula}2score(C,S∪T)(p)⩽score(C,S∪T)(a)+score(C,S∪T)(b). In order for p to be a winner, we thus certainly need the scores of a and b to be equal. This implies that {a mathematical formula}score(C,T)(a)=score(C,T)(b). But then the weights of the manipulators voting {a mathematical formula}p&gt;a&gt;b sum to {a mathematical formula}(α12−α1α2+α22)K.  □
      </paragraph>
      <paragraph>
       In the general case (i.e., no single-peakedness is required), the cases that in Theorem 5.1 are NP-complete are NP-complete [16], [47], [60], so allowing a 1-maverick single-peaked society is jumping us up to the same level of complexity that holds in the general case here. In contrast, for single-peaked societies (without mavericks), 3-candidate CCWM is NP-complete when {a mathematical formula}(α1−α3)&gt;2(α2−α3)&gt;0 and is in P otherwise [40]. So, in particular, 3-candidate veto and 3-candidate Borda elections are in P for the single-peaked case, but are already NP-complete for “single-peaked except with one maverick allowed,” i.e., for 1-maverick-SP societies.
      </paragraph>
      <paragraph>
       Let us now consider the three other types of nearness to single-peakedness: swoon-SP societies, {a mathematical formula}Dodgsonk-SP societies, and {a mathematical formula}PerceptionFlipk-SP societies. In these cases the complexity of weighted manipulation in 3-candidate elections is the same as in the general case, but for a trivial reason.
      </paragraph>
      <paragraph label="Observation 5.2">
       Every 3-candidate election is a swoon-SP election, a{a mathematical formula}Dodgson1-SP election, and a{a mathematical formula}PerceptionFlip1-SP election, and so all complexity results for 3-candidate elections in the general case also hold for swoon-SP elections,{a mathematical formula}Dodgson1-SP elections, and{a mathematical formula}PerceptionFlip1-SP elections.
      </paragraph>
      <paragraph label="Proof">
       Since every 2-candidate vote is single-peaked, it follows immediately that every 3-candidate election is a swoon-SP election. For the {a mathematical formula}Dodgson1-SP case and {a mathematical formula}PerceptionFlip1-SP case, suppose societyʼs order is {a mathematical formula}aLbLc. The only votes that are not consistent with the societal ordering are {a mathematical formula}a&gt;c&gt;b and {a mathematical formula}c&gt;a&gt;b. However, regarding {a mathematical formula}Dodgson1-SP, note that each of these votes is one adjacent swap-in-the-vote away from being single-peaked, namely by swapping the voteʼs last two candidates.Similarly, regarding {a mathematical formula}PerceptionFlip1-SP, for each of these votes there exists a swap-within-L that converts L into an ordering consistent with the vote. In fact, there is even a single swap in L that simultaneously handles both problematic votes. However, it is important to be aware that such simultaneity is not required by the definition of {a mathematical formula}PerceptionFlip1-SP.  □
      </paragraph>
      <paragraph>
       Thus it turns out that for three candidates the complexity of weighted manipulation under scoring protocols is extremely fragile with respect to whether the inputs must be (perfectly) single-peaked or are merely close to being single-peaked. It is quite natural to suspect that, at least to some extent, this fragility is a consequence of the fact that for 3-candidate elections the difference between the general case and the nearly single-peaked case is very small (indeed, nonexistent, for swoon-SP, {a mathematical formula}Dodgson1-SP, and {a mathematical formula}PerceptionFlip1-SP societies). Nonetheless, in larger elections the complexity of weighted manipulation can act in quite interesting and somewhat counterintuitive ways, as will be seen in Section 5.2.
      </paragraph>
     </section>
     <section label="5.2">
      <section-title>
       Weighted manipulation under veto
      </section-title>
      <paragraph>
       We now consider veto elections and ask the following question: Is it always the case that the complexity of CCWM increases when the society is allowed to be nearly single-peaked rather than (perfectly) single-peaked? For example, does allowing one maverick always raise the CCWM complexity? The following theorem implies that answer is no, unless {a mathematical formula}P=NP. (The {a mathematical formula}k=0 case of this result follows from Faliszewski et al. [40].)
      </paragraph>
      <paragraph label="Theorem 5.3">
       For each{a mathematical formula}k⩾0and{a mathematical formula}m⩾k+3, CCWM for m-candidate veto elections over k-maverick-SP societies is in P.
      </paragraph>
      <paragraph label="Proof">
       Let {a mathematical formula}k⩾0 and {a mathematical formula}m⩾k+3, and let societyʼs order be L. Let {a mathematical formula}cℓ be the leftmost candidate in L and let {a mathematical formula}cr be the rightmost candidate in L. In an m-candidate veto election, the {a mathematical formula}m−2 candidates in {a mathematical formula}C−{cℓ,cr} are never vetoed by the nonmavericks. Every maverick vetoes at most one of these {a mathematical formula}m−2 candidates. Since {a mathematical formula}k&lt;m−2, in a k-maverick m-candidate veto election, there exists a candidate that is never vetoed. So, given an instance of CCWM for m-candidate veto elections over k-maverick-SP societies, p can be made a winner if and only if p is never vetoed by the nonmanipulators.  □
      </paragraph>
      <paragraph>
       Although Theorem 5.3 is all about the existence of polynomial-time algorithms, in contrast each of its cases are well-known to be NP-complete in the general case [16]. Still, the contrast is a bit fragile. For example, although the above theorem shows that CCWM for {a mathematical formula}(1,1,1,1,0) elections over 2-maverick-SP societies is in P, we prove below that CCWM for {a mathematical formula}(1,1,1,0) elections over 2-maverick-SP societies is NP-complete. Note also that this theorem gives an example where 4-candidate veto elections are NP-complete but 5-candidate veto elections are in P, in contrast with the behavior that one often expects regarding NP-completeness and parameters, namely, one might expect that increasing the number of candidates wouldnʼt lower the complexity. (See Faliszewski et al. [40] for another example of this unusual type of behavior.)
      </paragraph>
      <paragraph label="Theorem 5.4">
       For each{a mathematical formula}k⩾0and{a mathematical formula}m⩾3such that{a mathematical formula}m⩽k+2, CCWM for m-candidate veto elections over k-maverick-SP societies is NP-complete.
      </paragraph>
      <paragraph label="Proof">
       We will again reduce from PARTITION. Given a set {a mathematical formula}{k1,…,kn} of n distinct positive integers that sums to 2K, define the following instance of CCWM. Let {a mathematical formula}C={p,a,b,c1,…,cm−3}, let societyʼs order be {a mathematical formula}aLpLc1L⋯Lcm−3Lb, let S consist of {a mathematical formula}m−2 voters each of weight K. For every candidate c in {a mathematical formula}C−{a,b} there is a voter in S that ranks c last. Note that all voters in S are mavericks. This is allowed, since {a mathematical formula}m−2⩽k. Let T consist of n manipulators with weights {a mathematical formula}k1,…,kn.If there is a subset of {a mathematical formula}k1,…,kn that sums to K, then we let all manipulators in T whose weight is in this subset vote {a mathematical formula}a&gt;p&gt;c1&gt;⋯&gt;cm−3&gt;b, and all manipulators in T whose weight is not in this subset vote {a mathematical formula}b&gt;cm−3&gt;⋯&gt;c1&gt;p&gt;a. It is immediate that all candidates in election {a mathematical formula}(C,S∪T) are tied and so p is a winner.For the converse, suppose the manipulators can vote so that p becomes a winner. Note that p needs to gain at least K points over a and over b in T. Clearly, the only way this can happen is if {a mathematical formula}score(C,T)(a)=score(C,T)(b)=K. But then the weights of the voters in T who rank a last add to K.  □
      </paragraph>
      <paragraph>
       Theorem 5.3, Theorem 5.4 also show that for any number of mavericks, there exists a voting system such that CCWM is easy for up to that number of mavericks, and hard for more mavericks.
      </paragraph>
      <paragraph label="Corollary 5.5">
       Let{a mathematical formula}m⩾0. For all{a mathematical formula}k⩾0, CCWM for{a mathematical formula}m+3-candidate veto elections over k-maverick-SP societies is in P if{a mathematical formula}k⩽mand is NP-complete otherwise.
      </paragraph>
      <paragraph label="Theorem 5.6">
       Let us now turn from the maverick notion of nearness to single-peakedness, and look at the “swoon” notion, in which, recall, each voter must be consistent with the societal ordering when one removes from the voterʼs preference list the voterʼs first-choice candidate. For three candidates (see Observation 5.2) and four candidates we have NP-completeness, and for five or more candidates we have membership in P. For each{a mathematical formula}m⩾5, CCWM for m-candidate veto elections in swoon-SP societies is in P. For{a mathematical formula}m∈{3,4}, this problem is NP-complete.
      </paragraph>
      <paragraph label="Proof">
       First suppose that {a mathematical formula}m⩾5. Let L be societyʼs order. Let c be a candidate such that there are at least two candidates to the left of c in L and there are at least two candidates to the right of c in L. In an m-candidate veto election in a swoon-SP society, c will never be vetoed. Given a CCWM instance for m-candidate veto elections in swoon-SP societies, p can be made a winner if and only if p is never vetoed by the nonmanipulators.Now consider the case that {a mathematical formula}m=4. We will reduce from PARTITION. Given a set {a mathematical formula}{k1,…,kn} of n distinct positive integers that sums to 2K, define the following instance of CCWM. Let {a mathematical formula}C={p,a,b,c}, let societyʼs order be {a mathematical formula}aLpLbLc, let S consist of two voters, each with weight K. One voter in S votes {a mathematical formula}a&gt;c&gt;b&gt;p and one voter votes {a mathematical formula}c&gt;a&gt;p&gt;b. Let T consist of n manipulators with weights {a mathematical formula}k1,…,kn.If there is a subset of {a mathematical formula}k1,…,kn that sums to K, then we let all manipulators in T whose weight is in this subset veto a and all manipulators in T whose weight is not in this subset veto c. It is immediate that all candidates in election {a mathematical formula}(C,S∪T) are tied and so p is a winner.For the converse, suppose the manipulators can vote so that p becomes a winner. Note that p needs to gain at least K points over a and over c in T. Clearly, the only way this can happen is if {a mathematical formula}score(C,T)(a)=score(C,T)(c)=K. But then the weights of the voters in T who veto a add to K.A very similar proof can be used to show the statement for {a mathematical formula}m=3. However, the statement for {a mathematical formula}m=3 also follows immediately from the fact that CCWM for 3-candidate veto elections is NP-complete and the fact (see Observation 5.2) that every 3-candidate election is a swoon-SP election.  □
      </paragraph>
      <paragraph>
       Complexity results for unrestricted preferences do not always hold for swoon-SP elections, for {a mathematical formula}Dodgson1-SP elections, or for {a mathematical formula}PerceptionFlip1-SP elections. For example, for {a mathematical formula}m⩾5—even for {a mathematical formula}m⩾3, but the contrast we wish to make exists just for the {a mathematical formula}m⩾5 cases—CCWM for m-candidate veto elections is NP-complete in the general case (see [16], [47], [60]), but is in P for swoon-SP societies (Theorem 5.6) and for {a mathematical formula}Dodgson1-SP and for {a mathematical formula}PerceptionFlip1-SP societies (Theorem 5.7).
      </paragraph>
      <paragraph label="Theorem 5.7">
       For each{a mathematical formula}m⩾5, CCWM for m-candidate veto elections in{a mathematical formula}Dodgson1-SP societies and in{a mathematical formula}PerceptionFlip1-SP societies is in P. For{a mathematical formula}m∈{3,4}, this problem is NP-complete.
      </paragraph>
      <paragraph label="Proof">
       The same proof applies to both {a mathematical formula}Dodgson1-SP societies and to {a mathematical formula}PerceptionFlip1-SP societies. Below we focus on the former case.The {a mathematical formula}m⩾5 case follows using the same proof as the {a mathematical formula}m⩾5 case of Theorem 5.6. The {a mathematical formula}m=4 case follows using the same proof as the {a mathematical formula}m=4 case of Theorem 5.6 except that, in order for the votes to be within one adjacent swap of being consistent with societal order, the two voters in S now vote {a mathematical formula}c&gt;b&gt;a&gt;p and {a mathematical formula}a&gt;p&gt;c&gt;b. The {a mathematical formula}m=3 case follows from Observation 5.2.  □
      </paragraph>
     </section>
    </section>
    <section label="6">
     <section-title>
      Control
     </section-title>
     <paragraph>
      In this section we examine how nearness to single-peakedness affects the complexity of control problems, namely, the complexity of constructive control by adding candidates (CCAC), the complexity of constructive control by deleting candidates (CCDC), the complexity of constructive control by adding voters (CCAV), and the complexity of constructive control by deleting voters (CCDV). We provide results for plurality, t-approval, and approval. We chose these rules because they show quite interesting, contrasting behavior with respect to the complexity of control. Under unrestricted preferences, for plurality it holds that candidate control problems are NP-complete but voter control problems are easy. For approval, we have the opposite: candidate control is easy and voter control is hard. For t-approval (for {a mathematical formula}t⩾4), all candidate and voter control problems are hard. In contrast, for single-peaked societies all these control problems for these voting rules are easy. Throughout this section we explore, for these rules, how far we can go from single-peakedness without raising the complexity of the rulesʼ control problems.
     </paragraph>
     <paragraph>
      We present our results in subsections, each devoted to a notion of nearness to single-peakedness. Our main results are summarized in Table 3. Since (unbounded) approval voting does not have linear orders as the underlying votes, distance models inherently based on linear orders have “doesnʼt apply” in their approval-voting cells of the table.
     </paragraph>
     <paragraph>
      Our proofs will focus on the t-approval case, for general t. For those rows of Table 3 where the plurality column has a result no better than that of the t-approval column ({a mathematical formula}t⩾2), one might naturally wonder whether by a direct attack on plurality one could obtain a better result for plurality than for the general case of t-approval. There are three rows of this form: within the CCAC/CCDC part of the table the k-maverick-SP row, the {a mathematical formula}Dodgsonk-SP row, and the {a mathematical formula}PerceptionFlipk-SP row. For each of these rows we have tried to directly obtain for plurality a stronger result, namely, a P result rather than merely the result that for each fixed k the case is in P. However, in none of these cases have we succeeded in exploiting {a mathematical formula}t=1 to obtain a stronger result than holds for larger t.
     </paragraph>
     <section label="6.1">
      k-Maverick-SP societies
      <paragraph>
       The very first results of Faliszewski et al. [40] showing that NP-complete general-case control results can simplify to P results for single-peaked electorates were for constructive control by adding voters and for constructive control by deleting voters, for approval elections. We show that each of those results can be reestablished even in the presence of logarithmically many mavericks. (Indeed, we mention in passing that even if the attacker is allowed to simultaneously both add and delete voters—so-called “AV+DV” multimode control in the recent model that allows simultaneous attacks [38]—the complexity of planning an optimal attack still remains polynomial-time even with logarithmically many mavericks.) The theorem below is stated for approval voting, but by doing so, clearly it is also yielding the same result for t-approval, for each t.{sup:6}
      </paragraph>
      <paragraph label="Theorem 6.1">
       CCAV and CCDV for approval elections over log-maverick-SP societies are each in P. For CCAV, the complexity remains in P even for the case where no limit is imposed on the number of mavericks in the initial voter set, and the number of mavericks in the set of potential additional voters is logarithmically bounded (in the overall problem input size).{sup:7}
      </paragraph>
      <paragraph>
       Although we will build on this to prove a more general result (Theorem B.1/Corollary B.2) in Appendix B, we start by proving this result directly. We do so both as that will make the more general result clearer, and as P-time results are the core focus of this paper. Our proof involves the “demaverickification” of the society, in order to allow us to exploit the power of single-peakedness. By doing so, our proof establishes that for the case at issue here there is a polynomial-time disjunctive truth-table reduction to the single-peaked case.{sup:8} Inside the proof, we will explain why our demaverickification does not also give an obvious polynomial-time disjunctive truth-table reduction from the general case (i.e., no limit on the number of mavericks) to the single-peaked case.
      </paragraph>
      <paragraph>
       Our demaverickification process is the following quite simple act. For each maverick voter, v, replace v with the following new voters: For each candidate c that v approves, add a voter who approves of only c. The proofs that follow are, implicitly, an (admittedly long) explanation of why this is helpful to do. But a very short explanation of why this is helpful is that this transformation adds in only nonmaverick votes, and does so in a way that doesnʼt change the approval counts and that more generally works hand-in-hand with our needs and constraints.
      </paragraph>
      <paragraph label="Proof of the CCAV case of Theorem 6.1">
       We now present our construction. For each choice of which mavericks from the additional voter set to add to our election, we will generate at most one instance of a single-peaked control question. Since there are at most logarithmically many such mavericks, and the number of cases we have to look at is the cardinality of the powerset of the number of mavericks among the additional voters, the number of instances we generate is polynomially bounded.(One might naturally wonder whether our demaverickification process provides a polynomial-time reduction from the general—no limit on the number of mavericks—case to the single-peaked case. If our demaverickification process really did that, we would have implicitly proven that {a mathematical formula}P=NP. However, the previous paragraph is the key to why we in fact have not given any such reduction. In the general case, the cardinality of the powerset of the number of mavericks among the additional voter set can be exponential in the overall problem size, since the additional voter set may in some cases be large and made up mostly of mavericks. Thus we will reduce not to a disjunction over a polynomial number of polynomial-sized single-peaked cases, but rather we will reduce to a disjunction over an exponential number of polynomial-sized single-peaked cases. But having an exponential-time reduction from the NP-hard general case to the P-time single-peaked case is nothing thrilling, and does not establish that {a mathematical formula}P=NP.)For each choice A of which mavericks from among the additional voter set to add to the main election, we generate at most one instance in the following way. If {a mathematical formula}‖A‖&gt;K, we will generate no instance, as that choice is trying to add illegally many additional voters. Otherwise, we generate a single-peaked election instance in the way we will now specify. Move the elements of A from the additional voter set to the main election. Remove all remaining mavericks from the additional voter set. Demaverickify our election by this process: For each maverick voter v, for each candidate c that v approves, add a new voter who approves of only c (and so certainly is consistent with the single-peaked societal order); then remove all the maverick voters. (For example, if a voter approves of exactly Alice, Bob, and Carol, then we remove that voter and replace him or her with three voters, one approving exactly of Alice, one approving exactly of Bob, and one approving exactly of Carol.) Note that this demaverickification process does not change the approval counts of the election and does ensure that the electorate is single-peaked. The entire demaverickification process does not increase the problemʼs size by more than a polynomial factor, since no voter is replaced by more than {a mathematical formula}‖C‖−1 voters. Replace K by {a mathematical formula}K−‖A‖. The resulting instance is the instance that this choice of A adds to our collection of instances.So, we have created a polynomial-length list of (polynomial-sized) instances of the single-peaked CCAV problem. It is easy to see that our control goal can be achieved exactly if for at least one of these instances the control goal can be achieved. Briefly put, that is because our problem has a successful control action (after passing the initial maverick-cardinality-limit check) exactly if there is some appropriate-sized subset of additional voters that we can add to make the favored candidate become a winner. Our above process tries every legal set of choices for which mavericks from the additional voter set might be the mavericks in the added set. And the instance it generates, based on that choice, will have a successful control action precisely if what remains of our initial K bound, after we remove the cardinality of the added mavericks, is such that there is some number of nonmaverick additional voters who can be added to achieve the desired victory for p. In addition, the instance generated is a single-peaked society, and the transformation we used to make it single-peaked doesnʼt in anyway affect the answer to the created instance, since the demaverickification occurred only on voters that were (at that point, although some had not started there) in our main voter set, and the only effect that set has on the single-peaked CCAV control question regards the approval totals of each candidate, and our demaverickification did not alter those totals.Our polynomial-length list of instances is composed just of instances of the CCAV problem for approval elections over single-peaked electorates. That problem has a polynomial-time algorithm [40]. And so we run that algorithm on each of the polynomially many instances, and if any finds a successful control action, our original problem has a successful control action, and if not our original problem does not. Thus our proof of the CCAV case is complete.  □
      </paragraph>
      <paragraph>
       We have just given a proof of the CCAV case of the theorem. However, an additional comment is needed, since we wish not only to give a yes/no answer, but even to find what control action to take, when one is possible. Doing so goes beyond what the theorem asserts, but we in general will try to give algorithms that not only give yes/no answers but also that at least implicitly make available the actual successful actions for the yes instances. Formally speaking, disjunctive truth-table reductions are about languages, rather than about solutions. Nonetheless, from our construction in the above proof, it is immediately clear how a successful control action for any problem on the list—and the polynomial-time algorithm of Faliszewski et al. [40] in fact gives not merely a yes/no answer but in fact finds a successful control action when one exists—specifies a successful control action for our nearly-single-peaked original problem. Not only is this a natural thing to want to do, but as alluded to earlier in this paper, it has been argued that failing to focus on search problems can in some (quite different) cases lead to problems Hemaspaandra et al. [50].
      </paragraph>
      <paragraph>
       The CCDV case might at first seem to be almost completely analogous, except that in that case, there is no separate pool of additional voters, and the logarithmic bound applies to the entire set of initial voters. However, the reduction approach we took above for CCAV at first seems not to work here. The reason is that for the CCAV case, the mavericks we added could be demaverickified in a way that didnʼt interfere with the call to the single-peaked case of the CCAV approval voting algorithm, and the mavericks we decided not to add could (for the instance being generated) be deleted. In contrast, for the CCDV case, whichever mavericks we donʼt delete remain very much a part of the election—and are indeed part of the instance we would like to generate (regarding calling the single-peaked case of CCDV). But that means the generated case in fact may not be single-peaked, as we would like it to be.
      </paragraph>
      <paragraph>
       We can work around this obstacle, by noting that the algorithm given in Faliszewski et al. [40] for the single-peaked CCDV approval-voting case in fact does a bit more than is claimed there. It is easy to see, looking at that paper, that it in effect gives a polynomial-time algorithm for the following problem.
      </paragraph>
      <list>
       <list-item>
        A societal ordering and an instance of CCDV (including a deletion limit K) such that in that instanceʼs voter set each voter has an extra bit specifying whether the voter is deletable or is not deletable, and every voter that is specified as being deletable must be consistent with the societal ordering. (Voters specified as being not deletable are not required to be consistent with the societal ordering. They may be mavericks.)
       </list-item>
       <list-item>
        Is there a set of at most K deletable voters such that if we delete them our preferred candidate p is a winner?
       </list-item>
      </list>
      <paragraph>
       The fact that Faliszewski et al. [40] implicitly gives such an algorithm is clear from that paper, since regarding the “deleting voters” actions described on its page 96 we can choose to allow them only on the deletable voters, and the Faliszewski et al. [40] algorithmʼs correctness in our case hinges (assuming that nondeletable voters are indeed nondeletable) just on the fact that the deletable voters all respect the societal ordering. (Once we allow a deletable/nondeletable flag, we could in fact demaverickify all the remaining mavericks, and then flag all the 1-approval-each voters added by that demaverickification as being nondeletable, but there is no need to do any of that. Doing it requires the deletable/nondeletable flag, and as just noted, if one has that flag, one can outright tolerate (nondeletable) mavericks.)
      </paragraph>
      <paragraph label="Proof of the CCDV case of Theorem 6.1">
       In the discussion just above, we have noted a polynomial-time algorithm that, while not stated as the abovementioned theorem of Faliszewski et al. [40], is a corollary to their theoremʼs proof—i.e., the proof of the CCDV result that in [40] appears on that paperʼs page 93. With this in hand, we can handle our nearly-single-peaked CCDV case using the same basic approach we used for CCAV, as naturally modified for the CCDV case. In particular, we again polynomial-time disjunctive truth-table reduce to a problem known to be in polynomial time—in this case, CCDV for approval voting over single-peaked societies, with a deletable/nondeletable flag for each voter, and with all deletable voters having to be nonmavericks, which was argued above to be in polynomial time. Our reduction is that (after checking that the input election is syntactically correct and does not have illegally many mavericks) for each subset of the mavericks that is of cardinality at most K (the input bound on the number of voters to delete), we delete those K mavericks, then we decrement K by the cardinality of the subset, then we mark all the nonmaverick voters as deletable, and mark each remaining maverick as nondeletable. This approach works for essentially the same reason as the CCAV case, and as in that case, we can get not merely a yes/no answer, but can even for the yes cases produce a successful control action.  □
      </paragraph>
      <paragraph>
       Is Theorem 6.1 just the tip of an iceberg? Is Theorem 6.1 in fact hiding some broader connection between number of mavericks and computational complexity theory? In Appendix B, we suggest that the answer is yes, although we feel that the iceberg tip is the most important part of the iceberg. In that appendix we will establish connections between the so-called limited nondeterminism hierarchy from complexity theory and the complexity of controlling elections containing mavericks.
      </paragraph>
      <paragraph>
       Let us now consider CCAC and CCDC. These problems are in P for approval even under unrestricted preferences, and so we focus on t-approval.
      </paragraph>
      <paragraph label="Theorem 6.2">
       For each t and k, CCAC and CCDC for t-approval over k-maverick-SP societies are in P.
      </paragraph>
      <paragraph>
       As in the case of the proof of Theorem 6.1, the idea of the algorithm is to (polynomial-time disjunctively truth-table) reduce to the single-peaked case. However, here the mavericks require a more involved brute-force search and thus we can only handle a constant number of them. The proof of Theorem 6.2 is provided in Appendix C.
      </paragraph>
      <paragraph>
       The above result shows that with a very small number of mavericks, the problems fall into P. The following result shows that the same type of result cannot—unless {a mathematical formula}P=NP—ever be established for the case where the number of mavericks is allowed to be some fixed root of the input size.
      </paragraph>
      <paragraph label="Theorem 6.3">
       For each{a mathematical formula}ϵ&gt;0, CCAC and CCDC for t-approval elections over{a mathematical formula}Iϵ-maverick-SP societies are NP-complete, where I denotes the input size.
      </paragraph>
      <paragraph>
       The proof of Theorem 6.3 is provided in Appendix C.
      </paragraph>
     </section>
     <section label="6.2">
      <section-title>
       Swoon-SP societies
      </section-title>
      <paragraph>
       Unfortunately, for CCAC and CCDC swooning cannot be handled at all (unless {a mathematical formula}P=NP), as shown below through the somewhat involved proof of Theorem 6.4. The cases of CCAV and CCDV are also quite involved, but we nonetheless obtain for them, respectively, polynomial-time exact (Theorem 6.5) and approximation (Theorem 6.6) algorithms.
      </paragraph>
      <paragraph label="Theorem 6.4">
       For each t, CCAC and CCDC for t-approval elections over swoon-SP societies are NP-complete.
      </paragraph>
      <paragraph>
       For {a mathematical formula}t=1, Theorem 6.4 implies the classic result of Bartholdi et al. [5] that CCAC and CCDC are NP-complete for plurality elections. However, the proofs of Bartholdi, Tovey, and Trick cannot be used directly for swoon-SP societies. Elkind et al. [24] have shown hardness of CCAC for t-approval and Lin [57] considered both CCAC and CCDC, but their proofs do not apply to swoon-SP societies either. We now prove Theorem 6.4.
      </paragraph>
      <paragraph label="Proof">
       We first consider the case of CCAC. It is easy to see that CCAC for t-approval over swoon-SP societies is in NP. It remains to be shown that it is NP-hard and we do so by giving a reduction from X3C. Let {a mathematical formula}I=(B,S) be our input X3C instance, where {a mathematical formula}B={b1,…,b3k} and {a mathematical formula}S={S1,…,Sn}. Without loss of generality, we assume that {a mathematical formula}k⩾2 and {a mathematical formula}n⩾4. For each {a mathematical formula}bi∈B, we set {a mathematical formula}ℓi to be the number of sets in {a mathematical formula}S that contain {a mathematical formula}bi.Let {a mathematical formula}N=(6kn)+(n)+(2nk+k−n)+(2nk)+(∑1⩽i⩽3k(2nk+2k−2kℓi)) (the parenthesized terms correspond to items in the voter description later; we will have {a mathematical formula}N+(3k+2)N voters where the first N voters create appropriate structure, and the remaining {a mathematical formula}(3k+2)N voters provide appropriate padding). Our construction will use a number of padding (“garbage”) candidates, that we group into the following sets:
       <list>
        We set {a mathematical formula}Gp={gp1,…,gpt−1}.We set {a mathematical formula}Gd={gd1,…,gdt−1}.For each {a mathematical formula}bi∈B, we set {a mathematical formula}Gi={gi1,…,git−1}. We set {a mathematical formula}GB=⋃i=13kGi.We set {a mathematical formula}G′ to be a set of (new, distinct) {a mathematical formula}(3k+2)N(t−1) candidates.We construct an election
       </list>
       <paragraph>
        {a mathematical formula}E=(C∪A,V), where {a mathematical formula}C=B∪{p,d}∪Gp∪Gd∪GB∪G′ is the set of initial candidates, {a mathematical formula}A={a1,…,an} is the set of spoiler (i.e., available to add) candidates, and V is a collection of votes. Each candidate {a mathematical formula}ai in A corresponds to set {a mathematical formula}Si in {a mathematical formula}S. We assume that the societal axis L is of the form {a mathematical formula}pLGpLdLGdLb1LG1L⋯Lb3kLG3kLa1L⋯LanLG′. The particular ordering of the garbage candidates is immaterial, but for the sake of specificity, we assume that the candidates from {a mathematical formula}Gp, {a mathematical formula}Gd, and each {a mathematical formula}Gi, {a mathematical formula}1⩽i⩽3k, are listed in the order of increasing upper indices; the ordering of candidates in {a mathematical formula}G′ is immaterial and we assume some easily computable order. Collection V contains the following {a mathematical formula}N+(3k+2)N voters (we specify up to {a mathematical formula}t+1 top candidates for each voter, sometimes—as in the case of the description of the societal axis—including sets of candidates in the preference orders without specifying their relative order; the reader can easily verify that it is possible to implement preference orders of the form given in a swoon-SP society).
       </paragraph>
       <list>
        <list-item label="1.">
         The first N voters are specified as follows:
        </list-item>
        <list-item label="2.">
         The preferences of the remaining {a mathematical formula}(3k+2)N voters are formed as follows. For each candidate c in {a mathematical formula}B∪{p,d} there are exactly N voters that rank c on top and that rank candidates from {a mathematical formula}G′ in the following {a mathematical formula}t−1 positions. We pick the candidates from {a mathematical formula}G′ so that each of them appears among the top t positions in exactly one of these votes. Construction of such votes is possible by making the voters be single peaked with respect to {a mathematical formula}C−{c}—i.e., by letting them swoon to c—and by picking the members of {a mathematical formula}G′ to fill in the votes in consecutive blocks with respect to L.
        </list-item>
       </list>
       <paragraph>
        We note that in election {a mathematical formula}(C,V) the scores of candidates are as follows:
       </paragraph>
       <list>
        <list-item label="1.">
         p has {a mathematical formula}N+2nk+k points,
        </list-item>
        <list-item label="2.">
         d has {a mathematical formula}N+2nk points,
        </list-item>
        <list-item label="3.">
         each candidate {a mathematical formula}bi∈B has {a mathematical formula}N+2nk+2k points,
        </list-item>
        <list-item label="4.">
         each candidate in {a mathematical formula}Gp∪Gd∪GB has fewer than N points, and
        </list-item>
        <list-item label="5.">
         each candidate in {a mathematical formula}G′ has 1 point.
        </list-item>
       </list>
       <paragraph>
        That is, the winners of election {a mathematical formula}(C,V) are exactly the candidates in B. We claim that there is a set {a mathematical formula}A′, {a mathematical formula}A′⊆A, such that {a mathematical formula}‖A′‖⩽k and p is a winner of election {a mathematical formula}(C∪A′,V) if and only if I is a yes instance of X3C (that is, if there exists a collection of exactly k sets from {a mathematical formula}S that union to B; such a collection of sets is called an exact set cover of B).Let {a mathematical formula}A″ be some subset of A. In election {a mathematical formula}(C∪A″,V), the scores of the candidates are as follows: p has score {a mathematical formula}N+2nk+k−‖A″‖, d has score {a mathematical formula}N+2nk, each candidate {a mathematical formula}bi∈B has score {a mathematical formula}N+2nk+2k−2k‖{aj∈A″|bi∈Sj}‖, and each candidate {a mathematical formula}ai∈A″ has score {a mathematical formula}6k+1. The scores of the “garbage” candidates are the same as in {a mathematical formula}(C,V).Assume that p is a winner of election {a mathematical formula}(C∪A″,V). Since dʼs score is {a mathematical formula}N+2nk and pʼs score is {a mathematical formula}N+2nk+k−‖A″‖, it holds that {a mathematical formula}‖A″‖⩽k. Further, for each {a mathematical formula}bi∈B it holds that {a mathematical formula}biʼs score is no larger than that of p. This is possible only if {a mathematical formula}A″ corresponds to an exact set cover of B (the score of each of 3k candidates in B has to be decreased and each {a mathematical formula}aj∈A″ corresponds to decreasing the score of exactly three candidates in B).On the other hand, if {a mathematical formula}A″ corresponds to an exact cover of B, then p is a winner of election {a mathematical formula}(C∪A″,V). In such a case {a mathematical formula}‖A″‖=k and so the score of p is {a mathematical formula}N+2nk. Since each {a mathematical formula}aj∈A″ corresponds to a set {a mathematical formula}Sj∈S that contains three unique members of B, the score of each {a mathematical formula}bi∈B is {a mathematical formula}N+2nk. The score of d is {a mathematical formula}N+2nk as well. Each {a mathematical formula}aj∈A″ has score {a mathematical formula}6k+1&lt;2nk (this is so because {a mathematical formula}n⩾4 and {a mathematical formula}k⩾2) and each “garbage” candidate has score less than N. The proof is complete for CCAC.We now move on to the case of CCDC. CCDC for t-approval over swoon-SP societies is clearly in NP and we focus on proving NP-hardness. We do so by giving a reduction from X3C. Let {a mathematical formula}I=(B,S) be an X3C instance, where {a mathematical formula}B={b1,…,b3k} and {a mathematical formula}S={S1,…,Sn}. Without loss of generality we assume that {a mathematical formula}k⩾1 and {a mathematical formula}n⩾1.We use a similar padding strategy as in the case of CCAC. Let {a mathematical formula}N=(3n)+(n)+(3k(k−1))+(n+1) (each of the parenthesized terms corresponds to the number of voters in the description below). We will use the following sets of “garbage” candidates:
       </paragraph>
       <list>
        <list-item label="1.">
         We set {a mathematical formula}Gp={gp1,…,gpt−1}. We also have an additional “garbage” candidate {a mathematical formula}gpt.
        </list-item>
        <list-item label="2.">
         For each i, {a mathematical formula}1⩽i⩽3k, we set {a mathematical formula}Gi={gi1,…,git−1}. We set {a mathematical formula}GB=⋃i=13kGi.
        </list-item>
        <list-item label="3.">
         We set {a mathematical formula}G′ to be a set of (new, distinct) {a mathematical formula}(4k+2)N(t−1) candidates.
        </list-item>
       </list>
       <paragraph>
        We construct an instance of CCDC for t-approval as follows. Set {a mathematical formula}A={a1,…,an}, set {a mathematical formula}D={d1,…,dk+1}, and let {a mathematical formula}E=(C,V) be an election, where {a mathematical formula}C=B∪A∪D∪{p}∪Gp∪GB∪G′. We use societal axis {a mathematical formula}pLGpLgptLDLb1LG1L⋯Lb3kLG3kLa1L⋯LanLG′ (see the comments regarding axis specification for the CCAC case). V contains the following groups of votes; the reader can easily verify that it is possible to form them in a swoon-SP society with axis L.
       </paragraph>
       <list>
        <list-item label="1.">
         The first N voters are specified as follows:
        </list-item>
        <list-item label="2.">
         The remaining {a mathematical formula}(4k+2)N voters are specified as follows. For each candidate c in {a mathematical formula}B∪D∪{p} there are exactly N voters that rank c on top and that rank candidates from {a mathematical formula}G′ in the following {a mathematical formula}t−1 positions (and, if {a mathematical formula}c≠p, that rank p last). We pick the candidates from {a mathematical formula}G′ so that each candidate from {a mathematical formula}G′ appears among the top t positions in exactly one vote (construction of such votes is possible by making the voters be single-peaked with respect to {a mathematical formula}C−{c}—i.e., by letting them swoon to c—and by picking the members of {a mathematical formula}G′ to fill the votes in consecutive blocks with respect to L).
        </list-item>
       </list>
       <paragraph>
        In this election the candidates have the following scores:
       </paragraph>
       <list>
        <list-item label="1.">
         p has N points,
        </list-item>
        <list-item label="2.">
         each {a mathematical formula}bi∈B has {a mathematical formula}N+k−1 points, and
        </list-item>
        <list-item label="3.">
         each {a mathematical formula}aj, {a mathematical formula}1⩽j⩽n, has 4 points (note that {a mathematical formula}4&lt;N+k−1).
        </list-item>
        <list-item label="4.">
         each candidate {a mathematical formula}di∈D has N points.
        </list-item>
        <list-item label="5.">
         each “garbage” candidate has fewer than N points.
        </list-item>
       </list>
       <paragraph>
        We claim that it is possible to ensure that p is a winner of this election by deleting at most k candidates if and only if I is a yes instance of X3C.First, assume that I is a yes instance of X3C and let {a mathematical formula}A′ be a subset of A such that {a mathematical formula}{Si|ai∈A′} is an exact cover of B. It is easy to see that p is a winner of election {a mathematical formula}E′=(C−A′,V): Compared to E, in {a mathematical formula}E′ the score of p increases by k, the score of each {a mathematical formula}bi∈B increases by 1, and the scores of remaining members of A and of garbage candidates do not change. Thus p and all members of B tie for victory.On the other hand, assume that there exists a set {a mathematical formula}A″⊆C such that if we delete the candidates in {a mathematical formula}A″, then p is a winner of the election. We first note that {a mathematical formula}A″ cannot contain any members of {a mathematical formula}Gp∪{gpt}: If it had, then in the resulting election there would be at least one candidate in D (it is impossible to delete them all) with {a mathematical formula}N+n+1 points, while p can, at best, have {a mathematical formula}N+n points. Further, it is easy to see that deleting any of the candidates in {a mathematical formula}GB and {a mathematical formula}G′ cannot help p. So, we may assume that {a mathematical formula}A″⊆B∪A.Thus assume that there exists a set {a mathematical formula}A″⊆B∪A of candidates, {a mathematical formula}‖A″‖⩽k, such that p is a winner of election {a mathematical formula}E″=(C−A″,V). Since {a mathematical formula}‖A″‖⩽k, there are at least 2k candidates from B in {a mathematical formula}E″ and so the score of p in {a mathematical formula}E″ has to be at least {a mathematical formula}N+k−1, to tie with these candidates. However, the only way to increase pʼs score to {a mathematical formula}N+k−1 (or higher) by deleting at most k candidates is to delete {a mathematical formula}k−1 (or more) candidates from A. Yet if we delete exactly {a mathematical formula}k−1 candidates from A, then there is some candidate {a mathematical formula}bi in the election whose score is at least {a mathematical formula}N+k. Thus {a mathematical formula}A″ must contain exactly k candidates from A. Deleting these candidates increases pʼs score to be {a mathematical formula}N+k. To ensure that the scores of the candidates in B do not exceed {a mathematical formula}N+k, we must ensure that {a mathematical formula}A″ corresponds to an exact cover of B by sets from {a mathematical formula}S. This completes the proof for the CCDC case.  □
       </paragraph>
      </paragraph>
      <paragraph>
       As mentioned earlier, the case of CCAV and CCDV for t-approval under swoon-SP societies is quite involved as well. Although we obtain a polynomial-time algorithm for CCAV, such an algorithm for CCDV (for arbitrary fixed t) remains elusive. However, for the case of CCDV we give a 2-approximation algorithm using an approach that one could dub “deswoonification.”
      </paragraph>
      <paragraph label="Proof">
       For each t, CCAV for t-approval elections is in P for swoon-SP societies.Let our input instance contain set of candidates C, collections of voters V and W over C, societal axis L with respect to which {a mathematical formula}V∪W is swoon-SP, {a mathematical formula}p∈C (the preferred candidate), and a nonnegative integer K (the bound on the number of voters from W that we can add to {a mathematical formula}(C,V) to ensure pʼs victory). We rename the candidates in C so that {a mathematical formula}C={ℓm′,…,ℓ1,p,r1,…,rm″} and the societal axis is {a mathematical formula}ℓm′L⋯Lℓ1LpLr1L⋯Lrm″.Naturally, there is no point in adding voters that do not approve p (i.e., who do not give points to p) and thus we assume that W does not contain voters that do not rank p among their top t candidates. For each i, {a mathematical formula}1⩽i⩽max(m′,m″), we define:{a mathematical formula} Sets {a mathematical formula}C1,…,Cmax(m′,m″) are built as follows: They always include p, a “{a mathematical formula}(t−2)-radius” neighborhood of p (with respect to L), and two {a mathematical formula}(t−1)-candidate intervals (with respect to L); these two intervals may (for small enough i) intersect the neighborhood of p. For every voter in {a mathematical formula}v∈W, the candidates that v ranks in positions 2 though t form a consecutive interval with respect to L and so there exists an i, {a mathematical formula}1⩽i⩽max(m′,m″), such that v ranks candidates from {a mathematical formula}Ci in its t top positions. We partition W into {a mathematical formula}max(m′,m″) subcollections {a mathematical formula}W1,…,Wmax(m′,m″) such that for each {a mathematical formula}Wi, {a mathematical formula}1⩽i⩽max(m′,m″), it holds that each voter in {a mathematical formula}Wi ranks in its top t positions only candidates from {a mathematical formula}Ci; if there are several such partitions of W then we pick one arbitrarily.For each r, {a mathematical formula}r′, i, and s, where:
       <list>
        r, {a mathematical formula}r′, and i are integers such that {a mathematical formula}0⩽r⩽‖V‖+‖W‖, {a mathematical formula}0⩽r′⩽‖W‖, and {a mathematical formula}1⩽i⩽max(m′,m″), and{a mathematical formula}s:Ci→{0,…,‖V‖+‖W‖} is a function (note that {a mathematical formula}‖Ci‖ is bounded by a constant),For each
       </list>
       <paragraph>
        r, i, and s it is easy to compute {a mathematical formula}f(r,0,i,s). The following recursive relation allows us to compute in polynomial time (using standard dynamic-programming techniques) the value of f for other parameters:{a mathematical formula} where:
       </paragraph>
       <list>
        <list-item label="1.">
         {a mathematical formula}r″⩽r′,
        </list-item>
        <list-item label="2.">
         for each {a mathematical formula}c∈Ci−Ci+1 it holds that {a mathematical formula}s″(c)⩽r, and
        </list-item>
        <list-item label="3.">
         there is a collection of {a mathematical formula}r′−r″ voters in {a mathematical formula}Wi+1 such that each candidate c in {a mathematical formula}Ci+1∩Ci is approved by exactly {a mathematical formula}s(c)−s″(c) of these voters and each candidate in {a mathematical formula}Ci+1−Ci is approved by exactly {a mathematical formula}s(c)−score(C,V)(c) of these candidates (intuitively, this is the subcollection of voters from {a mathematical formula}Wi+1 that we add to the election).
        </list-item>
       </list>
       <paragraph>
        Our algorithm accepts if and only if there are values r and {a mathematical formula}r′, {a mathematical formula}0⩽r⩽‖V‖+‖W‖, {a mathematical formula}0⩽r′⩽‖W‖, and a function s, {a mathematical formula}s:Cmax(m′,m″)→{0,…,‖V‖+‖W‖}, such that
       </paragraph>
       <list>
        <list-item label="1.">
         {a mathematical formula}r′⩽K,
        </list-item>
        <list-item label="2.">
         {a mathematical formula}s(p)⩾r,
        </list-item>
        <list-item label="3.">
         for each candidate c in {a mathematical formula}Cmax(m′,m″)−{p} it holds that {a mathematical formula}s(c)⩽r, and
        </list-item>
        <list-item label="4.">
         {a mathematical formula}f(r,r′,max(m′,m″),s)=1.
        </list-item>
       </list>
       <paragraph>
        The correctness and the polynomial running time of the algorithm follow from the definition and properties of f.  □
       </paragraph>
      </paragraph>
      <paragraph label="Proof">
       The following holds for swoon-SP elections. For each t, there is a polynomial-time algorithm that given an instance of CCDV for t-approval elections finds a number s such that the minimal number of voters that we have to delete from our input election in order to ensure the preferred candidateʼs victory is between{a mathematical formula}12sand s.Let {a mathematical formula}E=(C,V) be our input election and let L be our given societal axis with respect to which E is a swoon-SP election. Let p be our preferred candidate. Our algorithm proceeds as follows:
       <list>
        Set {a mathematical formula}V′ to be a subcollection of V containing those voters that give a point to p. Naturally, it never is beneficial to delete any of the voters from {a mathematical formula}V′. Set {a mathematical formula}V″ to be the collection of the remaining voters.Set {a mathematical formula}Vapproval′ (set {a mathematical formula}Vapproval″) to be the collection of {a mathematical formula}2‖V′‖ (of {a mathematical formula}2‖V″‖) voters with approval vectors that is constructed as follows: For each vote {a mathematical formula}v∈V′ (for each vote {a mathematical formula}v∈V″), add to {a mathematical formula}Vapproval′ (to {a mathematical formula}Vapproval″) one voter that approves of vʼs top-ranked candidate and one voter that approves of the {a mathematical formula}t−1 candidates that v ranks in positions {a mathematical formula}2,…,t. (Note that election {a mathematical formula}(C,Vapproval′∪Vapproval″) is single-peaked with respect to L and gives each candidate c in C the same approval score as the t-approval score of c in E.)Find s, the smallest number of voters that we have to delete from approval election {a mathematical formula}E′=(C,Vapproval′∪Vapproval″) to ensure that p is a winner, without deleting any of the voters in {a mathematical formula}Vapproval′. (This can be done in polynomial time using a very easy adaptation of the CCDV algorithm for single-peaked approval elections from Faliszewski et al. [40].{sup:9})Return s.It is clear that the algorithm runs in polynomial time and that it computes a number
       </list>
       <paragraph>
        s such that by deleting at most s voters from election E it is possible to ensure that p is a winner of the resulting election. Assume that it suffices to delete {a mathematical formula}s′ voters from E to ensure that p is a winner. Deleting {a mathematical formula}2s′ voters from {a mathematical formula}E′ (exactly those that correspond to the {a mathematical formula}s′ voters deleted from E) suffices to ensure that p is a winner. This completes the proof.  □
       </paragraph>
      </paragraph>
     </section>
     <section label="6.3">
      {a mathematical formula}Dodgsonk-SP and {a mathematical formula}PerceptionFlipk-SP societies
      <paragraph label="Corollary 6.7">
       For the Dodgson and PerceptionFlip notions of nearness to single-peakedness, we can prove that allowing a constant number of adjacent-swaps (for each voter, separately, in the appropriate structure) still leaves our control problems in P. We start by considering CCAC and CCDC. We call the following result a “corollary” rather than a “theorem,” because in the course of seeking to establish it, we will prove a more general result, Theorem 6.12, from which it follows. For each k and each t, CCAC and CCDC for t-approval elections are in P for{a mathematical formula}Dodgsonk-SP societies and for{a mathematical formula}PerceptionFlipk-SP societies. (Indeed, this theorem holds even if the elections are held using a scoring protocol of the form{a mathematical formula}(α1,…,αt,0,…,0).)
      </paragraph>
      <paragraph>
       Our algorithm for establishing the above theorem exploits the local nature of adding/deleting candidates in single-peaked t-approval elections. Formally, Faliszewski et al. [40] made the following observation.
      </paragraph>
      <paragraph label="Lemma 6.8">
       (Lemma 3.4 of[40].) Let{a mathematical formula}(C,V)be an election where{a mathematical formula}C={c1,…,cm}is a set of candidates, V is a collection of voters whose preferences are single-peaked with respect to societal axis L, and where{a mathematical formula}c1Lc2L…Lcm. Within plurality, if{a mathematical formula}m⩾2then
      </paragraph>
      <list>
       <list-item label="1.">
        {a mathematical formula}score(C,V)(c1)=score({c1,c2},V)(c1),
       </list-item>
       <list-item label="2.">
        for each i,{a mathematical formula}2⩽i⩽m−1,{a mathematical formula}score(C,V)(ci)=score({ci−1,ci,ci+1},V)(ci), and
       </list-item>
       <list-item label="3.">
        {a mathematical formula}score(C,V)(cm)=score({cm−1,cm},V)(cm).
       </list-item>
      </list>
      <paragraph>
       It turns out that this local structure, slightly distorted, still occurs in {a mathematical formula}Dodgsonk-SP societies and in {a mathematical formula}PerceptionFlipk-SP societies. Thus our strategy for proving Corollary 6.7 is to first define formally what we mean by a distorted variant of the above lemma, and then to adapt the CCAC and CCDC algorithms of Faliszewski et al. [40] for single-peaked societies to the distorted setting.
      </paragraph>
      <paragraph label="Definition 6.9">
       Let {a mathematical formula}C={c1,…,cm} be a set of candidates and let L be a linear order over C (the societal axis) such that {a mathematical formula}c1Lc2L⋯Lcm. For each {a mathematical formula}ci∈C and each nonnegative integer k, {a mathematical formula}0⩽k⩽m−1, we define {a mathematical formula}N(L,C,ci,k)={cj||i−j|⩽k}. We call {a mathematical formula}N(L,C,ci,k) the k-radius neighborhood of {a mathematical formula}ci with respect to C and L.
      </paragraph>
      <paragraph label="Definition 6.10">
       Let {a mathematical formula}E=(C,V) be an election held using a voting rule that assigns scores to candidates and as winners chooses the candidate(s) with the highest score. Let L be a linear order over C (the societal axis) and let k be a positive integer. We say that E is k-local with respect to L if for each {a mathematical formula}c∈C and each {a mathematical formula}C′⊆C such that {a mathematical formula}c∈C′ it holds that {a mathematical formula}score(N(L,C′,c,k),V)(c)=score(C′,V)(c).
      </paragraph>
      <paragraph>
       In particular, the proof of Lemma 6.8 (given in Faliszewski et al. [40]) shows that single-peaked plurality elections are 1-local with respect to the societal axis. We extend this result to scoring protocols {a mathematical formula}(α1,…,αt,0,…,0) and to {a mathematical formula}Dodgsonk-SP societies and {a mathematical formula}PerceptionFlipk-SP societies.
      </paragraph>
      <paragraph label="Lemma 6.11">
       Let k and t be two positive integers, let{a mathematical formula}E=(C,V)be an election over scoring protocol{a mathematical formula}α=(α1,…,αt,0,…,0), and let societal axis L be some linear order over C.
      </paragraph>
      <list>
       <list-item label="(a)">
        If E is{a mathematical formula}Dodgsonk-SP with respect to L then E is{a mathematical formula}(k+t)-local with respect to L.
       </list-item>
       <list-item label="(b)">
        If E is{a mathematical formula}PerceptionFlipk-SP with respect to L then E is{a mathematical formula}(k+t)-local with respect to L.
       </list-item>
      </list>
      <paragraph label="Proof">
       We handle each of the cases separately.Case (a). Let {a mathematical formula}E=(C,V) be a {a mathematical formula}Dodgsonk-SP election, where {a mathematical formula}C={c1,…,cm} and where the societal axis L is such that {a mathematical formula}c1Lc2L⋯Lcm. Since for every {a mathematical formula}C′⊆C, {a mathematical formula}(C′,V) is {a mathematical formula}Dodgsonk-SP with respect to L and since E was chosen arbitrarily, it suffices to show that for each candidate {a mathematical formula}ci∈C it holds that {a mathematical formula}score(N(L,C,ci,k+t),V)(ci)=score(C,V)(ci).Consider some vote v in V. Since E is a {a mathematical formula}Dodgsonk-SP election, there is some vote {a mathematical formula}v′ that is single-peaked with respect to L and such that v can be obtained from {a mathematical formula}v′ with at most k swaps of adjacent candidates. Let {a mathematical formula}cj be the peak (i.e., the top-ranked candidate) in {a mathematical formula}v′.We can assume that v is obtained from {a mathematical formula}v′ in the following way. We start with {a mathematical formula}v′. The candidate who is ranked first in v is shifted (using swaps of adjacent candidates) to the first position within the vote (perhaps not using swaps at all, if this candidate happens to be ranked first in {a mathematical formula}v′ as well). Then, the candidate ranked second in v is shifted to the second position, the third one in v is shifted to the third position, and so on. This process goes on, until the vote is identical with v.We make the following observation, which we will call Observation A. Fix a positive integer {a mathematical formula}t″ and let {a mathematical formula}k″ be the smallest number of adjacent swaps of candidates needed to obtain from {a mathematical formula}v′ a vote that agrees with v on the top {a mathematical formula}t″ positions. Let {a mathematical formula}v″ be one such vote. Let {a mathematical formula}Ct″ be the set of candidates ranked in the top {a mathematical formula}t″ positions in {a mathematical formula}v″ and let {a mathematical formula}cx and {a mathematical formula}cy be the leftmost and the rightmost element of {a mathematical formula}Ct″ with respect to L. We claim that it holds that {a mathematical formula}y−x+1⩽t″+k″. Why is this so? Let a and b be such that {a mathematical formula}v′ ranks candidates {a mathematical formula}cj−a,…,cj+b in the top {a mathematical formula}t″ positions (thus {a mathematical formula}a+b=t″−1). Now consider the process of converting {a mathematical formula}v′ to {a mathematical formula}v″. For {a mathematical formula}cx to be among the top {a mathematical formula}t″ candidates, we have to swap {a mathematical formula}cx with at least {a mathematical formula}j−x−a candidates (namely, those that are between {a mathematical formula}cx and the leftmost, with respect to L, candidate ranked among the top {a mathematical formula}t″ in {a mathematical formula}v″; note that {a mathematical formula}j−x−a is a lower bound and thus our analysis still holds even if it is a negative value). For {a mathematical formula}cy to be among the top {a mathematical formula}t″ candidates, we have to swap {a mathematical formula}cy with at least {a mathematical formula}y−j−b candidates (by an analogous argument). The total number of swaps can be at most {a mathematical formula}k″. Thus we have that:{a mathematical formula} which immediately gives that {a mathematical formula}y−x⩽a+b+k″. Since {a mathematical formula}a+b=t″−1, it holds that {a mathematical formula}y−x+1⩽t″+k″.As an immediate consequence of Observation A we have that if {a mathematical formula}ci is among the top t candidates in v, then the remaining candidates that v ranks in the top t positions are in the set {a mathematical formula}N(L,C,ci,k+t). Thus if {a mathematical formula}ci receives any points from v, {a mathematical formula}ci receives exactly the same number of points from v restricted to the candidates in {a mathematical formula}N(L,C,ci,k+t).Now consider the case that {a mathematical formula}ci is not ranked among the top t candidates in v (and thus {a mathematical formula}ci gets zero points from v). We have to show that this is still true even if we restrict the set of candidates to {a mathematical formula}N(L,C,ci,k+t). Let us assume that v ranks {a mathematical formula}t−ℓ candidates from {a mathematical formula}N(L,C,ci,k+t) among the top t positions (but that {a mathematical formula}ci is not among them). Let {a mathematical formula}k′ be the smallest integer such that starting from {a mathematical formula}v′ it is possible to reach a vote that agrees with v in the top t positions (recall the process of reaching one vote from the other outlined above). By Observation A and our assumptions regarding v, within L there must be an interval of at most {a mathematical formula}t+k′ candidates that v ranks in the top t positions, and this interval includes at most {a mathematical formula}t+k′−ℓ candidates from {a mathematical formula}N(L,C,ci,k+t) (at least ℓ candidates lay outside {a mathematical formula}N(L,C,ci,k+t)). In consequence, this interval is either “to the left” or “to the right” of {a mathematical formula}ci with respect to L. Without loss of generality, we assume that it is “to the left” of {a mathematical formula}ci. It is easy to see that in L between the rightmost candidate from the interval and {a mathematical formula}ci, there are at least {a mathematical formula}r=(t+k)−(t+k′−ℓ)=k−k′+ℓ candidates from {a mathematical formula}N(L,C,ci,k+t). Thus if we consider the restriction of v to candidates in {a mathematical formula}N(L,C,ci,k+t), the top t candidates cannot include {a mathematical formula}ci. This is so, because after making the first {a mathematical formula}k′ swaps that transform {a mathematical formula}v′ into a vote that agrees with v on the top t positions, there are still at least r candidates {a mathematical formula}ci−1,…,ci−r ranked ahead of {a mathematical formula}ci but not among the top t candidates (only the ones in the interval where shifted forward). That is, after these {a mathematical formula}k′ swaps, there are {a mathematical formula}t−ℓ+r=t+k−k′ candidates ranked ahead of {a mathematical formula}ci. With {a mathematical formula}k−k′ remaining swaps, it is impossible to ensure that there are at most {a mathematical formula}t−1 candidates ahead of {a mathematical formula}ci.Case (b). Let {a mathematical formula}E=(C,V) be a {a mathematical formula}PerceptionFlipk-SP election, where {a mathematical formula}C={c1,…,cm} and where the societal axis L is such that {a mathematical formula}c1Lc2L⋯Lcm. Since for every {a mathematical formula}C′⊆C, {a mathematical formula}(C′,V) is {a mathematical formula}PerceptionFlipk-SP with respect to L and since E was chosen arbitrarily, it suffices to show that for each candidate {a mathematical formula}ci∈C it holds that {a mathematical formula}score(N(L,C,ci,k+t),V)(ci)=score(C,V)(ci).Consider a vote v that is single-peaked with respect to some societal axis {a mathematical formula}L′ that can be obtained from L by at most k swaps of adjacent candidates. It is easy to see that {a mathematical formula}N(L′,C,ci,t)⊆N(L,C,ci,k+t).Let T be the set of candidates ranked in the top t positions by v. Since v is single-peaked with respect to {a mathematical formula}L′, the candidates in T form a length-t interval within {a mathematical formula}L′. If {a mathematical formula}ci∈T, then {a mathematical formula}T⊆N(L′,C,ci,t), and thus {a mathematical formula}T⊆N(L,C,ci,k+t). It follows immediately that {a mathematical formula}score(N(L,C,ci,k+t),V)(ci)=score(C,V)(ci).It remains to be shown that if {a mathematical formula}ci∉T (and thus gets zero points from v), then {a mathematical formula}ci is not ranked among the top t positions when we restrict v to the candidates in {a mathematical formula}N(L,C,ci,t+k). In {a mathematical formula}L′, {a mathematical formula}ci is either to the left or to the right of interval T. Without loss of generality, we assume that {a mathematical formula}ci is to the right of T. Now consider the set of the t candidates in {a mathematical formula}N(L′,C,ci,t) that lie to the left of {a mathematical formula}ci in {a mathematical formula}L′. Note that v prefers all these t candidates to {a mathematical formula}ci. It follows that when we restrict v to the candidates in {a mathematical formula}N(L′,C,ci,t), {a mathematical formula}ci gets zero points from v. Since {a mathematical formula}N(L′,C,ci,t)⊆N(L,C,ci,k+t), it follows that when we restrict v to the candidates in {a mathematical formula}N(L,C,ci,k+t), {a mathematical formula}ci gets zero points from v.  □
      </paragraph>
      <paragraph>
       Now, Corollary 6.7 is easily seen to be a consequence of the following more general result, Theorem 6.12, which we will establish.
      </paragraph>
      <paragraph label="Theorem 6.12">
       For each constant k and t, CCAC and CCDC for elections over the family of scoring protocols of the form{a mathematical formula}(α1,…,αt,0,…,0)are in P for k-local elections.
      </paragraph>
      <paragraph>
       The lengthy, detailed proof of Theorem 6.12 builds on and generalizes the approaches used by Faliszewski et al. [40] to show that the CCAC and CCDC cases for plurality are in P when voter preferences are single-peaked. We point readers interested in the details of the generalized construction to Section C.3 of Appendix C.
      </paragraph>
      <paragraph label="Proof">
       However, we do have NP-completeness if in {a mathematical formula}Dodgsonk-SP societies or {a mathematical formula}PerceptionFlipk-SP societies we allow the parameter k to increase to {a mathematical formula}m−2, where m is the total number of candidates in the problem instance. (Having this many swaps in effect allows us to use the same technique as for swoon-SP societies.) For each fixed t, CCAC and CCDC for t-approval elections are NP-complete for{a mathematical formula}Dodgsonm−2-SP societies and for{a mathematical formula}PerceptionFlipm−2-SP societies, where m is the total number of candidates in the problem instance.It suffices to note that with this many allowed swaps (both under {a mathematical formula}Dodgsonm−2-SP and under {a mathematical formula}PerceptionFlipm−2-SP) it is possible to implement all the votes used in the proof of Theorem 6.4.  □
      </paragraph>
      <paragraph label="Proof">
       Let us now move on to the case of CCAV and CCDV. As long as the election is either {a mathematical formula}Dodgsonk-SP or {a mathematical formula}PerceptionFlipk-SP for a fixed constant k, it is possible to solve CCAV and CCDV for t-approval elections in polynomial time. This time it is more convenient to work directly with {a mathematical formula}Dodgsonk-SP or {a mathematical formula}PerceptionFlipk-SP elections (and not k-local elections), but we will still rely on facts established in the proof of Lemma 6.11. For each k and each t, CCAV and CCDV for t-approval elections are in P for{a mathematical formula}Dodgsonk-SP societies and for{a mathematical formula}PerceptionFlipk-SP societies. (Indeed, this theorem holds even if the elections are held using a scoring protocol of the form{a mathematical formula}(α1,…,αt,0,…,0).)Let us consider the case of CCAV first. Let {a mathematical formula}E=(C,V∪W) be our input election, where C is the set of candidates, V is the set of initial voters, and W is the set of available-to-add voters. We also have our preferred candidate p and we assume that E is {a mathematical formula}Dodgsonk-SP (or {a mathematical formula}PerceptionFlipk-SP).Naturally, we only add those voters from W to {a mathematical formula}(C,V) who give points to p. Further, let us define a voteʼs “type” to be its ranking of its top t candidates (from our perspective two votes of the same type affect each candidateʼs score in the same way). By the proof of Lemma 6.11, we know that if any vote w in W assigns points to p, then its top t candidates must be in the set {a mathematical formula}N(L,C,p,k+t). Since k and t are fixed constants, there are at most a constant number of different vote types in W. As a result, it is possible to solve the given CCAV instance by a brute-force search through all possible combinations of adding voters of given types.The case of CCDV is a bit more involved. Let {a mathematical formula}E=(C,V) be our input election, where {a mathematical formula}C={c1,…,cm} is the set of candidates and {a mathematical formula}V={v1,…,vn} is the collection of voters. We assume that E is {a mathematical formula}Dodgsonk-SP ({a mathematical formula}PerceptionFlipk-SP) with respect to a given societal axis L. Without loss of generality, we assume that it holds that {a mathematical formula}c1Lc2L⋯Lcm. Further, we have some preferred candidate {a mathematical formula}p∈C (naturally, p is one of the {a mathematical formula}ciʼs, {a mathematical formula}1⩽i⩽m; by adding appropriate candidates and/or solving small instances of the problem by brute-force, without loss of generality, we can assume that {a mathematical formula}p=ci for some i such that {a mathematical formula}i&lt;m−2t−2k).Since E is {a mathematical formula}Dodgsonk-SP ({a mathematical formula}PerceptionFlipk-SP), by the proof of Lemma 6.11 we know that for each vote {a mathematical formula}v∈V there is a candidate {a mathematical formula}ci∈C such that the candidates that v ranks in the top t positions are in the set {a mathematical formula}N(L,C,ci,t+k). Since {a mathematical formula}N(L,C,ci,t+k)⊆N(L,C,ct+k+1,t+k) for all i such that {a mathematical formula}1⩽i⩽t+k+1 and {a mathematical formula}N(L,C,ci,t+k)⊆N(L,C,cm−t−k,t+k) for all i such that {a mathematical formula}m−t−k⩽i⩽m, we know that for each vote {a mathematical formula}v∈V there is a candidate {a mathematical formula}ci∈C such that {a mathematical formula}t+k+1⩽i⩽m−t−k and the candidates that v ranks in the top t positions are in the set {a mathematical formula}N(L,C,ci,t+k). We partition the collection V into {a mathematical formula}m−2(k+t) subcollections {a mathematical formula}Vt+k+1,…,Vm−t−k, so that each vote v in V is placed in subcollection {a mathematical formula}Vi with the smallest i such that vʼs top t candidates are in the set {a mathematical formula}N(L,C,ci,t+k).For each nonnegative integer T, each i, {a mathematical formula}t+k+1⩽i⩽m−t−k, and each vector of nonnegative integers {a mathematical formula}s−t−k,…,st+k we define {a mathematical formula}fT(i,s−t−k,…,st+k) to be the smallest number of voters from {a mathematical formula}Vt+k+1∪⋯∪Vi that have to be deleted from {a mathematical formula}(C,V) to ensure the following conditions:
       <list>
        Each candidate in the set {a mathematical formula}{c1,…,ci−t−k−1}−{p} has score at most T.If p is in the set {a mathematical formula}{c1,…,ci−t−k−1} then pʼs score is exactly T.The scores of candidates {a mathematical formula}ci−t−k,…,ci+t+k are {a mathematical formula}s−t−k,…,st+k, respectively.To complete the proof, it suffices to note that the minimal number of voters that we need to delete is (recall the assumption that for
       </list>
       <paragraph>
        {a mathematical formula}ci=p we have {a mathematical formula}i&lt;m−2t−2k):{a mathematical formula} Clearly, it is possible to compute this value in polynomial time.  □
       </paragraph>
      </paragraph>
     </section>
    </section>
   </content>
   <appendices>
    <section label="Appendix A">
     <section-title>
      Limits on heuristics
     </section-title>
     <paragraph>
      At the end of the Related Work section, we mentioned that given the high hopes of many people for heuristic algorithms, it is extremely important to understand that it follows from known complexity-theoretic results that, unless shocking complexity-class collapses occur, no (deterministic) polynomial-time algorithm can come too close to accepting any NP-hard set. Since that requires a somewhat complexity-theoretic discussion, although one that we hope to be of interest and applicability beyond this paper, we deferred to this brief appendix the further discussion of that claim.
     </paragraph>
     <paragraph>
      It has long been known that if any polynomial-time heuristic correctly solves any NP-hard problem on all but a sparse (i.e., having at most a polynomial number of strings of each length) set of inputs, then {a mathematical formula}P=NP. (Schöning [62] established a precursor of this result that held for appropriately “paddable” NP-hard sets, and the stronger claim we have stated here follows from the 1-truth-table special case of the result of Ogiwara and Watanable [59] that if any NP-bounded-truth-table-hard set is sparse then {a mathematical formula}P=NP.) And so such extremely good heuristic algorithms almost certainly do not exist.
     </paragraph>
     <paragraph>
      But what about less ambitious hopes? Can any (deterministic) polynomial-time algorithm agree with any NP-hard set except for at most {a mathematical formula}nlogO(1)n strings at each length, i.e., the symmetric difference between the set accepted by the algorithm and the NP-hard set has density {a mathematical formula}nlogO(1)n (equivalently, {a mathematical formula}2logO(1)n)?
     </paragraph>
     <paragraph label="Theorem A.1">
      The answer is “no,” unless shocking complexity-theoretic collapses occur. To see this, we note that if such an algorithm existed, then the NP-hard set would polynomial-time 1-truth-table reduce (indeed, it would even reduce by a polynomial-time 1-truth-table reduction that was in addition restricted to a single truth-table, namely, the parity truth-table) to a set of density {a mathematical formula}nlogO(1)n. However, it is known [53], [14] that if any NP-hard set even polynomial-time {a mathematical formula}O(1)-truth-table reduces (i.e., polynomial-time bounded-truth-table reduces) to a set of density {a mathematical formula}nlogO(1)n, then (a) all NP sets can be deterministically solved in time {a mathematical formula}nlogO(1)n, and (b) {a mathematical formula}EXP=NEXP (where {a mathematical formula}EXP=⋃polynomialspDTIME[2p(n)] and {a mathematical formula}NEXP=⋃polynomialspNTIME[2p(n)]), i.e., deterministic and nondeterministic exponential time coincide. Both of these consequences are broadly believed not to hold. (Various additional unlikely collapse consequences follow for the case where we are speaking not merely of NP-hard sets but in fact of NP-complete sets [14], such as the few hard problems discussed in this paper.) So polynomial-time heuristic algorithms are extremely unlikely to be able to come within {a mathematical formula}nlogO(1)n errors-per-length of any NP-hard set.{sup:10}If some polynomial-time heuristic algorithm has at most a quasipolynomial error frequency in accepting some NP-hard set (i.e., if there exist an NP-hard set B and a polynomial-time algorithm A such that Aʼs number of disagreements-at-length-n with B is{a mathematical formula}nlogO(1)n), then deterministic and nondeterministic exponential time coincide, and all NP sets can be accepted in quasipolynomial time.
     </paragraph>
     <paragraph>
      To readers interested in a far more detailed discussion of the complexity-theoretic limits on how well heuristics can do on NP-hard problems, and of how one can harmonize those limits with the observation that heuristics often seem to work well in the real world, we commend the survey of Hemaspaandra and Williams [51]. For example, one might wonder whether the hypothesis of Theorem A.1 implies some collapse of the polynomial hierarchy. As discussed in that survey it indeed does, but the best currently known claim as to how far the polynomial hierarchy collapses under that assumption (namely, the polynomial hierarchy collapses to the class known as “{a mathematical formula}S2NP,” which itself is in general known to be contained in the third level of the polynomial hierarchy) is vastly weaker than the polynomial-hierarchy collapse to P that is known to follow from the (far stronger) hypothesis that there are NP-hard sparse sets. The collapse to {a mathematical formula}S2NP even follows from the hypothesis, which is weaker than that of Theorem A.1, that there is an NP-hard set of subexponential density (see the abovementioned survey for discussion of this). So the density discussed in Footnote 10 is truly the most one can hope for as to how often heuristics can do well on NP-hard problems without inducing seismic complexity-theoretic consequences.
     </paragraph>
    </section>
    <section label="Appendix B">
     The β hierarchy, mavericks, and elections
     <paragraph>
      This section provides a discussion of the issue raised immediately after Theorem 6.1. Namely, it discusses whether Theorem 6.1 is just the tip of an iceberg, and whether that theorem is in fact hiding some broader connection between number of mavericks and computational complexity theory. We wonʼt give this type of discussion for all, or even most, of our theorems. But we feel it is worthwhile and instructive, since Theorem 6.1 is our paperʼs first control result, to look closely at what holds. And what holds is that Theorem 6.1 is indeed in some sense the tip of an iceberg. However, it is an iceberg whose tip is its most interesting part, since it gives the part that admits polynomial-time attacks.
     </paragraph>
     <paragraph>
      Still, the rest of the iceberg brings out an interesting connection between maverick frequency and nondeterminism. Let us think again of the proof of Theorem 6.1. It worked by sequentially generating each member of the powerset of a logarithmic-sized set (call it Q). And we did that, naturally enough, in polynomial time. However, note that we could also have done it with nondeterminism, and we now specify precisely what we mean by this. We can nondeterministically guess for each member of Q whether or not it will be added (for CCAV) or deleted (for CCDV). And then after that nondeterministic guess, we for the CCAV case do the demaverickification presented in Theorem 6.1ʼs proof and for the CCDV case do the deletable/nondeletable marking, and then we run the polynomial-time algorithms for the single-peaked approval-voting CCAV and the approval-voting CCDV (with deletable/nondeletable flag, and all mavericks—those not consistent with the societal ordering—being nondeletable) cases. It is easy to see that Theorem 6.1ʼs proof argument works fine with the change to nondeterminism. Indeed, the reason Theorem 6.1 is about “P” is because sequentially handling {a mathematical formula}O(log(ProblemInputSize)) nondeterministic bits can be done in polynomial time.
     </paragraph>
     <paragraph>
      So, what underlie Theorem 6.1 are the following results that say that frequency of mavericks in oneʼs society exacts a price, in nondeterminism. (We are proving here just an upper bound, but we conjecture that the connection is quite tight—that commonality of wild voter behavior is very closely connected with nondeterminism.) To state the results, we need to introduce some notions from complexity theory. Complexity theorists often separate out the weighing of differing resources, putting bounds on each. The only such class we need here is the class of languages that can be accepted in time {a mathematical formula}t(n) on machines using {a mathematical formula}g(n) bits of nondeterminism, which is typically denoted {a mathematical formula}NONDET-TIME[g(n),t(n)]. The most widely known such classes are those of the limited nondeterminism hierarchy, known as the beta hierarchy, of Kintala and Fisher [54] (see also [19] and the survey [46]). {a mathematical formula}βk is the class of sets that can be accepted in polynomial time on machines that use {a mathematical formula}O(logkn) bits of nondeterminism: {a mathematical formula}βk={L|(∃ polynomial t(n))(∃g(n)∈O(logkn))[L∈NONDET-TIME[g(n),t(n)]], or for short, {a mathematical formula}βk=NONDET-TIME[O(logkn),poly]. (The number of bits of nondeterminism a nondeterministic Turing machine uses can be viewed as looking at nondeterministic machines that make only binary nondeterministic choices, and that along each computation path make at most that number of such choices; see the references above for fully formal, detailed definitions of the classes.) Of course, {a mathematical formula}β0=β1=P. The complexity of the classes {a mathematical formula}βk, {a mathematical formula}k⩾2, is an open issue. They are well-known to have complete sets. Clearly, each problem in {a mathematical formula}βk, {a mathematical formula}k⩾2, can be solved by brute force in deterministic time {a mathematical formula}2O(logkn). Motivated by intuitions about NP, it is natural to conjecture that the deterministic time to solve any complete problem for {a mathematical formula}βk, {a mathematical formula}k⩾2, is unlikely to be {a mathematical formula}2o(logkn).
     </paragraph>
     <paragraph>
      We can now state our result, which says that frequency of mavericity is paid for in nondeterminism.
     </paragraph>
     <paragraph label="Theorem B.1">
      CCAV and CCDV for approval elections over{a mathematical formula}f(⋅)-maverick-SP societies are each in{a mathematical formula}NONDET-TIME[f(ProblemInputSize),poly]. For CCAV, the complexity remains in{a mathematical formula}NONDET-TIME[f(ProblemInputSize),poly]even for the case where no limit is imposed on the number of mavericks in the initial voter set, and the number of mavericks in the set of potential additional voters is{a mathematical formula}f(⋅)-bounded (in the overall problem input size).
     </paragraph>
     <paragraph label="Corollary B.2">
      For each natural number k, CCAV and CCDV for approval elections over{a mathematical formula}O(logkn)-maverick-SP societies are each in{a mathematical formula}βk. For CCAV, the complexity remains in{a mathematical formula}βkeven for the case where no limit is imposed on the number of mavericks in the initial voter set, and the number of mavericks in the set of potential additional voters is{a mathematical formula}O(logkn)-bounded (in the overall problem input size).
     </paragraph>
     <paragraph>
      Theorem 6.1 follows from the more general result, Theorem B.1, above (note the {a mathematical formula}k=1 case of result B.2). This concludes our particularly detailed discussion of CCAV and CCDV for approval voting, in particular, our discussion of how the β hierarchy is connected to it. We have also established similar connections between the β hierarchy, number of mavericks, and the complexity of those same control types for what are known as Condorcet elections. Our results on that, and the related detailed proof, can be found as Theorem 4.4, Corollary 4.5, and part of Appendix C.1 of the technical report version of this paper [39].
     </paragraph>
    </section>
    <section label="Appendix C">
     Deferred proofs from Section 6
     <paragraph>
      In this appendix we provide the deferred proofs from Section 6.
     </paragraph>
     <section label="C.1">
      Proof of Theorem 6.2
      <paragraph>
       The main idea of our proof is analogous to that of the proof of Theorem 6.1 but the details of demaverickification are different and, as a result, we can only handle a constant number of mavericks. We handle the CCAC case first.
      </paragraph>
      <paragraph>
       We will disjunctively truth-table reduce the problem to the variant of CCAC for t-approval and single-peaked voters, where by default the voters have the standard t-approval scoring vector (i.e., one that assigns one point to each of the voterʼs top t candidates) but where some special voters have 1-approval (plurality) scoring vectors. (This variant of CCAC is in P by inspection of the proof of Theorem 6.12.)
      </paragraph>
      <paragraph>
       Let {a mathematical formula}I=(C,A,V,p,K) be our input instance of CCAC for t-approval and let L be the societal axis. Let {a mathematical formula}k′ be the number of mavericks in V ({a mathematical formula}k′⩽k) and let {a mathematical formula}M={m1,…,mk′} be the subcollection of V containing exactly these {a mathematical formula}k′ maverick voters. Our algorithm proceeds as follows:
      </paragraph>
      <list>
       <list-item label="1.">
        For each vector {a mathematical formula}B=(b11,…,b1t,…,bk′1,…,bk′t)∈(C∪A)tk′ of candidates execute the following steps (intuitively, we intend to enforce that for each maverick voter {a mathematical formula}mi, candidates {a mathematical formula}bi1,…,bit are the t candidates that {a mathematical formula}mi gives points to and that it is impossible to change this by adding other candidates). For each i, {a mathematical formula}1⩽i⩽k′, we define {a mathematical formula}Bi={biy|1⩽y⩽t}.
       </list-item>
       <list-item label="2.">
        If the algorithm has not accepted so far, reject.
       </list-item>
      </list>
      <paragraph>
       It is easy to verify that the above algorithm indeed runs in polynomial time: There are exactly {a mathematical formula}‖C∪A‖tk′ choices of vector B to test and for each fixed B each step can clearly be performed in polynomial time. It remains to be shown that the algorithm is correct.
      </paragraph>
      <paragraph>
       Let us assume that I is a yes instance. We will show that in this case the algorithm accepts. Let {a mathematical formula}A″ be a subset of A such that {a mathematical formula}‖A″‖⩽K and p is a winner of election {a mathematical formula}E″=(C∪A″,V). Let {a mathematical formula}D=(d11,…,d1t,…,dk′1,…,dk′t) be the vector of candidates from {a mathematical formula}C∪A″ such that for each i, {a mathematical formula}1⩽i⩽k′, in {a mathematical formula}E″ voter {a mathematical formula}mi ranks the candidates {a mathematical formula}di1,…,dit in the top t positions. We claim that our algorithm accepts at latest when it considers vector {a mathematical formula}B=D. First, by our choice of D it is clear that in Step (1a) we do not drop D. Let {a mathematical formula}C′, {a mathematical formula}A′, {a mathematical formula}K′, and {a mathematical formula}V′ be as computed by our algorithm for {a mathematical formula}B=D. By our choice of D, it is clear that {a mathematical formula}A″−{dxy|1⩽x⩽k′,1⩽y⩽t}⊆A′. Thus there is a set {a mathematical formula}A‴⊆A′ such that {a mathematical formula}‖A‴‖⩽K′ and p is a winner of election {a mathematical formula}(C′∪A‴,V). Further, by the construction of {a mathematical formula}V′ and since every voter {a mathematical formula}mxy, {a mathematical formula}1⩽x⩽k′, {a mathematical formula}1⩽y⩽t, prefers candidate {a mathematical formula}dxy to all other candidates in {a mathematical formula}C′∪A′ (and uses a 1-approval scoring vector), it holds that p is a winner of election {a mathematical formula}(C′∪A‴,V′). That is, {a mathematical formula}(C′,A′,V′,p,K′) is a yes instance.
      </paragraph>
      <paragraph>
       Similarly, it is easy to see that the construction of instances {a mathematical formula}(C′,A′,V′,p,K′), and in particular the construction of {a mathematical formula}V′ in Step (1e), ensures that if the algorithm accepts then I is a yes instance. This completes the discussion of the CCAC case.
      </paragraph>
      <paragraph>
       Let us now move on to the case of CCDC. Again, we will reduce the problem to the case where all voters are single-peaked (where, by default, the voters use t-approval scoring vectors but some special voters use 1-approval scoring vectors) and where there is a subset F of candidates that we are forbidden to delete. (This variant of CCDC is in P by inspection of the proof of Theorem 6.12.)
      </paragraph>
      <paragraph>
       Let {a mathematical formula}I=(C,V,p,K) be our input instance of CCDC for t-approval and let L be the societal axis. Let {a mathematical formula}k′ be the number of mavericks in V ({a mathematical formula}k′⩽k) and let {a mathematical formula}M={m1,…,mk′} be the subcollection of V that contains these {a mathematical formula}k′ maverick voters. Our algorithm works as follows:
      </paragraph>
      <list>
       <list-item label="1.">
        For each vector {a mathematical formula}B=(b11,…b1t,…,bk′1…,bk′t)∈(C∪A)tk′ of candidates execute the following steps (intuitively, we intend to enforce that for each maverick voter {a mathematical formula}mi, candidates {a mathematical formula}bi1,…,bit are the t candidates that {a mathematical formula}mi gives points to and that it is impossible to change this by deleting other candidates). For each i, {a mathematical formula}1⩽i⩽k′, we define {a mathematical formula}Bi={biy|1⩽y⩽t}.
       </list-item>
       <list-item label="2.">
        If the algorithm has not accepted so far, reject.
       </list-item>
      </list>
      <paragraph>
       Using the same arguments as in the case of CCAC, we can see that this algorithm is both correct and runs in polynomial time.  □
      </paragraph>
     </section>
     <section label="C.2">
      Proof of Theorem 6.3
      <paragraph>
       In this proof we will, by a simple extension of the proof of Theorem 6.4, show that allowing the number of mavericks to be some root of the input size cannot be handled either. If {a mathematical formula}ϵ⩾1 then all voters can be mavericks and the theorem certainly holds (because CCAC and CCDC are NP-complete for t-approval with unrestricted votes). Let us consider the case when ϵ is strictly between 0 and 1. In this case we can adapt the proof of Theorem 6.4 by including an appropriate number of padding voters. We use the same notation as in the proof of Theorem 6.4.
      </paragraph>
      <paragraph>
       Let us first handle the case of CCAC. Let {a mathematical formula}(B,S) be an instance of X3C where {a mathematical formula}B={b1,…,b3k} and {a mathematical formula}S={S1,…,Sn}, and let {a mathematical formula}(C,A,V,p,K) be the instance of CCAC for t-approval produced by the reduction in the proof of Theorem 6.4. Let L be the societal axis used in the proof of Theorem 6.4. By definition, {a mathematical formula}(B,S) is a yes instance of X3C if and only if {a mathematical formula}(C,A,V,p,K) is a yes instance of CCAC for t-approval. However, of course, we have no guarantee that V contains at most {a mathematical formula}Iϵ mavericks (with respect to L), where I denotes the input size of {a mathematical formula}(C,A,V,p,K). Yet it is easy to verify that for each positive integer t, {a mathematical formula}(C,A,V,p,K) is a yes instance of CCAC for t-approval if and only if {a mathematical formula}(C,A,V∪Vq′,p,K) is a yes instance of the same problem, where {a mathematical formula}Vq′ is a collection of q blocks of votes that each contain the following {a mathematical formula}3k+2 votes:
      </paragraph>
      <list>
       <list-item label="1.">
        For each i, {a mathematical formula}1⩽i⩽3k, there is a single vote that is single-peaked with respect to L and ranks {a mathematical formula}bi first (followed by the candidates in {a mathematical formula}Gi) and ranks p last{sup:11} (note that, by our choice of L in the proof of Theorem 6.4, such a vote exists).
       </list-item>
       <list-item label="2.">
        There is a single vote that is single-peaked with respect to L and ranks p first (followed by the candidates in {a mathematical formula}Gp).
       </list-item>
       <list-item label="3.">
        There is a single vote that is single-peaked with respect to L and ranks d first (followed by the candidates in {a mathematical formula}Gd) and ranks p last.
       </list-item>
      </list>
      <paragraph>
       By choosing a large enough value of q (but polynomially bounded in {a mathematical formula}I1ϵ), it is possible to form an instance {a mathematical formula}(C,A,V∪Vq′,p,K), whose encoding size is {a mathematical formula}I′, that is a yes instance of CCAC for t-approval if and only if {a mathematical formula}(B,S) is a yes instance of t-approval, and which contains at most {a mathematical formula}I′ϵ mavericks with respect to the societal axis L (namely, the voters in V). This proves our theorem for the CCAC case.
      </paragraph>
      <paragraph>
       Essentially the same proof approach works for the CCDC case. The only difficulty is that now we have to extend the set D to contain {a mathematical formula}(k+1)t candidates, {a mathematical formula}d1,…,d(k+1)t, and modify our blocks of votes (as described for the CCAC case) as follows:
      </paragraph>
      <list>
       <list-item label="1.">
        Delete the vote that ranks d first (we do not have d in the CCDC case).
       </list-item>
       <list-item label="2.">
        Add {a mathematical formula}k+1 single-peaked votes such that altogether these votes assign 1 additional point to every candidate in {a mathematical formula}{d1,…,d(k+1)t} (and each of these votes ranks p last).
       </list-item>
      </list>
      <paragraph>
       The crucial observation here is that the proof of the CCDC case of Theorem 6.4 ensures that deleting candidates outside of the set A is never a successful strategy. Adding the voters {a mathematical formula}Vq′ does not affect this observation because in all votes in {a mathematical formula}Vq′ candidate p is either ranked first or ranked last.  □
      </paragraph>
     </section>
     <section label="C.3">
      Proof of Theorem 6.12
      <paragraph>
       Let t be a fixed constant and let {a mathematical formula}α=(α1,…,αt,0,…,0) be a fixed scoring protocol. We first give a polynomial-time algorithm for CCAC under α, under the assumption that the election is k-local with respect to α and a given societal axis L. Without loss of generality, we assume that there are at least t “initial” candidates (i.e., there are at least t candidates even ignoring all members of the pool of candidates available to add) in the input election.
      </paragraph>
      <paragraph>
       The main idea of our algorithm is the following. Let p be the candidate whose victory we want to ensure in our input k-local instance of CCAC. We first add up to 2k candidates so that the score of p is fixed, and then we run a dynamic programming algorithm that ensures that no candidate has score higher than this fixed score of p. Of course, we do not know which candidates to add in the first part of the algorithm, so we perform an exhaustive search; since k is a constant, it is possible to perform such a search in polynomial time. We will first describe the dynamic programming algorithm in Lemma C.1 and then we will show how to use it in the main algorithm.
      </paragraph>
      <paragraph>
       Let {a mathematical formula}E=(C∪A,V) be a k-local election, where we interpret C as the initial candidates and A as the spoiler candidates. Let L be the societal axis for E. We rename the candidates so that {a mathematical formula}D=C∪A={d1,…,dm} and {a mathematical formula}d1Ld2L⋯Ldm. For each set {a mathematical formula}B⊆D, we define {a mathematical formula}lt(B) to be the minimal (leftmost) element of B with respect to L and {a mathematical formula}rt(B) to be the maximal (rightmost) element of B with respect to L. For each {a mathematical formula}di∈D we define {a mathematical formula}S(di) to be the family of sets {a mathematical formula}{N(L,C∪A′,di,k)|A′⊆A,di∈C∪A′}. The reader can verify that each {a mathematical formula}S(di) contains a number of sets that is at most polynomial in {a mathematical formula}‖C∪A‖k and that each {a mathematical formula}S(di) is easily computable (to compute {a mathematical formula}S(di) it suffices to consider sets {a mathematical formula}A′ of cardinality at most {a mathematical formula}2k+1).
      </paragraph>
      <paragraph label="Proof">
       Let{a mathematical formula}E=(C∪A,V)be an election held under scoring protocol{a mathematical formula}α=(α1,…,αt,0,…,0), where{a mathematical formula}C={c1,…,cm′} ({a mathematical formula}m′⩾t) and{a mathematical formula}A={a1,…,am″}, such that E is k-local for some positive integer k. There exists an algorithm that given election E, integer k, societal axis L with respect to which E is k-local, and a nonnegative integer T ({a mathematical formula}T⩽α1‖V‖) outputs the cardinality of a smallest (in terms of cardinality) set{a mathematical formula}A′⊆Asuch that the scores of all candidates in election{a mathematical formula}(C∪A′,V)are at most T, or indicates that no such set{a mathematical formula}A′exists. This algorithm runs in time polynomial with respect to{a mathematical formula}(‖C∪A‖+‖V‖)k.The proof of this lemma is a much extended version of the proof of Lemma 3.7 of Faliszewski et al. [40]. Let the notation be as in the statement of the lemma. We assume that C is nonempty.We let {a mathematical formula}D=C∪A and, without loss of generality, we rename the candidates so that {a mathematical formula}D={d1,…,dm}, where {a mathematical formula}m=m′+m″, and {a mathematical formula}d1Ld2L⋯Ldm. Without loss of generality, we assume that {a mathematical formula}d1,dm∈C (if this were not the case, we could extend C to include two additional candidates, ranked last by all voters, without destroying k-locality of the election; recall that there already are at least t candidates in C).For each {a mathematical formula}di∈D and each {a mathematical formula}D′∈S(di) we define {a mathematical formula}f(di,D′) to be the cardinality of a smallest (with respect to cardinality) set {a mathematical formula}A′⊆A such that:
       <list>
        For each candidate {a mathematical formula}dj∈C∪A′ such that {a mathematical formula}j⩽i it holds that {a mathematical formula}score(C∪A′,V)(dj)⩽T.If {a mathematical formula}dj′=lt(D′) and {a mathematical formula}dj″=rt(D′) then {a mathematical formula}D′=(C∪A′)∩{dj′,dj′+1,…,dj″}. (Since {a mathematical formula}d1,dm∈C, this is equivalent to {a mathematical formula}D′=N(L,C∪A′,di,k).)Let
       </list>
       <paragraph>
        {a mathematical formula}di be a candidate in D and let {a mathematical formula}D′ be a member of {a mathematical formula}S(di). Intuitively, {a mathematical formula}D′ describes the intended k-radius neighborhood of {a mathematical formula}di. Function {a mathematical formula}f(di,D′) tells us how many candidates from A we need to add to election {a mathematical formula}(C,V) so that in the resulting election the k-radius neighborhood of {a mathematical formula}di is exactly {a mathematical formula}D′ (which fixes the score of {a mathematical formula}di), the score of {a mathematical formula}di is at most T, and the scores of candidates preceding {a mathematical formula}di (in terms of L) also are at most T.Since {a mathematical formula}dm∈C, it is easy to verify that our algorithm should output {a mathematical formula}min{f(dm,D′)|D′∈S(dm)}. Thus, in the rest of the proof we describe how to compute f using dynamic programming.It is easy to see that for each {a mathematical formula}D′∈S(d1) it is possible to directly compute the value {a mathematical formula}f(d1,D′). To compute {a mathematical formula}f(di,D′) for arbitrary {a mathematical formula}di∈D, {a mathematical formula}D′∈S(di), we use the following, natural to derive, recursive relation. Let us fix some {a mathematical formula}di∈D, {a mathematical formula}i&gt;1, and {a mathematical formula}D′∈S(di). Let {a mathematical formula}j=max{j′|j′&lt;i and dj′∈D′}. We observe that:{a mathematical formula} where {a mathematical formula}χA is the characteristic function of A. (Note that if {a mathematical formula}rt(D′)∈D″ for {a mathematical formula}D″∈S(dj), then {a mathematical formula}rt(D′)=dm and so {a mathematical formula}χA(rt(D′))=0.) Using standard dynamic programming techniques we can thus compute f in time polynomial in {a mathematical formula}(‖C∪A‖+‖V‖)k.  □
       </paragraph>
      </paragraph>
      <paragraph>
       We now prove that CCAC for k-local {a mathematical formula}(α1,…,αt,0,…,0) elections is in P.
      </paragraph>
      <paragraph label="Proof">
       For each fixed k, CCAC for k-local{a mathematical formula}α=(α1,…,αt,0,…,0)elections, where the societal axis L is given, is in P.Our input instance contains the following elements: (a) an election {a mathematical formula}E=(C∪A,V), where {a mathematical formula}C={c1,…,cm′} are the initial candidates and {a mathematical formula}A={a1,…,am″} are the spoiler candidates; (b) a candidate p in C (of course, p is one of the {a mathematical formula}ciʼs but we assign him or her also this special name); (c) a nonnegative integer K; (d) a societal axis L over {a mathematical formula}C∪A. We ask if there exists a set {a mathematical formula}A′⊆A such that:
       <list>
        {a mathematical formula}‖A′‖⩽K, andp is a winner of α election {a mathematical formula}(C∪A′,V).We rename the candidates so that
       </list>
       <paragraph>
        {a mathematical formula}D=C∪A={d1,…,dm}, where {a mathematical formula}m=m′+m″ and {a mathematical formula}d1Ld2L⋯Ldm. As in the proof of Lemma C.1, without loss of generality we assume that {a mathematical formula}d1,dm∈C. Let w be an integer such that {a mathematical formula}p=dw.Our algorithm works as follows. For each possible k-radius neighborhood {a mathematical formula}D′ of p (i.e., for each {a mathematical formula}D′∈S(p)) we execute the following steps.
       </paragraph>
       <list>
        <list-item label="1.">
         Set {a mathematical formula}Kp=‖D′∩A‖. ({a mathematical formula}Kp is the number of candidates we need to add to ensure that p has exactly k-radius neighborhood {a mathematical formula}D′.)
        </list-item>
        <list-item label="2.">
         Set {a mathematical formula}T=score(D′,V)(p) (by Eʼs k-locality, T is the score of p in any election where the k-radius neighborhood of p is {a mathematical formula}D′).
        </list-item>
        <list-item label="3.">
         Check how many additional candidates are needed to ensure that no candidate has more than T points:
        </list-item>
        <list-item label="4.">
         If {a mathematical formula}Kp+Kothers⩽K then accept.
        </list-item>
       </list>
       <paragraph>
        If the above procedure does not accept for any {a mathematical formula}D′ then reject.By Lemma C.1 and the fact that k is a fixed constant, it is easy to see that this algorithm works in polynomial time. The correctness is easy to observe as well. □
       </paragraph>
      </paragraph>
      <paragraph>
       We now move on to the case of CCDC for k-local elections held using scoring protocol {a mathematical formula}(α1,…,αt,0,…,0).
      </paragraph>
      <paragraph label="Proof">
       For each fixed k, CCDC for k-local{a mathematical formula}α=(α1,…,αt,0,…,0)elections, where the societal axis L is given, is in P.Let {a mathematical formula}E=(C,V) be our input election, p be the preferred candidate, and K be a nonnegative integer. Our goal is to determine if it is possible to ensure that p is a winner by deleting at most K candidates. Let L be the input societal axis with respect to which E is k-local.We rename the candidates in C so that {a mathematical formula}C={ℓm′,…,ℓ1,p,r1,…,rm″} and {a mathematical formula}ℓm′L⋯Lℓ1LpLr1L⋯Lrm″. Recall that by definition of k-local elections, the score of p depends only on the k candidates “to the left of p” and the k candidates “to the right of p” (with respect to L). Our algorithm works as follows:
      </paragraph>
      <list>
       <list-item label="1.">
        For each subset L of {a mathematical formula}{ℓ1,…,ℓm′} of size at most k and each subset R of {a mathematical formula}{r1,…,rm″} of size at most k execute the following steps:
       </list-item>
       <list-item label="2.">
        Reject.
       </list-item>
      </list>
      <paragraph>
       We now have also completed the proof of Theorem 6.12.  □
      </paragraph>
     </section>
    </section>
   </appendices>
  </root>
 </body>
</html>