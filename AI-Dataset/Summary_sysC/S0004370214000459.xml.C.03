<html>
<head>
<meta name="TextLength" content="SENT_NUM:21, WORD_NUM:525">
</head>
<body bgcolor="white">
<a href="#0" id="0">(Note that {a mathematical formula}d(|q|) does not depend on D but can depend on Σ .)</a>
<a href="#1" id="1">Consider again the OWL 2 QL-ontology {a mathematical formula} Σ ={(1), … ,(4)} and the CQ (5) from the introduction.</a>
<a href="#2" id="2">{a mathematical formula}( ⇐ ) Conversely, suppose {a mathematical formula} Ψ n( Α , Γ )=1, for some Γ .</a>
<a href="#3" id="3">Let {a mathematical formula} Α ′ be the values of the inputs of {a mathematical formula}Cn in Γ .</a>
<a href="#4" id="4">We explain the intuition behind {a mathematical formula} Σ fn, {a mathematical formula}qfn and {a mathematical formula}D Α using the example in Fig.</a>
<a href="#5" id="5">3, where the chase {a mathematical formula}C Σ fn,D Α of {a mathematical formula}( Σ fn,D Α ) is depicted for a particular {a mathematical formula}fn and Α .</a>
<a href="#6" id="6">{a mathematical formula}( ⇒ ) Consider a homomorphism h from {a mathematical formula}qfn to the chase {a mathematical formula}C Σ fn,D Α of {a mathematical formula}( Σ fn,D Α ).</a>
<a href="#7" id="7">We claim that {a mathematical formula} Ψ n( Α , Γ )=1.</a>
<a href="#8" id="8">Take any clause {a mathematical formula}Cj in {a mathematical formula} Ψ n( Α ,g) and consider two cases for {a mathematical formula}h(z0,j).</a>
<a href="#9" id="9">{a mathematical formula}( ⇐ ) Suppose {a mathematical formula} Ψ n( Α , Γ )=1, for some {a mathematical formula} Γ ∈ {0,1}m. We construct a homomorphism h from {a mathematical formula}qfn to the chase {a mathematical formula}C Σ fn,D Α of {a mathematical formula}( Σ fn,D Α ).</a>
<a href="#10" id="10">It is easy to check that h is indeed a homomorphism from {a mathematical formula}qfn into {a mathematical formula}C Σ fn,D Α .</a>
<a href="#11" id="11">It follows that {a mathematical formula} Π fn ″ ,D Α ⊨ G if and only if {a mathematical formula}fn( Α )=1.</a>
<a href="#12" id="12">Denote {a mathematical formula} Μ =max(K,M,N,S), where K is the number of predicates in q and Σ , and S is the number of tgds in Σ .</a>
<a href="#13" id="13">(ii) We show how to construct a polynomial-size {a mathematical formula}NDLQ-rewriting {a mathematical formula}( Π ,G) of q and Σ .</a>
<a href="#14" id="14">(i) Let {a mathematical formula} Γ n(0,1) be the polynomial-size {a mathematical formula}PE{0,1}-rewriting of {a mathematical formula}qfn and {a mathematical formula} Σ fn given by Corollary 13 (i).</a>
<a href="#15" id="15">It remains to show that {a mathematical formula}qfn ′ is an FO-rewriting of {a mathematical formula}qfn and {a mathematical formula} Σ fn ⁎ .Suppose {a mathematical formula}( Σ fn ⁎ ,D) ⊨ qfn.</a>
<a href="#16" id="16">Then, as {a mathematical formula} Γ n(0,1) is a {a mathematical formula}PE{0,1}-rewriting of {a mathematical formula}qfn and {a mathematical formula} Σ fn, we obtain {a mathematical formula}( Σ fn,D) ⊨ qfn.</a>
<a href="#17" id="17">As {a mathematical formula} Φ n computes {a mathematical formula}fn, we have {a mathematical formula}fn( Α )=1, and so, by Lemma 7, {a mathematical formula}( Σ fn,D) ⊨ qfn.</a>
<a href="#18" id="18">In either case, {a mathematical formula}( Σ fn ⁎ ,D) ⊨ qfn.</a>
<a href="#19" id="19">(ii) Let {a mathematical formula}( Φ n,F(0,1)) be the polynomial-size {a mathematical formula}NDL{0,1}-rewriting of {a mathematical formula}qfn and {a mathematical formula} Σ fn given by Corollary 13 (ii).</a>
<a href="#20" id="20">We claim that {a mathematical formula}( Π fn,G) is an NDL-rewriting of {a mathematical formula}qfn and {a mathematical formula} Σ fn ⁎ ; the proof is as in case (i).</a>
</body>
</html>