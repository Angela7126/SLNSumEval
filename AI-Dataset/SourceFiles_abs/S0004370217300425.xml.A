<?xml version="1.0" encoding="utf-8"?>
<html>
 <body>
  <root>
   <title>
    Thick set inversion.
   </title>
   <content>
    <section label="1">
     <section-title>
      Introduction
     </section-title>
     <paragraph>
      Interval-based methods [1], [2] combined with constraint propagation [3], [4], [5] have been shown to be very efficient to deal with continuous constraint satisfaction problems (see, e.g., [6], [7], [8]) and global optimization [9]. A specific and important constraint satisfaction problem is set inversion[10] which can also be interpreted as the inversion of a set-membership constraint [11]. Given a function {a mathematical formula}f:Rn→Rm and a set {a mathematical formula}Y⊂Rm, set inversion aims at bracketing from inside and outside the set{a mathematical formula} This formalism has been used for more than 20 years with interval methods to solve problems in bounded-error parameter estimation [12], robot localization [13], [14], [15] and robust control [16], [17], [18]. Most interval algorithms for set-inversion alternate some interval tests or contractions [19] to certificate that a box (i.e., a Cartesian product of intervals) is inside or outside the solution set {a mathematical formula}X and bisect the boxes for which no conclusion can be reached.
     </paragraph>
     <paragraph label="Example 1">
      In this paper, we consider the case where both f and {a mathematical formula}Y are uncertain. A relaxation of the resulting uncertain constraints can be performed by adding quantifiers as made in [20], [21] for the linear case or by allowing a given number of constraints to be unsatisfied [22]. Here, we assume that {a mathematical formula}f∈[f]=[f−,f+] where {a mathematical formula}f−,f+ are two known functions from {a mathematical formula}Rn to {a mathematical formula}Rm. We also assume that the uncertain set {a mathematical formula}Y satisfies {a mathematical formula}Y⊂⊂Y⊂Y⊃, where {a mathematical formula}Y⊂,Y⊃ are two known subsets of {a mathematical formula}Rm. This amounts to saying that {a mathematical formula}Y belongs to an interval of sets, denoted by {a mathematical formula}〚Y〛, the lower and the upper bound of which are {a mathematical formula}Y⊂ and {a mathematical formula}Y⊃. We say that {a mathematical formula}[f] is a thick function and that {a mathematical formula}〚Y〛 is a thick set (also called set interval[23], [24]). Existing interval methods can still be used to deal with this type of uncertainties but they accumulate on a thick boundary which is called the penumbra. This accumulation makes classical interval methods inefficient, since they spend most of the computation time to test tiny boxes that are inside the penumbra. Consider the set inversion problem {a mathematical formula}X=f−1([y]) with {a mathematical formula}[y]=[0,4]. We assume that f is uncertain and that we only know that for all x{a mathematical formula} with {a mathematical formula}a1∈[0,1], {a mathematical formula}a2∈[0,1]. Note that f is not necessarily a circular paraboloid, and may correspond to any weird function satisfying the enclosure condition. Since, for all x, {a mathematical formula}[f](x) is an interval of {a mathematical formula}R, the function {a mathematical formula}[f] is a thick function. More precisely, we have{a mathematical formula} where{a mathematical formula} and{a mathematical formula} Using a classical interval arithmetic [1], we can easily test if a box {a mathematical formula}[x]=[x1]×[x2] is inside or outside the solution set:{a mathematical formula} Now, we are not able conclude anything if none of these conditions is satisfied. Fig. 1 (left) corresponds to the result of a paver based on these two tests (see the Set Inversion algorithm recalled at Subsection 4.1). Red boxes satisfy the inner test (i), blue boxes satisfy the outer test (ii) and yellow boxes satisfy neither Test (i) nor Test (ii). The yellow boxes are not bisected by the paver since they reached the required accuracy. They cover a zone, called the penumbra, which corresponds to the part of the plane for which both the inner test and the outer test fail. Of course, if we were able to conclude that a box is inside the penumbra, many bisections would have been avoided. We would thus get a picture similar to Fig. 1 (right) which is an approximation of a thick set with the inner part (red), the outer part (blue) and the penumbra (orange).
     </paragraph>
     <paragraph>
      Now, when dealing with practical applications, the penumbra often exists as for instance when we want to characterize the zone that has actually been explored by a robot [25] or in case of partial observability [26]. Characterizing the penumbra from inside will allow us to save computing time, but also to make the difference between the uncertainty due to the computation and that due to the initial uncertainties of the input parameters. The objective of this paper is to extend set inversion to the thick case (where a penumbra exists) and to show how to conclude that a box is inside the penumbra.
     </paragraph>
     <paragraph>
      Notation. The notation to be used in this paper are given in Table 1. Vectors and vector-valued functions are written in bold font. For instance {a mathematical formula}a∈R, {a mathematical formula}b=(b1,b2)∈R2, {a mathematical formula}f(t)=sin(t), {a mathematical formula}g(x)=(x1,x1+x2). As often used in the interval community, intervals are denoted with brackets and sets are in mathbb font. But for thick sets, which are sets of subsets of {a mathematical formula}Rn, we will use the double brackets {a mathematical formula}〚〛.
     </paragraph>
     <paragraph>
      The paper is organized as follows. Section 2 proposes a formalization of the problem and introduces the concept of thick set inversion. Section 3 presents the new notion of thick intervals and thick boxes to be used for solving the thick set-inversion problem. Section 4 generalizes the classical set-inversion algorithm to the thick case by introducing the new notion of thick inclusion function. Section 5 illustrates the principle of the method on five test cases with one involving an actual underwater robot. Section 6 concludes the paper.
     </paragraph>
    </section>
    <section label="2">
     <section-title>
      Problem statement
     </section-title>
     <paragraph>
      This section recalls some notions on lattices and intervals that will be used to formalize the problem of thick set inversion.
     </paragraph>
     <paragraph>
      Lattices. Interval methods can be applied as soon as the set of domains for the variables has a lattice structure [27]. A lattice{a mathematical formula}(E,≤) is a partially ordered set, closed under least upper and greatest lower bounds [28]. The least upper bound of x and y is called the join and is denoted by {a mathematical formula}x∨y. The greatest lower bound is called the meet and is written as {a mathematical formula}x∧y. Let us now give three examples.
     </paragraph>
     <list>
      <list-item label="•">
       The set {a mathematical formula}(Rn,≤) is a lattice with respect to the partial order relation given by {a mathematical formula}x≤y⇔∀i∈{1,…,n},xi≤yi. We have {a mathematical formula}x∧y=(x1∧y1,…,xn∧yn) and {a mathematical formula}x∨y=(x1∨y1,…,xn∨yn) where {a mathematical formula}xi∧yi=min⁡(xi,yi) and {a mathematical formula}xi∨yi=max⁡(xi,yi).
      </list-item>
      <list-item label="•">
       The set {a mathematical formula}(F,≤) of the functions which map {a mathematical formula}R to {a mathematical formula}R is a lattice with respect to the partial order relation given by {a mathematical formula}f≤g⇔∀t∈R,f(t)≤g(t). We have {a mathematical formula}f∧g:t↦min⁡{f(t),g(t)} and {a mathematical formula}f∨g:t↦max⁡{f(t),g(t)}.
      </list-item>
      <list-item label="•">
       The set {a mathematical formula}IR of closed intervals, as introduced by Moore [29], is a complete lattice with respect to the inclusion ⊂. The meet corresponds to the intersection (generally denoted by ∩) and the join corresponds to the interval hull (generally denoted by ⊔). For instance{a mathematical formula}
      </list-item>
     </list>
     <paragraph>
      A lattice {a mathematical formula}E is complete if for all (finite or infinite) subsets {a mathematical formula}A of {a mathematical formula}E, the least upper bound {a mathematical formula}∧A and the greatest lower bound {a mathematical formula}∨A belong to {a mathematical formula}E. When a lattice {a mathematical formula}E is not complete, we can add two elements corresponding to {a mathematical formula}∧A and {a mathematical formula}∨A to make it complete. For instance, the set {a mathematical formula}R is not a complete lattice whereas {a mathematical formula}R‾=R∪{−∞,∞} is. By convention, for the empty set, we set {a mathematical formula}∧∅=∨E and {a mathematical formula}∨∅=∧E.
     </paragraph>
     <paragraph label="Remark 2">
      Intervals. A closed interval (or interval for short) {a mathematical formula}[x] of a complete lattice {a mathematical formula}E is a subset of {a mathematical formula}E which satisfies {a mathematical formula}[x]={x∈E|∧[x]≤x≤∨[x]}. Both ∅ and {a mathematical formula}E are intervals of {a mathematical formula}E. If we denote by {a mathematical formula}IE the set of all intervals of a complete lattice {a mathematical formula}(E,≤) then {a mathematical formula}(IE,⊂) is also a lattice. For two elements {a mathematical formula}[x]=[x−,x+] and {a mathematical formula}[y]=[y−,y+] of {a mathematical formula}IE, we have:{a mathematical formula} The meet {a mathematical formula}[x]∧[y] is called the intersection and will be denoted by {a mathematical formula}[x]∩[y]. The join {a mathematical formula}[x]∨[y] is the interval hull, denoted by {a mathematical formula}[x]⊔[y]. It should not be confused with the classical union ∪ of two intervals. The bracket notation is here used to denote an interval. The brackets can be interpreted as an operator which associates to an unknown variable x, an interval domain {a mathematical formula}[x] which contains it. This operator is used when solving Constraint Satisfaction Problems with intervals [8]. When we define spontaneously an interval {a mathematical formula}[x], then, in the same time, we define implicitly a variable x which is enclosed by {a mathematical formula}[x].
     </paragraph>
     <paragraph>
      Thick set. Denote by {a mathematical formula}(P(Rn),⊂) the powerset of {a mathematical formula}Rn equipped with the inclusion ⊂ as an order relation. {a mathematical formula}P(Rn) is a complete lattice with respect to ⊂. The meet operator corresponds to the intersection and the join to the union. A thick set{a mathematical formula}〚X〛 of {a mathematical formula}Rn is an interval of {a mathematical formula}(P(Rn),⊂). If {a mathematical formula}〚X〛 is a thick set of {a mathematical formula}Rn, there exist [24] two subsets of {a mathematical formula}Rn, called the subset bound{a mathematical formula}X⊂ and the supset bound{a mathematical formula}X⊃ such that{a mathematical formula} A thick set partitions {a mathematical formula}Rn into three zones: the clear zone{a mathematical formula}X⊂, the penumbra{a mathematical formula}X⊃\X⊂ and the dark zone{a mathematical formula}Rn\X⊃. A thick set {a mathematical formula}〚X〛 is a sub-lattice of {a mathematical formula}(P(Rn),⊂), i.e., if {a mathematical formula}A∈〚X〛,{a mathematical formula}B∈〚X〛, then {a mathematical formula}A∩B∈〚X〛 and {a mathematical formula}A∪B∈〚X〛. The set of thick sets of {a mathematical formula}Rn will be denoted by {a mathematical formula}IP(Rn). If for the thick set {a mathematical formula}〚X〛=〚X⊂,X⊃〛, we have {a mathematical formula}X⊂=X⊃ then {a mathematical formula}〚X〛 is said to be thin. It corresponds to a singleton in {a mathematical formula}P(Rn) or equivalently a classical subset of {a mathematical formula}Rn.
     </paragraph>
     <paragraph>
      For thick sets, we have two types of intersection:{a mathematical formula} The first ∩ corresponds to the extension to {a mathematical formula}IP(Rn) of the intersection in {a mathematical formula}P(Rn) whereas the second ⊓ corresponds to the intersection in {a mathematical formula}IP(Rn). Therefore{a mathematical formula} As shown in [23], we have:{a mathematical formula} The same type of relations applies to the union.
     </paragraph>
     <paragraph>
      Notation. We introduce a specific notation involving the quantifier ∀ when dealing with thick sets. Given two thick sets {a mathematical formula}〚A〛 and {a mathematical formula}〚B〛, we define:{a mathematical formula}
     </paragraph>
     <paragraph label="Remark 3">
      Thick function. Denote by {a mathematical formula}(F(Rn,Rm),≤) the set of all functions from {a mathematical formula}Rn→Rm equipped with the order relation ≤ defined as follows{a mathematical formula} The set {a mathematical formula}F(Rn,Rm) is a lattice where the meet and the join are defined by{a mathematical formula} and{a mathematical formula} A thick function{a mathematical formula}[f] from {a mathematical formula}Rn to {a mathematical formula}IRm is an interval of {a mathematical formula}(F(Rn,Rm),≤). For such a thick function {a mathematical formula}[f], there exist two functions {a mathematical formula}f− and {a mathematical formula}f+, called the lower bound and the upper bound such that{a mathematical formula} A thick function {a mathematical formula}[f] is a sublattice of {a mathematical formula}(F(Rn,Rm),≤), i.e., if {a mathematical formula}f∈[f], {a mathematical formula}g∈[f], then {a mathematical formula}f∧g∈[f] and {a mathematical formula}f∨g∈[f]. Again, if {a mathematical formula}f−=f+, {a mathematical formula}[f] is said to be thin and corresponds to a singleton of {a mathematical formula}F(Rn,Rm), or equivalently to a classical function from {a mathematical formula}Rn to {a mathematical formula}Rm. The class of thick functions is not so restrictive. For instance, all set-valued functions of the form{a mathematical formula} where {a mathematical formula}[a] is a box and where f is continuous with respect to a, are thick functions. If now the box [a] is replaced by a disconnected set or when the function f is not scalar anymore, the function {a mathematical formula}F(x) has no reason to be a thick function.
     </paragraph>
     <paragraph label="Example 4">
      Thick set inversion problem. A thick set inversion problem can be written as{a mathematical formula} where {a mathematical formula}〚Y〛 is a thick set and {a mathematical formula}[f] is a thick function. The set {a mathematical formula}X is said to be a feasible solution if{a mathematical formula} The set of all feasible solutions is not a thick set in general as illustrated by the following example. Solving a thick set-inversion problem will amount to finding the smallest thick set which encloses all feasible solutions for (17). Let {a mathematical formula}f(x)=x12+x22 be a thin function from {a mathematical formula}Rn to {a mathematical formula}R, and {a mathematical formula}Y be a set such that {a mathematical formula}[2,3]⊂Y⊂[1,4]. If {a mathematical formula}X=f−1(Y), we have:{a mathematical formula} Now, all feasible {a mathematical formula}X correspond to centered rings and it is clear that the inclusion (19) contains other types of sets as illustrated by Fig. 2.
     </paragraph>
     <paragraph label="Proof">
      Given the thick function{a mathematical formula}[f]and the thick set{a mathematical formula}〚Y⊂,Y⊃〛, the smallest thick set which encloses all sets{a mathematical formula}Xsuch that{a mathematical formula}is the thick set{a mathematical formula}〚X⊂,X⊃〛where{a mathematical formula}Denote by {a mathematical formula}{Xi}i∈I the set of all solutions of (20). The smallest thick set {a mathematical formula}〚X〛 containing {a mathematical formula}{Xi}i∈I is the thick set{a mathematical formula} Now, for each {a mathematical formula}Xi∈{Xi}i∈I,{a mathematical formula} Thus, {a mathematical formula}〚X〛 is given by{a mathematical formula} Now, since {a mathematical formula}f−1 is monotonic with respect to the inclusion ⊂, we get{a mathematical formula} □
     </paragraph>
     <paragraph label="Remark 6">
      Theorem 5 provides the exact formulation of the thick set inversion problem and defines the corresponding two sets we want to compute, i.e., the two sets {a mathematical formula}X⊂ and {a mathematical formula}X⊃ as defined by (21). The main difficulty is to get an inner approximation of the penumbra {a mathematical formula}X⊃\X⊂. This justifies the introduction of the notion of thick intervals introduced in the following section.
     </paragraph>
    </section>
    <section label="3">
     <section-title>
      Thick intervals
     </section-title>
     <paragraph>
      Denote by {a mathematical formula}IR the set of all intervals of {a mathematical formula}R. A thick interval{a mathematical formula}〚x〛 (see, e.g., [30]) is a subset of {a mathematical formula}IR which can be written under the form{a mathematical formula} Here, {a mathematical formula}[x−],[x+] are two intervals containing the lower bound{a mathematical formula}x−∈R and the upper bound{a mathematical formula}x+∈R of an uncertain interval {a mathematical formula}[x−,x+]. If we define the two intervals {a mathematical formula}[x⊂]=[x−]∩[x+] and {a mathematical formula}[x⊃]=[x−]⊔[x+] of {a mathematical formula}R, called the subset bound and the supset bound of {a mathematical formula}〚x〛 then{a mathematical formula} with an equality if {a mathematical formula}[x−]∩[x+]≠∅. As a consequence, a thick interval is not necessarily a thick set: it is more precise or equivalently it is narrower. This can be explained using the endpoints diagram[31] (see Fig. 3) where an interval is seen as a point of {a mathematical formula}R2. For instance, to the interval {a mathematical formula}[1,7], we associate the point with coordinates {a mathematical formula}(1,7). The degenerated intervals, such as {a mathematical formula}[2,2], all belong to the diagonal. This representation provides a geometrical representation of the relation between intervals. For instance, {a mathematical formula}[x]⊂[y] if {a mathematical formula}[y] is at the top left of {a mathematical formula}[x]. The intersection between two intervals (or the interval hull) is obtained by taking the bottom-right corner (or the top left corner) of the smallest box which encloses the two interval points. For instance, if {a mathematical formula}[x]=[1,4] and {a mathematical formula}[y]=[2,5], the enclosing interval box is painted in red. The top left interval is {a mathematical formula}[x]∪[y]=[1,5] and the bottom-right interval is {a mathematical formula}[x]∩[y]=[2,4]. This red box corresponds to the thick box {a mathematical formula}〚a〛=〚[1,2],[4,5]〛. The subset and supset bounds are {a mathematical formula}[a⊂]=[2,4] and {a mathematical formula}[a⊃]=[1,5].
     </paragraph>
     <paragraph>
      In this figure, the orange polygon corresponds to the thick interval {a mathematical formula}〚b〛=〚[3,7],[6,8]〛. The subset and supset bounds are {a mathematical formula}[b⊂]=∅ and {a mathematical formula}[b⊃]=[3,8]. As illustrated by the gray zone of Fig. 3 (left), a subset–supset representation adds pessimism when the subset bound is empty, i.e., a subset–supset representation may contain more intervals. For instance, if {a mathematical formula}[b]=[4,5], we have {a mathematical formula}∅⊂[b]⊂[3,8], but {a mathematical formula}[b]∉〚[3,7],[6,8]〛. The corresponding lower and upper interval bounds are represented on Fig. 3 (right). Note that when the subset bound is not empty (as for the thick box {a mathematical formula}〚a〛 in red), no pessimism is added and both representations are equivalent.
     </paragraph>
     <paragraph>
      Due to this pessimism, we will prefer to use a representation based on lower-upper bounds instead of the notation based on the subset–supset bounds. As already seen for thick sets (see (11)), set membership operations such as the union or the intersection can easily be extended to thick intervals. An extension for all classical operators of interval arithmetic is also valid. More precisely, if {a mathematical formula}⋄∈{+,−,⋅,∩,⊔,…}, we define{a mathematical formula} For instance, if {a mathematical formula}〚a〛=〚[1,2],[4,5]〛 and {a mathematical formula}〚b〛=〚[3,7],[6,8]〛, we have{a mathematical formula} An interpretation for these formula is the following: if {a mathematical formula}[a]∈〚a〛 and {a mathematical formula}[b]∈〚b〛 then the intervals {a mathematical formula}[x]=[a]+[b], {a mathematical formula}[y]=[a]∩[b], {a mathematical formula}[z]=[a]⊔[b] satisfy {a mathematical formula}[x]∈〚a〛+〚b〛, {a mathematical formula}[y]∈〚a〛∩〚b〛, {a mathematical formula}[z]∈〚a〛⊔〚b〛.
     </paragraph>
     <paragraph label="Example 8">
      The following proposition shows how to compare, from a practical point of view, two thick intervals. Given two thick intervals{a mathematical formula}〚a〛=〚[a−],[a+]〛and{a mathematical formula}〚b〛=〚[b−],[b+]〛, we have{a mathematical formula}(i) Consider two intervals {a mathematical formula}[a] and {a mathematical formula}[b] of {a mathematical formula}R. (i) The inclusion {a mathematical formula}[a]⊂[b] is satisfied iff{a mathematical formula} Thus, the inclusion is true for all {a mathematical formula}[a]∈〚a〛 and all {a mathematical formula}[b]∈〚b〛 iff (i) is satisfied.(ii) We have {a mathematical formula}[a]⊄[b] iff {a mathematical formula}b−&gt;a− or a+&gt;b+. Thus, the inclusion is unsatisfied for all {a mathematical formula}[a]∈〚a〛 and all {a mathematical formula}[b]∈〚b〛 iff (ii) is satisfied.(iii) The two intervals {a mathematical formula}[a] and {a mathematical formula}[b] are disjoint iff {a mathematical formula}b−&gt;a+ or a−&gt;b+. Therefore, they are disjoint for all {a mathematical formula}[a]∈〚a〛 and all {a mathematical formula}[b]∈〚b〛 iff (iii) is true.(iv) The two intervals {a mathematical formula}[a] and {a mathematical formula}[b] overlap iff {a mathematical formula}b−≤a+ and a−≤b+. Thus, they overlap for all {a mathematical formula}[a]∈〚a〛 and all {a mathematical formula}[b]∈〚b〛 iff (iv) is true.The two intervals {a mathematical formula}[a]=[1,5] and {a mathematical formula}[b]∈〚b〛=〚[2,4],[3,6]〛, depicted in Fig. 4, overlap for all feasible {a mathematical formula}[b], i.e., {a mathematical formula}([a]∩〚b〛≠∅)∀. This can be checked using Proposition 7, iv:{a mathematical formula} Note that using the subset–supset bounds, we could not reach this conclusion. Indeed, the subset–supset approximation of {a mathematical formula}〚b〛 is{a mathematical formula} The interval {a mathematical formula}[b]=[6,6] is consistent with this inclusion and does not intersect {a mathematical formula}[a]. The green zone represents {a mathematical formula}[a]∩〚b〛, the set of all intervals {a mathematical formula}[a]∩[b] such that {a mathematical formula}[b]∈〚b〛.
     </paragraph>
     <paragraph>
      Thick boxes. Denote by {a mathematical formula}IRn the set of all boxes of {a mathematical formula}Rn. A thick box{a mathematical formula}〚x〛 is a set of boxes of {a mathematical formula}IRn which can be defined as{a mathematical formula} where {a mathematical formula}[x−] and {a mathematical formula}[x+] are boxes of {a mathematical formula}Rn. The set of thick boxes of {a mathematical formula}Rn is denoted by {a mathematical formula}IIRn. A thick box can be seen as an interval of boxes, i.e., an interval of intervals of {a mathematical formula}Rn. This is illustrated by Fig. 5 which shows four thin boxes all contained in the thick box {a mathematical formula}〚x〛=〚[x−],[x+]〛. Since the two box bounds of {a mathematical formula}[x−] and {a mathematical formula}[x+] are boxes of {a mathematical formula}Rn, we could decompose them as the Cartesian product of n intervals:{a mathematical formula} We define the ith component {a mathematical formula}〚xi〛 of the thick box {a mathematical formula}〚[x−],[x+]〛 as the thick interval {a mathematical formula}〚xi〛=〚[xi−],[xi+]〛.
     </paragraph>
     <paragraph label="Proposition 9">
      The following proposition will allow us to compare two thick boxes, with respect to the inclusion, from their interval components. Given two thick boxes{a mathematical formula}〚a〛=〚[a−],[a+]〛and{a mathematical formula}〚b〛=〚[b−],[b+]〛of{a mathematical formula}Rn, we have{a mathematical formula}
     </paragraph>
     <paragraph label="Proof">
      This proof is a direct consequence of Proposition 7 and of the fact that{a mathematical formula} □
     </paragraph>
    </section>
    <section label="4">
     <section-title>
      Thick set inversion
     </section-title>
     <paragraph>
      This section generalizes to set inversion algorithm [32] to the thick case, as defined by Theorem 5.
     </paragraph>
     <section label="4.1">
      <section-title>
       Set inversion
      </section-title>
      <paragraph>
       Given a function f from {a mathematical formula}Rn to {a mathematical formula}Rm and a (thin) set {a mathematical formula}Y⊂Rn, solving the set inversion problem, denoted by {a mathematical formula}X=f−1(Y), is classically performed using an inclusion function{a mathematical formula}[f]:IRn→IRm of f[1], i.e., an interval function such that{a mathematical formula} Most algorithms for set-inversion decompose {a mathematical formula}Rn into boxes [33], [32]. If a given box {a mathematical formula}[x] satisfies {a mathematical formula}[f]([x])⊂Y then it is proved to be inside the solution set {a mathematical formula}X. If {a mathematical formula}[f]([x])∩Y=∅ then it is proved to be outside {a mathematical formula}X. If it satisfies none of the previous tests, it is bisected until it becomes too small. A possible implementation for set inversion is given by Algorithm 1 which is called Sivia (Set Inversion Via Interval Analysis) [32].
      </paragraph>
      <paragraph>
       When the algorithm terminates, we have [32]{a mathematical formula}
      </paragraph>
      <paragraph>
       For the thick case, we have a thick function {a mathematical formula}[f] from {a mathematical formula}Rn to {a mathematical formula}IRm and a thick set {a mathematical formula}〚Y〛∈IP(Rn). We want to compute an approximation of the set of all sets {a mathematical formula}X=f−1(Y), assuming that {a mathematical formula}f∈[f] and {a mathematical formula}Y∈〚Y〛. This problem, formalized by Theorem 5, is called a thick set inversion problem, denoted by{a mathematical formula} We propose to compute an approximation of {a mathematical formula}〚X〛 by decomposing {a mathematical formula}Rn into three subsets: the clear zone {a mathematical formula}X⊂, the penumbra {a mathematical formula}X⊃\X⊂ and the dark zone {a mathematical formula}Rn\X⊃. In our approach, a paver performs the decomposition of {a mathematical formula}Rn into boxes and a thick extension of an inclusion function is used to classify boxes.
      </paragraph>
     </section>
     <section label="4.2">
      <section-title>
       Thick inclusion function
      </section-title>
      <paragraph>
       The function {a mathematical formula}〚f〛:IRn→IIRm is a thick inclusion function of the thick function {a mathematical formula}[f]:Rn→IRm if{a mathematical formula}
      </paragraph>
      <paragraph label="Proof">
       Consider a thick function{a mathematical formula}[f](x)and denote by{a mathematical formula}[f−],[f+]two inclusion functions for the bounds{a mathematical formula}f−,f+of{a mathematical formula}[f]. The function{a mathematical formula}〚f〛: {a mathematical formula}IRn→IIRmdefined by{a mathematical formula}is a thick inclusion function for{a mathematical formula}[f](x).Since {a mathematical formula}[f−],[f+] are two inclusion functions for {a mathematical formula}f−,f+, we have{a mathematical formula} Now, the right hand side is equivalent to {a mathematical formula}[f](a)∈〚f〛([x]).  □
      </paragraph>
      <paragraph>
       As illustrated by Fig. 6, the thick box {a mathematical formula}〚f〛([x]) encloses the set of all boxes {a mathematical formula}[f](a) with {a mathematical formula}a∈[x]. The vector {a mathematical formula}a∈[x]⊂R2 has an image {a mathematical formula}[f](a) which is a box of {a mathematical formula}R2 with a lower bound {a mathematical formula}f−(a) and an upper bound {a mathematical formula}f+(a). Using a classical interval arithmetic, we are able to get inclusion functions {a mathematical formula}[f−] and {a mathematical formula}[f+] for {a mathematical formula}f− and {a mathematical formula}f+. The boxes {a mathematical formula}[f−]([x]) and {a mathematical formula}[f+]([x]) contain {a mathematical formula}f−(a) and {a mathematical formula}f+(a). Therefore, the box {a mathematical formula}[f](a) is inside the thick box {a mathematical formula}〚f〛([x])=〚[f−]([x]),[f+]([x])〛.
      </paragraph>
     </section>
     <section label="4.3">
      <section-title>
       Algorithm
      </section-title>
      <paragraph>
       Algorithm 2, named ThickSivia (Thick Set Inversion Via Interval Analysis), provides an approximation of the solution of the thick set inversion problem {a mathematical formula}〚X〛=[f]−1(〚Y〛). The input of this algorithm are (1) the box {a mathematical formula}[x] which is assumed to be large enough to contains {a mathematical formula}X⊃, the upper bound of {a mathematical formula}〚X〛, (2) an accuracy {a mathematical formula}ε&gt;0, (3) the thick inclusion function {a mathematical formula}〚f〛, and (4) thick set {a mathematical formula}〚Y〛. The output is an approximation of the thick set {a mathematical formula}〚X〛=〚X⊂,X⊃〛. The algorithm decomposes the initial box {a mathematical formula}[x] into four non-overlapping subpavings: (1) The inner subpaving {a mathematical formula}Lclear which contains boxes that have been proved to be inside the clear zone {a mathematical formula}X⊂, (2) the outer subpaving {a mathematical formula}Ldark which contains boxes that have been proved to be outside {a mathematical formula}X⊃ (i.e., inside the dark zone), (3) the subpaving {a mathematical formula}Lpenumbra which contains boxes that have been proved to be inside the penumbra {a mathematical formula}X⊃\X⊂ and (4) the subpaving made with boxes that have been rejected (for which nothing is known and with a width smaller than the desired level of precision ε).
      </paragraph>
      <paragraph label="Remark 11">
       In the algorithm, we have several tests on thick boxes that require comparisons on thick boxes as introduced in Section 3. Consider for instance the test {a mathematical formula}(〚f〛([x])∩Y⊃=∅)∀ and assume that {a mathematical formula}Y⊃ is made with boxes {a mathematical formula}{[y](1),…,[y](k¯)} (this will be the case in the applications presented in Section 5). Since we have{a mathematical formula} Our test amounts to checking that {a mathematical formula}(〚a〛∩[b]=∅)∀ where {a mathematical formula}〚a〛=〚f〛([x]) and {a mathematical formula}[b]=[y](k). Therefore{a mathematical formula} where {a mathematical formula}lb([ai]+) is the lower bound of the interval {a mathematical formula}[ai]+ and {a mathematical formula}ub([ai]−) is the upper bound of {a mathematical formula}[ai]−. We thus get Algorithm 3. The same type of algorithm applies to test if {a mathematical formula}(〚f〛([x])⊂Y⊂)∀ or {a mathematical formula}(〚f〛([x])∩(Y⊃\Y⊂)≠∅)∀.
      </paragraph>
     </section>
     <section label="4.4">
      <section-title>
       Properties
      </section-title>
      <section label="4.4.1">
       <section-title>
        Termination
       </section-title>
       <paragraph>
        The algorithm always terminates in less than {a mathematical formula}λ=(with([x])ε)dim(x) iterations, where {a mathematical formula}[x] is the input box. The number λ is huge and corresponds to the worst case situation where all tests fail and the algorithm returns {a mathematical formula}Xclear=∅, {a mathematical formula}Xpenumbra=∅, {a mathematical formula}Xdark=∅. In practice, as shown in [34] the number of iterations is {a mathematical formula}O(A(1ε)dim(x)−1), where A is the area of the accumulation zone which is composed here with the boundary of the penumbra.
       </paragraph>
      </section>
      <section label="4.4.2">
       <section-title>
        Enclosure
       </section-title>
       <paragraph label="Proof">
        The algorithm computes guaranteed inner and outer approximations of the solution set of the thick set inversion problem. This is asserted by the following theorem. The algorithm returns an approximation of the thick set inversion problem{a mathematical formula}〚X⊂,X⊃〛=[f]−1(〚Y〛)under the form of 3 subpavings (i.e., union of boxes):{a mathematical formula}Lclear,{a mathematical formula}Lpenumbra,{a mathematical formula}Ldark. This approximation satisfies{a mathematical formula}To prove the Theorem, we need to show that, for a box {a mathematical formula}[x], we have (see Fig. 7):{a mathematical formula}Let us first prove (i). The left hand side of (i) implies that{a mathematical formula} Take {a mathematical formula}x∈[x], and we show that {a mathematical formula}x∈X⊂. Since {a mathematical formula}x∈[x], we have {a mathematical formula}〚f〛(x)⊂〚f〛([x]) and the previous formula implies.{a mathematical formula} Now, {a mathematical formula}〚f〛(x) is a singleton in {a mathematical formula}IRn which contains the single box {a mathematical formula}[f](x). Thus, (43) becomes {a mathematical formula}[f](x)⊂Y⊂, which implies{a mathematical formula} or equivalently {a mathematical formula}∀f∈[f],x∈f−1(Y⊂). We get{a mathematical formula}The same reasoning applies to prove (ii). For (iii), assume that the left hand side of (iii) is satisfied. Take one {a mathematical formula}x∈[x], the quantity {a mathematical formula}〚f〛([x]) becomes a singleton in {a mathematical formula}IRn, i.e., a box of {a mathematical formula}Rn. We have{a mathematical formula} Thus, from (21), we get {a mathematical formula}[x]⊂X⊃\X⊂.  □
       </paragraph>
      </section>
      <section label="4.4.3">
       <section-title>
        Convergence
       </section-title>
       <paragraph label="Remark 15">
        We now provide some convergence properties of our algorithm. We need first to define the convergence of a thick inclusion function {a mathematical formula}〚f〛. This convergence can be interpreted as the continuity of the thick function {a mathematical formula}〚f〛([x]) around intervals {a mathematical formula}[x] which are degenerated (i.e., the box {a mathematical formula}[x] is a singleton). The thick inclusion function {a mathematical formula}〚f〛([x]) for {a mathematical formula}[f]([x]) is said to be convergent if for all {a mathematical formula}a∈Rn, for all sequences of boxes {a mathematical formula}[x](k) and {a mathematical formula}[y](k), we have{a mathematical formula} where {a mathematical formula}dH is the Hausdorff distance between compact sets [35].For a given ε, our algorithm provides three lists{a mathematical formula}Lclear(ε),{a mathematical formula}Lpenumbra(ε)and{a mathematical formula}Ldark(ε). Take a pointa. For ε sufficiently small we have{a mathematical formula}where{a mathematical formula}int(A)denotes the interior of the set{a mathematical formula}A[35].The proof is by contradiction. Assume that for all ε the box containing a is never classified. It means that there exists a sequence of boxes {a mathematical formula}[x](k) converging to a such that none of the three tests is satisfied for all {a mathematical formula}[x](k).(i) Since for all k, {a mathematical formula}(〚f〛([x](k))⊂Y⊂)∀ is false, there exists a sequence {a mathematical formula}[y](k)∈〚f〛([x](k)) such that {a mathematical formula}([y](k)⊂Y⊂) is false. Now, since {a mathematical formula}〚f〛 is a convergent thick inclusion function for {a mathematical formula}[f], {a mathematical formula}dH([y](k),[f](a))→0. Since {a mathematical formula}int(Y⊂) is an open set, we cannot have {a mathematical formula}[f](a)⊂int(Y⊂).(ii) Since for all k, {a mathematical formula}(〚f〛([x])(k)∩Y⊃=∅)∀ is false, using the same reasoning as for (i), we get that we cannot have {a mathematical formula}[f](a)⊂int(Y⊃‾).(iii) Since for all k,{a mathematical formula}(〚f〛([x])(k)∩(Y⊃\Y⊂)≠∅)∀ is false, again, we conclude that we cannot have {a mathematical formula}([f](a)∩int(Y⊃\Y⊂)≠∅).As a consequence, we get that if either (i), (ii) or (iii) is satisfied then a will be classified inside one of the three lists. Moreover, from Equation (41), we get that a will be classified on the right list. □For any box {a mathematical formula}[y], we always have {a mathematical formula}[y]⊂Y⊂ or {a mathematical formula}[y]⊂Y⊃‾ or {a mathematical formula}[y]∩(Y⊃\Y⊂)≠∅. Moreover, in a generic situation, we have {a mathematical formula}[y]⊂int(Y⊂) or {a mathematical formula}[y]⊂int(Y⊃‾) or {a mathematical formula}[y]∩int(Y⊃\Y⊂)≠∅. Therefore, Theorem 14 tells us that the part of the search space which will not be classified are rare. Except in atypical situations, these regions will correspond to the boundaries of the penumbra {a mathematical formula}X⊃\X⊂.
       </paragraph>
      </section>
     </section>
    </section>
    <section label="5">
     <section-title>
      Test-cases
     </section-title>
     <paragraph>
      This section provides five test-cases to illustrate the efficiency of our method. All these test cases solve a thick inversion problem {a mathematical formula}〚X〛=[f]−1(〚Y〛). In the figures, all red boxes are shown to be inside the clear zone {a mathematical formula}X⊂; all blue boxes are inside the dark zone, i.e., outside {a mathematical formula}X⊃; all orange boxes are proved to be inside the penumbra. Nothing is known for the small yellow boxes.
     </paragraph>
     <paragraph>
      Test-case 1.Thick translation. Consider the thick set {a mathematical formula}〚Y〛=[Y⊂,Y⊃] where {a mathematical formula}Y⊂,Y⊃ are two disks with center {a mathematical formula}(0,0) and with radius {a mathematical formula}r⊂=1 and {a mathematical formula}r⊃=2, respectively. Consider the thick function {a mathematical formula}[f](x)=x−[v] where {a mathematical formula}[v]=[0.7,1.3]×[−0.02,0.02]. Fig. 8 represents an approximation of {a mathematical formula}〚X〛=[f]−1(〚Y〛) using three types of intervals: the classical intervals (left), the thick intervals with a subset–supset representation (center) and the thick intervals defined by lower-upper interval bounds (right). These results have been obtained with {a mathematical formula}ε=0.1 and the frame box corresponds to {a mathematical formula}[−2,4]×[−2,4]. These figures have been generated in 2.1 sec for the left figure; 0.21 sec for the centered figure and 0.19 for the right figure. As we can see on this figure, the penumbra is better (i.e., without any uncertain boxes inside) characterized with a lower/upper bound representation for the thick intervals.
     </paragraph>
     <paragraph>
      We compared the computing time (on a processor i5-2520M @ 2.50 GHz) and the number of bisections with the traditional approach (which does not characterize the penumbra) and our method. We get the table below. We observe that when ε is small, classical methods are much less efficient due to the fact many bisections take place inside the penumbra. This observation is also valid for all five test-cases considered in this paper.{a mathematical formula}
     </paragraph>
     <paragraph>
      Test-case 2.Tolerable-United solution sets. Consider the interval linear system [21]{a mathematical formula} The left hand side corresponds to a thick function and the right hand side corresponds to a thin set. The solution set {a mathematical formula}〚X〛=〚X⊂,X⊃〛 has for subset bound the tolerable solution set{a mathematical formula}X⊂ for supset bound the united solution set{a mathematical formula}X⊃[36]. Some techniques have been developed to approximate these sets [37] in the linear case. They are mainly based on the Kaucher interval arithmetic [38], [39] and may be used to find boxes inside the penumbra. Now, these methods have mainly been developed to deal with linear interval problems and cannot be used to find boxes inside the penumbra for general nonlinear problems as for the two following test-cases. For this example, the thick set-inversion algorithm provides the paving of Fig. 9, in less than 0.4 sec, for {a mathematical formula}ε=0.01.
     </paragraph>
     <paragraph>
      Test-case 3.Parameter estimation. Consider the parametric model{a mathematical formula} where {a mathematical formula}x=(x1,x2) is the parameter vector and {a mathematical formula}t∈R is the time. At time {a mathematical formula}ti, we collect measurements {a mathematical formula}yi with some interval uncertainties as written in Table 2. Note that one of the main difficulties of this problem is that uncertainties exist on the independent variable (here the time) [40], [41]. In our formulation, the uncertainty of the {a mathematical formula}ti is stored inside the model under the form of a thick function.
     </paragraph>
     <paragraph>
      The set of all feasible parameter vectors is{a mathematical formula} If we define the thick function{a mathematical formula} and the box{a mathematical formula} then the thick set {a mathematical formula}〚X〛=〚X⊂,X⊃〛=[f]−1(Y) is composed with the two sets{a mathematical formula} and{a mathematical formula} For {a mathematical formula}ε=0.1, the thick set-inversion algorithm computes an approximation of the thick set {a mathematical formula}〚X⊂,X⊃〛 as represented by Fig. 10. The left figure is obtained in 1.8 sec and contains 10337 boxes. The right figure is obtained in 0.2 sec and contains 2744 boxes.
     </paragraph>
     <paragraph>
      Test-case 4.Communication area. Consider p marks {a mathematical formula}m(i) located at position {a mathematical formula}(m1(i),m2(i)) given by Table 3 and a robot at the position {a mathematical formula}x=(x1,x2).
     </paragraph>
     <paragraph>
      The robot is able to communicate with the mark {a mathematical formula}m(i) if its distance to the mark is smaller than 10 m, i.e., if {a mathematical formula}‖x−m(i)‖&lt;10. The communication is not possible if the distance is larger than 20 m. With a distance inside {a mathematical formula}[10,20], the communication is uncertain. The set of all positions for the robot such that the robot can communicate with all marks is a thick set defined by{a mathematical formula} where{a mathematical formula} and{a mathematical formula} Our thick inversion algorithm provides in less than 0.3 sec, the paving represented on Fig. 11. In the example, the clear and the dark boxes could have been obtained using existing interval algorithms. But these methods have to bisect everywhere inside the penumbra. Using thick interval arithmetic, we are able to conclude for a orange box that there is no need to bisect it.
     </paragraph>
     <paragraph>
      Test-case 5.Explored zone. We now illustrate the thick set inversion on the problem of characterizing a zone explored by a robot [25]. The corresponding experiment has been performed October 20, 2015, on a 46 minutes (=2760 sec) mission in the Road-stead of Brest (France, Brittany) by the underwater mine hunter robot, Daurade (see Fig. 12), which realized a classical survey pattern composed of a set of parallel tracks. This robot has been built by ECA robotics and used by DGA Tn (Direction Général de l'Armement – Techniques Navales). Daurade is mainly used to secure a zone and check that there is no mine lying on the sea floor. Assessment of the covered area is usually done manually by an operator who looks at the sonar images. The thick inversion algorithm can be used to validate the mission plan or, at the end of the mission, to check the area to be explored has indeed been covered.
     </paragraph>
     <paragraph>
      For the navigation, Daurade relies an Inertial Measurement Unit (Phins II IXBlue) coupled with a DVL (Doppler Velocity Log), which returns after integration every second a box {a mathematical formula}[a]⊂R2, which contains {a mathematical formula}a=(a1,a2), the 2D coordinates of the robot expressed in an absolute frame. The depth is not taken into account since we explore a flat bottom. For this mission, we need to guarantee that the area of interest has been totally explored without any gap. At the beginning of the mission, the position of the robot is exactly known. Once under the water, no GPS data are available and the estimated position of the robot drifts with the time. At the end of the mission, the position accuracy is of 17 meters. At each {a mathematical formula}t∈{1,2,…,m} where {a mathematical formula}m=2760, the visible set (i.e., the part of the bottom which is seen by the sonar of the robot) is a disk of radius 50 meters around the robot, the position of which is not exactly known. The explored zone{a mathematical formula}X corresponds to the union of all patches that have been seen:{a mathematical formula} where{a mathematical formula} The complementary set of {a mathematical formula}X is{a mathematical formula} where {a mathematical formula}f(x)=(f1(x),…,fm(x)). The function {a mathematical formula}f(x) is consistent with the intervals {a mathematical formula}[a1](t) and {a mathematical formula}[a2](t) containing the positions of the robot iff{a mathematical formula} Since the function {a mathematical formula}[f](x) is thick, the characterization of the thick set {a mathematical formula}〚X‾〛 is a thick set inversion problem which can be characterized by our algorithm. Its complementary {a mathematical formula}〚X〛 can thus be derived. The resulting enclosure of {a mathematical formula}〚X〛, given on Fig. 13, is computed in less than 3 minutes. Note that the penumbra (orange) is larger in zones when the estimation of the position of the robot is less accurate. The black tube corresponds to {a mathematical formula}[a](t). From the information given by the inertial system, for any point {a mathematical formula}xo in the orange zone, it is impossible to known if {a mathematical formula}xo has been seen or not by the sonar. This ambiguity comes from the uncertainty related to the position {a mathematical formula}a(t) of the robot.
     </paragraph>
     <paragraph label="Remark 16">
      In [25], the same problem has been considered and a similar approximation has been obtained using a specific algorithm. Whereas our algorithm is able to find an inner approximation of the penumbra, the algorithm in [25] was not able to find such an inner approximation (in the case where the visible zone is a disk, as here). In the paper [25], the problem was not formalized as a thick set inversion problem and the resulting algorithm could not solve other thick set inversion problems such the Test-cases 1, 2, 3, 4 presented in this section.
     </paragraph>
    </section>
    <section label="6">
     <section-title>
      Conclusion
     </section-title>
     <paragraph>
      This paper deals with the set-inversion problem {a mathematical formula}X=f−1(Y) in the case where both f and {a mathematical formula}Y are uncertain, i.e., f belongs to the interval of functions {a mathematical formula}[f−,f+] and {a mathematical formula}Y belongs to a thick set, i.e., an interval of sets {a mathematical formula}〚Y〛=〚Y⊂,Y⊃〛. After introducing the new notions of thick intervals and thick boxes, a new algorithm for set inversion has been proposed. It is able to compute a thick solution set {a mathematical formula}〚X〛=〚X⊂,X⊃〛 containing all feasible solution sets.
     </paragraph>
     <paragraph>
      From the computational point of view, thick intervals allow us to have a better understanding of the uncertainty. For instance, for the set inversion problem, we are able to detect that a box is included in the penumbra {a mathematical formula}X⊃\X⊂. In this penumbra, we can conclude that any bisection would be useless. This could not have not been detected using classical intervals. As a consequence, the accumulation zone (i.e., the part of the search space where tiny boxes are still bisected) for thick interval based algorithms has a zero volume, since it corresponds to the boundary of the penumbra. Using classical intervals instead, we could obtain similar results, but the accumulation zone would correspond to the whole penumbra, which has a nonzero volume. As a result, a large part of the computational burden made by traditional interval algorithms is done on a part of the search space which has no influence on the final result.
     </paragraph>
     <paragraph>
      Note. The Python programs, associated with the test-case are given at the following link.
     </paragraph>
     <paragraph>
      www.ensta-bretagne.fr/jaulin/thick.html
     </paragraph>
    </section>
   </content>
  </root>
 </body>
</html>